

<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>天华校园</title><script type="module">import{default as e}from'https://testingcf.jsdelivr.net/npm/panzoom/+esm';var t={958:(e,t)=>{t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var l=a[e]={exports:{}};return t[e](l,l.exports,n),l.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};var o={};n.r(o),n.d(o,{attention:()=>S,baseAttributes:()=>B,charName:()=>h,character:()=>v,characterLocations:()=>H,contactGroups:()=>L,currentEvent:()=>j,dateStr:()=>y,diaryTimelineEntries:()=>P,enrichedChatList:()=>T,enrichedMoments:()=>F,eventsByLocation:()=>U,gameText:()=>O,largeSummaryText:()=>R,locationName:()=>w,money:()=>N,monthlyCalendarEvents:()=>q,relationships:()=>M,reputation:()=>V,resourcesText:()=>b,secondaryAttributes:()=>C,skills:()=>I,smallSummaryText:()=>G,subjects:()=>D,talents:()=>A,timeStr:()=>k,todayCourses:()=>x,userFullName:()=>g,weather:()=>E,worldTime:()=>f});const l=Vue,r=VueRouter,c='tianhua_character_state';const s='{{user}}',i=(0,l.reactive)({character:null,worldState:null,userId:s,pendingActions:[],gameText:'欢迎来到天华校园。你的故事，由此开始。',isAddFriendModalVisible:!1,isGeneratingSchedule:!1,selectedDate:null,promotions:[],cartItems:[],pendingOrders:[],diary:{allEntries:[],displayEntries:[],smallSummaryEntries:[],largeSummaryEntries:[],smallSummary:'',largeSummary:'',config:{x:30,y:50},isAutoUpdateEnabled:!1}});(0,l.watch)(()=>i,e=>{!function(e){try{const t={pendingActions:e.pendingActions};localStorage.setItem(c,JSON.stringify(t))}catch(e){console.error('[Cache] 保存状态到缓存失败:',e)}}(e)},{deep:!0});const d=_;function u(e,t,a='N/A',n=!0){const o=(0,d.get)(e,t,a);if(n&&Array.isArray(o)&&o.length>0){const e=o[0];return Array.isArray(e)&&1===e.length&&'$__META_EXTENSIBLE__$'===e[0]||'$__META_EXTENSIBLE__$'===e?Array.isArray(a)?[]:a:e}return o}function m(e,t){return e&&t?(0,d.get)(e,`角色.${t}`,null):null}function p(e,t){if(!e||!t)return null;const a=(0,d.get)(e,'角色',{});for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e)){const n=a[e];if(`${u(n,'姓','',!0)}${u(n,'名','',!0)}`===t)return e}return null}const v=(0,l.computed)(()=>(0,d.get)(i.worldState,`角色.${i.userId}`,null)),h=(0,l.computed)(()=>v.value?`${u(v.value,'姓','',!0)}${u(v.value,'名','未知',!0)}`:'...'),g=(0,l.computed)(()=>{if(!v.value)return'{{user}}';return`${u(v.value,'姓','',!0)}${u(v.value,'名','',!0)}`.trim()||'{{user}}'}),f=(0,l.computed)(()=>u(i.worldState,'世界状态.当前时间',{})),y=(0,l.computed)(()=>{const e=f.value;return e?`${u(e,'年','2024',!0)}年${u(e,'月','9',!0)}月${u(e,'日','1',!0)}日`:'...'}),k=(0,l.computed)(()=>{const e=f.value;if(!e)return'...';return`${String(u(e,'时',8,!0)).padStart(2,'0')}:${String(u(e,'分',0,!0)).padStart(2,'0')}`}),E=(0,l.computed)(()=>u(i.worldState,'世界状态.天气','...',!0)),w=(0,l.computed)(()=>{if(!v.value||!i.worldState)return'...';const e=u(v.value,'当前地点ID','tianhua_high_school',!0);return(0,d.get)(i.worldState,['地点',e,'名称'],'天华学园')}),N=(0,l.computed)(()=>u(v.value,'金钱',0,!0)),V=(0,l.computed)(()=>u(v.value,'声望',0,!0)),b=(0,l.computed)(()=>`金钱: ¥${N.value} | 声望: ${V.value}`),S=(0,l.computed)(()=>u(v.value,'注意力',100,!0)),B=(0,l.computed)(()=>{if(!v.value)return{};const e={};return['智商','情商','体能','灵活','魅力','心境'].forEach(t=>{const a=(0,d.get)(v.value,t);a&&(e[t]={值:u(a,'[0].值',0,!1),软上限:u(a,'[0].软上限','N/A',!1)})}),e}),C=(0,l.computed)(()=>({财力:N.value,声望:V.value})),D=(0,l.computed)(()=>{if(!v.value||!(0,d.get)(v.value,'学业'))return{};const e=(0,d.get)(v.value,'学业'),t={};return Object.keys(e).filter(e=>'综合排名'!==e).forEach(a=>{t[a]={知识水平:u(e,`${a}[0].知识水平`,'N/A',!1),最近一次分数:u(e,`${a}[0].最近一次分数`,'N/A',!1)}}),t}),I=(0,l.computed)(()=>{if(!v.value||!(0,d.get)(v.value,'技能与知识'))return{};const e=(0,d.get)(v.value,'技能与知识'),t={};return Object.keys(e).filter(e=>'$meta'!==e).forEach(a=>{t[a]={等级:u(e,`${a}[0].等级`,1,!1),软上限:u(e,`${a}[0].软上限`,5,!1)}}),t}),A=(0,l.computed)(()=>{const e=(0,d.get)(v.value,'天赋特长');if(!Array.isArray(e)||0===e.length)return[];const t=Array.isArray(e[0])?e[0]:e;return t.length>0&&'$__META_EXTENSIBLE__$'===t[0]?[]:t.map(e=>'string'==typeof e?{名称:e,描述:''}:e)}),x=(0,l.computed)(()=>{const e=u(i.worldState,'玩家日程',[],!1),t=u(f.value,'星期','',!1);return Array.isArray(e)?e.filter(e=>e['日期']===t):[]}),M=(0,l.computed)(()=>{if(!v.value||!(0,d.get)(v.value,'人际关系'))return{};const e=(0,d.get)(v.value,'人际关系'),t={};return Object.keys(e).filter(e=>'$meta'!==e).forEach(a=>{const n=m(i.worldState,a),o=n?`${u(n,'姓','',!0)}${u(n,'名',a,!0)}`:a;t[o]={亲密:u(e,`${a}.亲密轴`,0,!0),信赖:u(e,`${a}.信赖轴`,0,!0),激情:u(e,`${a}.激情轴`,0,!0),敌意:u(e,`${a}.敌意轴`,0,!0)}}),t}),T=(0,l.computed)(()=>{if(!i.worldState)return[];const e=(0,d.get)(i.worldState,'聊天会话列表',{}),t=(0,d.get)(i.worldState,'聊天群组',{}),a=i.userId;return[...Object.values(e).filter(e=>e&&e.ID&&Array.isArray(e.参与者)).map(e=>{const t=e.参与者.find(e=>e!==a),n=m(i.worldState,t),o=n?`${u(n,'姓','',!0)}${u(n,'名',t,!0)}`:t||'未知';return{id:e.ID,isGroup:!1,name:o,avatarName:o,characterId:t,lastMessage:e.最后消息||'',lastTime:e.最后时间||'',unreadCount:e.未读数||0}}),...Object.values(t).filter(e=>e&&e.ID&&e.群名称).map(e=>{const t=(e.历史||[]).slice(-1)[0]||'',a=t.match(/\|([^|]+)\|/g),n=a&&a.length>1?a[a.length-2].replace(/\|/g,''):'',o=t.split('|').pop()?.replace(']','')||'';return{id:e.ID,isGroup:!0,name:e.群名称||'未知群组',avatarName:(e.群名称||'群').substring(0,1),lastMessage:o,lastTime:n,unreadCount:0}})].sort((e,t)=>t.lastTime>e.lastTime?1:-1)}),L=(0,l.computed)(()=>function(){if(!i.worldState)return[];const e=(0,d.get)(i.worldState,'角色',{}),t=(0,d.get)(e,`${i.userId}.人际关系`,{}),a={新的朋友:[],群聊:[],我的同学:[],我的好友:[],黑名单:[]};Object.keys(e).filter(e=>e!==i.userId&&'$meta'!==e).forEach(n=>{const o=e[n];if(!o)return;const l={id:n,name:`${u(o,'姓','',!0)}${u(o,'名','',!0)}`||n,avatarName:u(o,'姓','?',!0),signature:u(o,'签名','...',!0)},r=(0,d.get)(o,`人际关系.${i.userId}`);r&&'待确认好友'===u(r,'聊天状态','陌生人',!0)&&a['新的朋友'].push(l);const c=t[n];if(c){const t=u(c,'聊天状态','陌生人',!0);if('好友'===t){const t=u(e[i.userId],'班级',null,!0),n=u(o,'班级',null,!0);t&&n&&t===n?a['我的同学'].push(l):a['我的好友'].push(l)}else'黑名单'===t&&a['黑名单'].push(l)}});const n=(0,d.get)(i.worldState,'聊天群组',{});return a['群聊']=Object.values(n).map(e=>({id:e.ID,name:e.群名称,isGroup:!0,avatarName:e.群名称||'群'})),Object.entries(a).filter(([,e])=>e.length>0).map(([e,t])=>({name:e,contacts:t}))}()),F=(0,l.computed)(()=>{if(!i.worldState)return[];const e=(0,d.get)(i.worldState,'MX空间',{});return Object.values(e).map(e=>{const t=m(i.worldState,e.作者);return{...e,authorName:t?`${u(t,'姓','',!0)}${u(t,'名','',!0)}`:e.作者,avatarName:t?u(t,'姓','?',!0):'?'}}).sort((e,t)=>t.时间戳-e.时间戳)}),O=(0,l.computed)(()=>i.gameText),j=(0,l.computed)(()=>{const e=(0,d.get)(i.worldState,'世界状态.当前事件');return Array.isArray(e)&&e[0]&&e[0].ID?e[0]:null}),q=(0,l.computed)(()=>(e,t)=>{const a={},n=new Date(e,t,1),o=new Date(e,t+1,0),l=j.value;if(l){const e=new Date((0,d.get)(i.worldState,'世界状态.当前时间.年'),(0,d.get)(i.worldState,'世界状态.当前时间.月')-1,(0,d.get)(i.worldState,'世界状态.当前时间.日'));e.setDate(e.getDate()-(l.已持续天数-1));for(let t=0;t<l.总持续天数;t++){const r=new Date(e);if(r.setDate(r.getDate()+t),r>=n&&r<=o){const e=r.toISOString().split('T')[0];a[e]||(a[e]=[]),a[e].push({id:l.ID,name:l.名称,type:'world'})}}}const r=(0,d.get)(v.value,'日程[0]',[]);Array.isArray(r)&&r.forEach(e=>{if(e&&e.日期)try{const t=new Date(e.日期);if(t>=n&&t<=o){const n=t.toISOString().split('T')[0];a[n]||(a[n]=[]),a[n].push({id:e.ID||`personal-${Date.now()}`,name:e.标题,type:'personal'})}}catch(e){}});const c=(0,d.get)(i.worldState,'[系统]事件触发器'),s=(0,d.get)(i.worldState,'[世界观]世界事件库');if(c&&s){const n=c.split('\n').filter(Boolean),o=s.split('\n').filter(Boolean),l=new Map;o.forEach(e=>{if(e.startsWith('#'))return;const t=e.split('|');t.length>=2&&l.set(t[0],t[1])}),n.forEach(n=>{if(n.startsWith('#'))return;const o=n.split('|');if('date'===o[0]&&o.length>=3){const[n,r]=o[1].split('-').map(Number);if(n===t+1){const n=o[2],c=l.get(n)||n,s=new Date(e,t,r).toISOString().split('T')[0];a[s]||(a[s]=[]),a[s].push({id:n,name:c,type:'upcoming'})}}})}return a}),U=(0,l.computed)(()=>{const e={},t=new Date(y.value);t.setHours(0,0,0,0);const a=(0,d.get)(v.value,'日程[0]',[]);Array.isArray(a)&&a.forEach(a=>{if(a&&a.地点ID&&a.日期)try{const n=new Date(a.日期);n.setHours(0,0,0,0),n.getTime()===t.getTime()&&(e[a.地点ID]||(e[a.地点ID]=[]),e[a.地点ID].push({...a,type:'personal'}))}catch(e){}});const n=j.value;return n&&n.ID,e}),H=(0,l.computed)(()=>{const e={};if(!i.worldState)return e;const t=(0,d.get)(i.worldState,'角色');return t&&'object'==typeof t?(Object.keys(t).filter(e=>'$meta'!==e&&t[e]).forEach(a=>{const n=t[a];if(n&&'object'==typeof n){const t=(0,d.get)(n,'当前地点ID');let o;Array.isArray(t)?o=t[0]:'string'==typeof t&&(o=t),o&&(e[a]=o)}}),e):(console.warn('[Getters] "世界状态.角色" is not a valid object.'),e)}),P=(0,l.computed)(()=>i.diary.displayEntries),G=(0,l.computed)(()=>i.diary.smallSummary),R=(0,l.computed)(()=>i.diary.largeSummary),W=toastr,X='天华校园';const Y={updateStock:async function(e,t){try{const a=(await TavernHelper.getWorldbook(X)).find(e=>'[世界观]商品列表'===e.comment);if(!a||!a.content)return void console.error('Could not find product list entry in lorebook.');let n=a.content;const o=new RegExp(`(ID\\|${e}\\n[\\s\\S]*?库存\\|)(\\d+)`,'m'),l=n.match(o);if(l){const r=parseInt(l[2],10),c=Math.max(0,r+t);n=n.replace(o,`${l[1]}${c}`),await TavernHelper.setLorebookEntries(X,[{uid:a.uid,content:n}]),console.log(`[LorebookService] Stock for product ${e} updated to ${c}.`)}else console.warn(`[LorebookService] Product with ID ${e} not found in lorebook entry.`)}catch(e){console.error('[LorebookService] Error updating stock:',e)}}};class J{static instance;constructor(){}static getInstance(){return J.instance||(J.instance=new J),J.instance}async generateSummary(e,t){if(!e||0===e.length)return'没有可供总结的日记内容。';const a=e.map(e=>e.raw).join('\n'),n=this.buildSummaryPrompt(a,t);try{const e=await TavernHelper.generate({injects:[{role:'user',content:n,position:'none',depth:0}],should_stream:!1});return e.match(/<总结>([\s\S]*?)<\/总结>/)?.[1].trim()||e}catch(e){return console.error(`生成${'small'===t?'小':'大'}总结失败:`,e),'AI无法生成总结，请稍后再试。'}}buildSummaryPrompt(e,t){return'small'===t?`\n        # 任务：生成小总结\n        请根据以下日记内容，提取近期发生的 **关键事件**、**新认识的重要人物**、以及主角 **情绪的重大转折点**。\n        要求语言精炼，概括性强，字数控制在200字以内。\n        请将总结内容包裹在 <总结> 标签内。\n\n        ## 日记原文:\n        ${e}\n      `:`\n        # 任务：生成大总结\n        请通读以下全部日记内容，梳理出这段时期内 **最主要的故事线**、**核心人物关系的变化**（例如从陌生到熟悉，从朋友到恋人等）、以及主角的 **个人成长与核心困境**。\n        要求有宏观视角，能抓住主要矛盾和发展脉络，字数在400字左右。\n        请将总结内容包裹在 <总结> 标签内。\n\n        ## 日记原文:\n        ${e}\n      `}async updateLogFromSummary(e,t,a){const n=this.buildUpdatePrompt(e,t,a);try{const e=await TavernHelper.generate({injects:[{role:'user',content:n,position:'none',depth:0}],should_stream:!1}),t=e.match(/<UpdateVariable>([\s\S]*?)<\/UpdateVariable>/)?.[1].trim();t?(console.log('[DiaryService] Generated MVU script for update:',t),W.success('原始日记已根据您的总结智能更新！')):W.warning('AI未能生成更新指令。')}catch(e){console.error(`从${a}总结更新日志失败:`,e),W.error('从总结更新日志失败。')}}buildUpdatePrompt(e,t,a){return`\n      # 任务：智能更新原始日志\n      你是一个强大的文本分析与重构AI。用户的总结是对原始日志的修正和提炼。\n      请仔细比对“修改后的总结”与“原始日志”，找出其中的 **事实性差异**。\n      然后，生成一个 \`<UpdateVariable>\` 代码块，用 \`_.set\` 指令来修改原始的 \`校园日志-主\` 世界书条目，使其内容与修改后的总结保持一致。\n\n      ## 规则:\n      - 只针对事实性内容的修改生成指令（例如，人物、地点、事件结果的变更）。\n      - 忽略纯粹的措辞、风格或顺序上的调整。\n      - 你的目标是更新 \`校园日志-主\` 的内容，所以 \`_.set\` 的路径应该是 \`世界状态.['校园日志-主'].content\`。\n      - 你需要提供完整的、更新后的所有日志内容。\n\n      ## 修改后的${'small'===a?'小':'大'}总结:\n      ${t}\n\n      ## 原始日志内容:\n      ${e.map(e=>e.raw).join('\n')}\n    `}}const K=J.getInstance();function Z(e){return'string'!=typeof e?e:e.replace(/^['"` ]*(.*?)['"` ]*$/,'$1')}function Q(e){if('string'!=typeof e)return e;const t=e.trim();if('true'===t)return!0;if('false'===t)return!1;if('null'===t)return null;if('undefined'!==t){try{return JSON.parse(t)}catch(e){if(t.startsWith('{')&&t.endsWith('}')||t.startsWith('[')&&t.endsWith(']'))try{return new Function(`return ${t};`)()}catch(e){}}return Z(e)}}function ee(e,t){let a=1,n=!1,o='';for(let l=t;l<e.length;l++){const t=e[l];if('"'!==t&&'\''!==t&&'`'!==t||'\\'===e[l-1]||(n?t===o&&(n=!1):(n=!0,o=t)),!n)if('('===t)a++;else if(')'===t&&(a--,0===a))return l}return-1}function te(e){const t=[];let a='',n=!1,o='',l=0,r=0,c=0;for(let s=0;s<e.length;s++){const i=e[s];'"'!==i&&'\''!==i&&'`'!==i||0!==s&&'\\'===e[s-1]||(n?i===o&&(n=!1):(n=!0,o=i)),n||('('===i&&c++,')'===i&&c--,'['===i&&l++,']'===i&&l--,'{'===i&&r++,'}'===i&&r--),','!==i||n||0!==c||0!==l||0!==r?a+=i:(t.push(a.trim()),a='')}return a.trim()&&t.push(a.trim()),t}function ae(e,t){if(!e||!t)return null;const a=(0,d.cloneDeep)(t);let n=!1;const o=function(e){const t=[];let a=0;for(;a<e.length;){const n=e.substring(a).match(/_\.(set|assign|remove|add|insert)\(/);if(!n||void 0===n.index)break;const o=n[1],l=a+n.index+n[0].length,r=ee(e,l);if(-1===r){a=l;continue}let c=r+1;if(c>=e.length||';'!==e[c]){a=r+1;continue}c++;const s=te(e.substring(l,r));t.push({command:o,args:s}),a=c}return t}(e);for(const e of o)try{const t=Z(e.args[0]);switch(e.command){case'set':{const o=e.args.length>=2?e.args[1]:void 0;if(void 0===o)continue;let l=Q(o);l instanceof Date&&(l=l.toISOString()),(0,d.set)(a.stat_data,t,l),n=!0;break}case'add':{const o=(0,d.get)(a.stat_data,t),l=Q(e.args[1]);'number'==typeof o&&'number'==typeof l&&((0,d.set)(a.stat_data,t,o+l),n=!0);break}case'remove':(0,d.unset)(a.stat_data,t),n=!0;break;case'assign':case'insert':if(2===e.args.length){const o=Q(e.args[1]),l=(0,d.get)(a.stat_data,t);if(Array.isArray(l)&&2===l.length&&Array.isArray(l[0])&&'string'==typeof l[1]){const e=l[0],r=l[1],c=[e.concat(Array.isArray(o)?o:[o]),r];(0,d.set)(a.stat_data,t,c),n=!0}else if(Array.isArray(l)){const e=l.concat(Array.isArray(o)?o:[o]);(0,d.set)(a.stat_data,t,e),n=!0}else'object'==typeof l&&null!==l?(Object.assign(l,o),n=!0):((0,d.set)(a.stat_data,t,o),n=!0)}else if(e.args.length>=3){const o=Q(e.args[1]),l=Q(e.args[2]),r=(0,d.get)(a.stat_data,t);if(Array.isArray(r)){if('number'==typeof o){const e=[...r];e.splice(o,0,l),(0,d.set)(a.stat_data,t,e),n=!0}}else if('object'==typeof r&&null!==r)(0,d.set)(r,String(o),l),n=!0;else{const e={};(0,d.set)(e,String(o),l),(0,d.set)(a.stat_data,t,e),n=!0}}}}catch(t){console.error('[MVU Fallback] 处理指令失败:',e,t)}return n?a:null}const ne='天华校园';async function oe(e){try{const t=(await TavernHelper.getLorebookEntries(ne)).find(t=>t.comment===e);return t?t.content:null}catch(t){return console.error(`[Lorebook] Failed to read from entry "${e}":`,t),null}}async function le(e,t){try{const a=(await TavernHelper.getLorebookEntries(ne)).find(t=>t.comment===e);a?await TavernHelper.setLorebookEntries(ne,[{uid:a.uid,content:t}]):await TavernHelper.createLorebookEntries(ne,[{comment:e,content:t,keys:[e],enabled:!0}]),console.log(`[Lorebook] Successfully wrote to entry: ${e}`)}catch(t){throw console.error(`[Lorebook] Failed to write to entry "${e}":`,t),t}}function re(e){if(!e||!e.trim())return[];return e.trim().split(/\n\s*\n+/).map(e=>{const t={},a=e.trim().split('\n').filter(e=>!e.startsWith('//')&&e.trim());for(const e of a){const a=e.indexOf('|');if(-1===a)continue;const n=e.substring(0,a).trim(),o=e.substring(a+1).trim();if(t[n])Array.isArray(t[n])||(t[n]=[t[n]]),o&&t[n].push(o);else{const e=['参与者','成员','历史','点赞','评论'];t[n]=e.includes(n)?o?[o]:[]:o}}return t})}function ce(e){return Array.isArray(e)?e.map(e=>{const t=[],a=['ID','群名称','作者','内容','时间戳','最后消息','最后时间','参与者','成员','历史'].filter(t=>t in e),n=Object.keys(e).filter(e=>!a.includes(e));return[...a,...n].forEach(a=>{const n=e[a];Array.isArray(n)?0===n.length?t.push(`${a}|`):n.forEach(e=>t.push(`${a}|${e}`)):null!=n&&t.push(`${a}|${n}`)}),t.join('\n')}).join('\n\n'):''}async function se(e){const t=e.slice(1,-1).split('|'),a=t[0];try{switch(a){case'私聊':{const[a,n,o,l,...r]=t,c=r.join('|'),s=n.includes('_')?n:p(i.worldState,n)||n,d=[s,o.includes('_')?o:p(i.worldState,o)||o].sort(),u=`chat_${d[0]}_${d[1]}`,m=re(await oe('聊天会话列表-主'));let v=m.find(e=>e.ID===u);v||(v={ID:u,参与者:d,历史:[],未读数:0},m.push(v)),Array.isArray(v.历史)||(v.历史=[]),v.历史.push(e.slice(1,-1)),v.最后消息=c,v.最后时间=l,s!==i.userId&&(v.未读数=(parseInt(v.未读数,10)||0)+1),await le('聊天会话列表-主',ce(m));break}case'群聊':{const[a,n,o,l,...r]=t,c=re(await oe('聊天群组-主'));let s=c.find(e=>e.ID===o);s&&(Array.isArray(s.历史)||(s.历史=[]),s.历史.push(e.slice(1,-1)),await le('聊天群组-主',ce(c)));break}case'好友请求':{const[e,a,n,o,...l]=t,r=l.join('|');console.log(`[Social] Logging friend request from ${a} to ${n}. Message: "${r}"`);const c=i.worldState;if(c){const e=(0,d.get)(c,`角色.${n}`),t=(0,d.get)(c,`角色.${a}`);e&&t&&console.log('[Social] State for friend request is managed by actions.ts. No direct lorebook write here to prevent data loss.')}break}case'接受好友':{const[e,a,n,o]=t;if(a!==i.userId&&n!==i.userId)break;const l=[a,n].sort(),r=`chat_${l[0]}_${l[1]}`,c=re(await oe('聊天会话列表-主'));let s=c.find(e=>e.ID===r);if(!s){s={ID:r,参与者:l,历史:[],未读数:0},c.push(s);const e=(0,d.get)(i.worldState,`角色.${n}.名[0]`,n),t=`[系统|${r}|${o}|你和${e}已成为好友，开始聊天吧！]`;Array.isArray(s.历史)||(s.历史=[]),s.历史.push(t),await le('聊天会话列表-主',ce(c))}break}case'群聊创建':{const[e,a,n,o]=t,l=a.split(':')[1],r=n.split(':')[1],c=o.split(':')[1].split(','),s=re(await oe('聊天群组-主'));s.some(e=>e.ID===l)||(s.push({ID:l,群名称:r,成员:c,历史:[]}),await le('聊天群组-主',ce(s)));break}case'动态':{const[e,a,n,o,l='friends']=t,r={ID:`moment_${a}_${Date.now()}`,作者:a,时间戳:n,内容:o,可见性:l,点赞:[],评论:[]};await async function(e,t,a='\n\n'){try{const n=(await TavernHelper.getLorebookEntries(ne)).find(t=>t.comment===e);if(n){const e=n.content?`${n.content}${a}${t}`:t;await TavernHelper.setLorebookEntries(ne,[{uid:n.uid,content:e}])}else await TavernHelper.createLorebookEntries(ne,[{comment:e,content:t,keys:[e],enabled:!0}]);console.log(`[Lorebook] Successfully appended to entry: ${e}`)}catch(t){throw console.error(`[Lorebook] Failed to append to entry "${e}":`,t),t}}('MX空间-主',ce([r]));break}case'系统':{const[a,n,o,...l]=t;l.join('|');if(n.startsWith('chat_')){const t=re(await oe('聊天会话列表-主'));let a=t.find(e=>e.ID===n);a&&(Array.isArray(a.历史)||(a.历史=[]),a.历史.push(e.slice(1,-1)),await le('聊天会话列表-主',ce(t)))}else if(n.startsWith('group_')){const t=re(await oe('聊天群组-主'));let a=t.find(e=>e.ID===n);a&&(Array.isArray(a.历史)||(a.历史=[]),a.历史.push(e.slice(1,-1)),await le('聊天群组-主',ce(t)))}break}}}catch(t){console.error(`Failed to process and save social command: "${e}"`,t)}}async function ie(){console.log('Fetching data from Tavern...');const e=await getChatMessages(getCurrentMessageId());return console.log('Messages received:',e),e}const de=new class{timerId=null;isRunning=!1;isUpdating=!1;updateCallback=null;start(e,t=15e3){this.isRunning?console.log('[SilentUpdater] Updater is already running.'):(this.updateCallback=e,this.timerId=window.setInterval(()=>this.runUpdate(),t),this.isRunning=!0,console.log(`[SilentUpdater] Started with an interval of ${t/1e3} seconds.`))}stop(){this.timerId&&(window.clearInterval(this.timerId),this.timerId=null),this.isRunning=!1,this.updateCallback=null,console.log('[SilentUpdater] Stopped.')}async runUpdate(){if(!this.isUpdating&&this.updateCallback){this.isUpdating=!0;try{await this.updateCallback(),console.log('[SilentUpdater] Silent update check completed.')}catch(e){console.error('[SilentUpdater] Error during silent update:',e)}finally{this.isUpdating=!1}}else console.log('[SilentUpdater] Update in progress or callback not set. Skipping.')}};async function ue(){await async function(){try{const e=await ie();if(e&&e.length>0&&e[0].data){const t=e[0].data.stat_data||e[0].data;console.log('[Store] Raw state data from message:',JSON.stringify(t,null,2)),i.worldState=(0,d.merge)(i.worldState||{},t),i.userId=s,i.character=(0,d.get)(i.worldState,['角色',i.userId])||null;const a=e[0].message,n=a?.match(/<gametxt>([\s\S]*?)<\/gametxt>/i)?.[1].trim();i.gameText=n||e[0].mes||'欢迎来到天华校园。你的故事，由此开始。';const o=a?.match(/<校园日志>([\s\S]*?)<\/校园日志>/)?.[1]?.trim();if(o){const e=o.match(/日期\|(.*?)$/m),t=e?e[1].trim():null;if(t)try{const e='天华校园',a=['校园日志-主','校园日志-辅'],n=await TavernHelper.getLorebookEntries(e)||[],l=n.find(e=>'校园日志-主'===e.comment);if((l?.content||'').includes(`日期|${t}`))console.log(`[CoreData] Log with timestamp "${t}" already exists in Lorebook. Skipping write.`);else{console.log(`[CoreData] New unique log found with timestamp: ${t}. Processing...`);for(const t of a){const a=n.find(e=>e.comment===t);if(a){const n=`${a.content||''}\n\n---\n\n${o}`;await TavernHelper.setLorebookEntries(e,[{uid:a.uid,content:n,comment:t}])}else await TavernHelper.setLorebookEntries(e,[{uid:-1,comment:t,content:o,keys:[],position:'after_character_definition'}])}console.log('[CoreData] Campus log successfully processed and saved.')}}catch(e){console.error('[CoreData] Error processing campus log from message:',e)}else console.warn('[CoreData] Could not extract timestamp from campus log. Skipping write.')}}else console.warn('无法从当前消息加载状态数据或消息为空。')}catch(e){console.error('获取核心数据时出错:',e)}}();const e=await async function(){const e={},t=['聊天会话列表','聊天群组','MX空间','角色头像'];for(const a of t){const t=re(await oe(`${a}-主`));e[a]='角色头像'===a?t.reduce((e,t)=>{const a=Object.keys(t)[0];return a&&(e[a]=t[a]),e},{}):t.reduce((e,t)=>(t.ID&&(e[t.ID]=t),e),{$meta:{extensible:!0}})}return e}();i.worldState=(0,d.merge)(i.worldState||{},e),console.log('[Store] All core and social data loaded. Requesting schedule data...'),eventEmit('tavern-helper:request-schedule-load')}function me(e){i.pendingActions.push(e)}let pe=!1;async function ve(){try{const e=await TavernHelper.getLorebookEntries('天华校园');if(!e)return void console.warn('[Store] Could not fetch entries for "天华校园".');const t=e.find(e=>'校园日志-主'===e.comment);if(!t||!t.content)return void(i.diary.allEntries=[]);const a=t.content.split(/\n\s*---\s*\n/).filter(e=>''!==e.trim()).map((e,t)=>{const a={id:t,raw:e},n=e.trim().split('\n');let o=null;return n.forEach(e=>{const t=e.indexOf('|');if(-1!==t){const n=e.substring(0,t).trim(),l=e.substring(t+1).trim();if(n){const e={日期:'date',地点:'location',人物:'characters',描述:'content',自动化系统:'automation'}[n]||n.toLowerCase();a[e]=l,o=e}}else o&&void 0!==a[o]&&(a[o]+='\n'+e)}),a.date=a.date||'未知日期',a.content=a.content||'无描述',a}).filter(e=>e&&'未知日期'!==e.date);a.reverse(),i.diary.allEntries=a;const{x:n,y:o}=i.diary.config;i.diary.displayEntries=a.slice(0,n),i.diary.smallSummaryEntries=a.slice(n,n+o),i.diary.largeSummaryEntries=a.slice(n+o)}catch(e){console.error('获取日记条目失败:',e)}}const he={loadAllData:ue,addActionToQueue:me,handleAction:async function(e=''){let t='';try{if(!i.worldState&&(await ue(),!i.worldState))return void console.error('错误：无法加载当前角色状态，无法执行操作。');const a=('[行动指令]\n'+i.pendingActions.map(e=>{switch(e.action){case'equip':return`装备 [${e.itemName}] 到 [${e.category}]`;case'unequip':return`卸下 [${e.itemName}] 从 [${e.category}]`;case'use':return`使用 ${e.quantity} 个 [${e.itemName}]`;case'addFriend':return e.message?`向 ${e.characterName} 发送好友请求，并附带消息：“${e.message}”`:`向 ${e.characterName} 发送好友请求`;case'handleFriendRequest':return'accept'===e.requestType?`[接受好友|${i.userId}|${e.characterId}|${k.value}]`:`拒绝了 ${e.characterId} 的好友请求`;case'likeMoment':return`点赞了ID为 ${e.momentId} 的动态`;case'commentOnMoment':return`[评论] 你评论了 ${e.momentId} 这条动态：“${e.text}”`;case'chat':{const t=k.value;return`[${e.isGroup?'群聊':'私聊'}|${i.userId}|${e.chatId}|${t}|${e.message}]`}case'custom':return e.command;default:return''}}).filter(Boolean).join('\n')+'\n'+e).trim();if(!a)return;const n=`<格式要求>...</格式要求><行动选择>${a}</行动选择>`;t=await async function(e){const t={injects:[{role:'user',content:e,position:'in_chat',should_scan:!0}],should_stream:!1},a=await TavernHelper.generate(t);if('string'!=typeof a)throw new Error('AI未能返回有效文本。');return a}(n);const o=t.match(/<UpdateVariable>([\s\S]*?)<\/UpdateVariable>/)?.[1].trim();if(o){const e=(await ie())?.[0]?.data??i.worldState,t=await async function(e,t){const a={old_variables:t};let n=e.replace(/「|」/g,'\'');const o=/_.assign\('角色', '(.+?)', {}\);/g,l=o.exec(n);if(l){const e=l[1],t=new RegExp(`_.set\\('角色\\\\.${e}\\\\.([^']*)', (.*?)\\);`,'g');let a,r='let user = {};\n';for(;null!==(a=t.exec(n));)r+=`user['${a[1]}'] = ${a[2]};\n`;r+=`_.assign('角色', '${e}', user);`,n=n.replace(o,''),n=n.replace(t,''),n+=`\n${r}`}return await eventEmit('mag_invoke_mvu',n,a),a.new_variables}(o,e);t?.stat_data&&(i.worldState=(0,d.merge)(i.worldState,t),i.character=(0,d.get)(i.worldState,['角色',i.userId])||null)}const l=t.match(/<NewSocialContent>([\s\S]*?)<\/NewSocialContent>/)?.[1]?.trim();if(l){const e=l.split('\n').filter(e=>e.trim().startsWith('[')&&e.trim().endsWith(']'));for(const t of e){const e=t.slice(1,-1).split('|');switch(e[0]){case'好友请求':{const[t,a,n]=e;if(console.log(`[Action] Processing friend request from ${a} to ${n}`),i.worldState){const e=(0,d.get)(i.worldState,`角色.${n}`),t=(0,d.get)(i.worldState,`角色.${a}`);e&&t?((0,d.get)(e,'人际关系')||(0,d.set)(e,'人际关系',{$meta:{extensible:!0}}),(0,d.get)(t,'人际关系')||(0,d.set)(t,'人际关系',{$meta:{extensible:!0}}),(0,d.get)(e,`人际关系.${a}`)||(0,d.set)(e,`人际关系.${a}`,{}),(0,d.get)(t,`人际关系.${n}`)||(0,d.set)(t,`人际关系.${n}`,{}),(0,d.set)(e,`人际关系.${a}.聊天状态`,['待确认好友']),(0,d.set)(t,`人际关系.${n}.聊天状态`,['请求中']),console.log('[Action] State updated for friend request.')):console.error(`Could not find character(s) for friend request: ${a}, ${n}`)}break}case'接受好友':{const[a,n,o]=e;console.log(`[Action] Processing friend acceptance from ${n} for ${o}`),i.worldState&&((0,d.set)(i.worldState,`角色.${n}.人际关系.${o}.聊天状态[0]`,'好友'),(0,d.set)(i.worldState,`角色.${o}.人际关系.${n}.聊天状态[0]`,'好友')),await se(t);break}case'群聊创建':{await se(t);const[a,n,o,l]=e,r=n.split(':')[1],c=o.split(':')[1],s=l.split(':')[1].split(',');i.worldState&&(0,d.set)(i.worldState,`聊天群组.${r}`,{ID:r,群名称:c,成员:s,历史:[]});break}default:await se(t)}}}i.pendingActions=[]}catch(e){console.error('处理动作时出错:',e)}finally{try{const e=JSON.parse(JSON.stringify(i.worldState)),a=await ie();if(a&&a.length>0){const n=a[0];n.message=t,n.data=JSON.parse(JSON.stringify(i.worldState)),await TavernHelper.setChatMessages([n],{refresh:'none'}),console.log('[Store] Action handled. Final state saved to message 0.');const o=(0,d.get)(i.worldState,`角色.${i.userId}.待收货订单[0]`,[]),l=(0,d.get)(e,`角色.${i.userId}.待收货订单[0]`,[]);if(o.length>l.length){const e=o.slice(l.length);for(const t of e)await Y.updateStock(t.ID,-t.quantity)}}}catch(e){console.error('[Store] Failed to save state or reload after action:',e)}}},initializeEventListeners:function(){pe||(console.log('[Store] Initializing data synchronization...'),eventOn(tavern_events.GENERATION_ENDED,async()=>{console.log('[Store] Generation ended. Fetching all data.'),await ue()}),eventOn('tavern-helper:schedule-updated',async()=>{console.log('[Store] Schedule updated. Fetching all data.'),await ue()}),eventOn('tavern-helper:activate-event',e=>{const t=(0,d.get)(i.worldState,'世界状态');if(!t)return void console.error('[Store] Cannot activate event: worldState is not initialized.');const{newEvent:a,description:n}=e;t.当前事件=a,Array.isArray(t.公告)&&Array.isArray(t.公告[0])||(t.公告=[['$__META_EXTENSIBLE__$'],'校园内的官方通知']);t.公告[0].push({标题:`[事件开始] ${a.名称}`,内容:n,发布者:'天华学园校委会',时间:(new Date).toISOString().split('T')[0]}),console.log(`[Store] State updated for activated event: ${a.名称}`)}),eventOn('tavern-helper:progress-event',e=>{const t=(0,d.get)(i.worldState,'世界状态.当前事件');t&&(t.已持续天数=e)}),eventOn('tavern-helper:deactivate-event',e=>{const t=(0,d.get)(i.worldState,'世界状态');if(t){const{initialEventState:a,eventName:n}=e;t.当前事件=a;const o=(0,d.get)(t,'公告[0]');Array.isArray(o)&&o.push({标题:`[事件结束] ${n}`,内容:`${n} 已顺利结束。`,发布者:'天华学园校委会',时间:(new Date).toISOString().split('T')[0]})}}),de.start(ue),pe=!0,console.log('[Store] Data synchronization listeners and polling are active.'))},checkForScheduleUpdate:async function(){if(eventEmit('tavern-helper:request-event-check'),i.isGeneratingSchedule)return;const e=f.value,t=(0,d.get)(i.worldState,'课程表-主'),a=(0,d.get)(i.worldState,`角色.${i.userId}`),n=(0,d.get)(a,'班级'),o=Array.isArray(n)?n[0]:n;(!t||'周日'===(0,d.get)(e,'星期',''))&&o&&(console.log(`[Store] Requesting schedule update. Reason: ${t?'It is Sunday':'Schedule is empty'}.`),eventEmit('tavern-helper:request-schedule-update',o))},updateCharacterData:async function(e,t,a=!1){if(!i.character)return;let n;if(a&&Array.isArray((0,d.get)(i.character,e))){const a=[...(0,d.get)(i.character,e,[]),t];n=`_.set(角色.${i.userId}.${e}, ${JSON.stringify(a)})`}else n=`_.set(角色.${i.userId}.${e}, ${JSON.stringify(t)})`;await ae(n,i.worldState),await ue()},setSelectedDate:function(e){i.selectedDate=e},addToCart:function(e){const t=i.cartItems.find(t=>t.ID===e.ID);t?t.quantity<e.库存?t.quantity++:console.warn(`Cannot add more of ${e.名称}. Stock limit reached.`):e.库存>0&&i.cartItems.push({...e,quantity:1})},checkout:async function(){const e=i.cartItems.reduce((e,t)=>e+t.价格*t.quantity,0);if(N.value<e)return void console.warn('[Action] Checkout failed: Insufficient funds.');const t=`[购物] 购买了 ${i.cartItems.map(e=>`${e.名称}x${e.quantity}`).join(', ')}，总价 ${e}`;me({action:'custom',command:t}),console.log(`[Action] Checkout action queued: ${t}`),i.cartItems=[]},fetchDiaryEntries:ve,generateDiarySummary:async function(e){const t='small'===e?i.diary.smallSummaryEntries:i.diary.largeSummaryEntries;if(0!==t.length){W.info(`正在为您生成${'small'===e?'小':'大'}总结...`,'AI思考中',{timeOut:0,extendedTimeOut:0});try{const a=await K.generateSummary(t,e);W.clear(),'small'===e?i.diary.smallSummary=a:i.diary.largeSummary=a,W.success(('small'===e?'小':'大')+'总结已生成！')}catch(t){console.error(`生成${'small'===e?'小':'大'}总结时出错:`,t),W.error(`生成${'small'===e?'小':'大'}总结失败。`)}}else W.info(`没有可用于生成${'small'===e?'小':'大'}总结的日记内容。`)},saveDiarySummaries:async function(){try{W.info('正在保存日记总结...','请稍候',{timeOut:2e3});const e='天华校园',t={comment:'日记总结-小-主',content:i.diary.smallSummary},a={comment:'日记总结-大-主',content:i.diary.largeSummary},n=await TavernHelper.getLorebookEntries(e),o=async(t,a)=>{const o=n.find(e=>e.comment===t);o?await TavernHelper.setLorebookEntries(e,[{uid:o.uid,content:a}]):await TavernHelper.setLorebookEntries(e,[{uid:-1,comment:t,content:a,keys:[],position:'after_character_definition'}])};await o(t.comment,t.content),await o(a.comment,a.content),W.success('日记总结已成功保存至世界书！')}catch(e){console.error('保存日记总结失败:',e),W.error('保存日记总结失败。')}},updateLogFromSummary:async function(e,t,a){W.info('正在根据您的总结更新原始日记...');try{await K.updateLogFromSummary(e,t,a),await ve()}catch(e){console.error(`从${a}总结更新日志时出错:`,e),W.error('从总结更新日志失败。')}}},ge={class:'bottom-status'},fe={id:'status-effects-wrapper',class:'status-effects-wrapper'},ye=['title'],ke={key:1,class:'status-effect'},Ee={class:'quick-send-container'},we=['onKeypress'],Ne=(0,l.defineComponent)({__name:'BottomStatusBar',setup(e){const t=(0,l.computed)(()=>i.character?.当前状态||[]),a=(0,l.ref)('');async function n(){a.value.trim()&&(await he.handleAction(a.value.trim()),a.value='')}return(e,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',ge,[(0,l.createElementVNode)('div',fe,[t.value.length>0&&'$__META_EXTENSIBLE__$'!==t.value[0]?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(t.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'status-effect',title:'object'==typeof e?e.description:''},[o[1]||(o[1]=(0,l.createElementVNode)('div',{class:'effect-icon'},null,-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)('object'==typeof e?e.name:e),1)],8,ye))),128)):((0,l.openBlock)(),(0,l.createElementBlock)('div',ke,[...o[2]||(o[2]=[(0,l.createElementVNode)('div',{class:'effect-icon'},null,-1),(0,l.createElementVNode)('span',null,'当前无状态效果',-1)])]))]),(0,l.createElementVNode)('div',Ee,[(0,l.withDirectives)((0,l.createElementVNode)('textarea',{id:'quick-send-input',class:'quick-send-input',placeholder:'请在此输入回复...','onUpdate:modelValue':o[0]||(o[0]=e=>a.value=e),onKeypress:(0,l.withKeys)((0,l.withModifiers)(n,['exact','prevent']),['enter'])},null,40,we),[[l.vModelText,a.value]]),(0,l.createElementVNode)('button',{id:'btn-quick-send',class:'interaction-btn',onClick:n},'发送')])]))}});var Ve=n(958);const be=(0,Ve.A)(Ne,[['__scopeId','data-v-b700c938']]),Se={class:'interaction-panel'},Be=(0,l.defineComponent)({__name:'InteractionPanel',emits:['showInventory','showCommandCenter','showExtracted','showSaveLoad'],setup:e=>(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Se,[(0,l.createElementVNode)('button',{id:'btn-inventory',class:'interaction-btn',onClick:t[0]||(t[0]=t=>e.$emit('showInventory'))},'背包'),(0,l.createElementVNode)('button',{id:'btn-command-center',class:'interaction-btn',onClick:t[1]||(t[1]=t=>e.$emit('showCommandCenter'))},'指令中心'),(0,l.createElementVNode)('button',{id:'btn-show-extracted',class:'interaction-btn',onClick:t[2]||(t[2]=t=>e.$emit('showExtracted'))},'查看提取内容'),(0,l.createElementVNode)('button',{id:'btn-save-load-manager',class:'interaction-btn',onClick:t[3]||(t[3]=t=>e.$emit('showSaveLoad'))},'存档/读档'),(0,l.createCommentVNode)(' 新增：统一的世界书控制模块 '),t[4]||(t[4]=(0,l.createStaticVNode)('<div id="world-book-controls" class="panel-section" data-v-7b143514><div class="section-title" data-v-7b143514>世界书控制</div><div class="world-book-controls-content" data-v-7b143514><div class="world-book-control-row" data-v-7b143514><label for="unified-index-input" class="world-book-label" data-v-7b143514>读写序号:</label><input type="number" id="unified-index-input" class="world-book-input" value="1" min="1" data-v-7b143514></div><div class="world-book-control-row" data-v-7b143514><input type="checkbox" id="auto-toggle-lorebook-checkbox" style="cursor:pointer;" data-v-7b143514><label for="auto-toggle-lorebook-checkbox" class="auto-write-label" data-v-7b143514>自动开关世界书</label></div></div></div>',1)),(0,l.createCommentVNode)(' 时间线按钮已移至存档界面 '),t[5]||(t[5]=(0,l.createElementVNode)('div',{class:'world-line-section'},[(0,l.createElementVNode)('div',{class:'world-line-title'},'历史记录'),(0,l.createElementVNode)('div',{class:'history-buttons-container'},[(0,l.createElementVNode)('button',{id:'btn-view-campus-log',class:'interaction-btn primary-btn btn-view-campus-log'},' 校园日志 ')])],-1))]))}),Ce=(0,Ve.A)(Be,[['__scopeId','data-v-7b143514']]),$e={class:'modal-content'},De={class:'modal-header'},Ie={class:'modal-title'},_e={class:'modal-body'},Ae=(0,l.defineComponent)({__name:'Modal',props:{show:{type:Boolean,required:!0},title:{type:String,default:'Modal Title'}},emits:['close'],setup:e=>(t,a)=>e.show?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-backdrop',onClick:a[1]||(a[1]=(0,l.withModifiers)(e=>t.$emit('close'),['self']))},[(0,l.createElementVNode)('div',$e,[(0,l.createElementVNode)('div',De,[(0,l.createElementVNode)('h2',Ie,(0,l.toDisplayString)(e.title),1),(0,l.createElementVNode)('button',{class:'modal-close-btn',onClick:a[0]||(a[0]=e=>t.$emit('close'))},'×')]),(0,l.createElementVNode)('div',_e,[(0,l.renderSlot)(t.$slots,'default')])])])):(0,l.createCommentVNode)('v-if',!0)}),xe=(0,Ve.A)(Ae,[['__scopeId','data-v-65298b40']]),Me={class:'add-friend-modal-content'},Te={class:'add-friend-search-bar'},Le={class:'search-results-list'},Fe={key:0,class:'search-prompt'},Oe={key:1,class:'search-prompt'},je={class:'result-name'},qe={class:'result-class'},Ue=['onClick'],He=(0,l.defineComponent)({__name:'AddFriendModal',props:{show:Boolean},emits:['close'],setup(e,{emit:t}){const a=t,n=(0,l.ref)(''),o=(0,l.ref)([]),r=(0,l.ref)(!1);async function c(){r.value=!0;const e=n.value.toLowerCase().trim();if(!e)return void(o.value=[]);let t=(0,d.get)(i.worldState,'角色',{});try{const e=(await TavernHelper.getLorebookEntries('天华校园')).find(e=>'[世界观]全校名册'===e.comment);if(e&&e.content){t={...function(e){const t={};if(!e)return t;const a=e.split('\n');let n='';for(const e of a){const a=e.match(/(\d年[A-E]班)/);if(a){n=a[1];continue}const o=e.match(/\d+\.\s*(.+?)\s*([♂♀])/);if(o&&n){const e=o[1].trim(),a=e.length>2?e.substring(0,2):e.substring(0,1),l=e.length>2?e.substring(2):e.substring(1),r=`${a}_${l}`.toLowerCase();t[r]={id:r,姓:[a],名:[l],班级:[n]}}}return t}(e.content),...t}}}catch(e){console.error('无法加载或解析全校名册:',e)}const a=i.userId;o.value=Object.values(t).filter(t=>{if(!t.名||t.id===a||'$meta'===t.id||'template'===t.id)return!1;const n=`${(0,d.get)(t,'姓[0]','')}${(0,d.get)(t,'名[0]','')}`.toLowerCase(),o='好友'===(0,d.get)(t,'聊天状态[0]');return n.includes(e)&&!o}).map(e=>({id:e.id,name:`${(0,d.get)(e,'姓[0]','')}${(0,d.get)(e,'名[0]','')}`,班级:(0,d.get)(e,'班级',['未知'])}))}return(t,s)=>((0,l.openBlock)(),(0,l.createBlock)(xe,{show:e.show,onClose:s[1]||(s[1]=e=>t.$emit('close')),title:'添加好友'},{default:(0,l.withCtx)(()=>[(0,l.createElementVNode)('div',Me,[(0,l.createElementVNode)('div',Te,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'text','onUpdate:modelValue':s[0]||(s[0]=e=>n.value=e),placeholder:'输入姓名搜索全校学生...',onKeypress:(0,l.withKeys)(c,['enter'])},null,544),[[l.vModelText,n.value]]),(0,l.createElementVNode)('button',{onClick:c,class:'interaction-btn'},'搜索')]),(0,l.createElementVNode)('div',Le,[r.value?0===o.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Oe,'未找到符合条件的学生。')):((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:2},(0,l.renderList)(o.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'search-result-item'},[(0,l.createElementVNode)('span',je,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('span',qe,(0,l.toDisplayString)(e.班级[0]),1),(0,l.createElementVNode)('button',{class:'interaction-btn btn-small btn-add-friend',onClick:t=>function(e){const t=prompt(`请输入对 ${e.name} 的好友请求消息（20字以内）：`,`你好，我是${g.value}，可以加个好友吗？`);null!==t&&(t.length>20?alert('消息过长，请不要超过20个字。'):(he.addActionToQueue({action:'addFriend',characterId:e.id,characterName:e.name,message:t||'你好，可以加个好友吗？'}),a('close')))}(e)},'添加',8,Ue)]))),128)):((0,l.openBlock)(),(0,l.createElementBlock)('div',Fe,'请输入要搜索的姓名。'))])])]),_:1},8,['show']))}}),ze=(0,Ve.A)(He,[['__scopeId','data-v-bea6e394']]),Pe=(0,l.defineComponent)({__name:'CommandCenterModal',props:{show:{type:Boolean}},emits:['close'],setup:e=>(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(xe,{show:e.show,onClose:t[0]||(t[0]=t=>e.$emit('close'))},{header:(0,l.withCtx)(()=>[...t[1]||(t[1]=[(0,l.createElementVNode)('h2',{class:'modal-title'},'指令中心',-1)])]),body:(0,l.withCtx)(()=>[...t[2]||(t[2]=[(0,l.createElementVNode)('p',null,'指令中心内容将在此处实现。',-1)])]),_:1},8,['show']))}),Ge=(0,l.defineComponent)({__name:'ExtractedContentModal',props:{show:{type:Boolean}},emits:['close'],setup:e=>(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(xe,{show:e.show,onClose:t[0]||(t[0]=t=>e.$emit('close'))},{header:(0,l.withCtx)(()=>[...t[1]||(t[1]=[(0,l.createElementVNode)('h2',{class:'modal-title'},'最后一次提取的AI内容',-1)])]),body:(0,l.withCtx)(()=>[...t[2]||(t[2]=[(0,l.createElementVNode)('p',null,'提取内容将在此处实现。',-1)])]),_:1},8,['show']))}),Re=(0,l.defineComponent)({__name:'InventoryModal',props:{show:{type:Boolean,required:!0}},emits:['close'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createBlock)(xe,{show:e.show,title:'我的背包',onClose:a[0]||(a[0]=e=>t.$emit('close'))},{default:(0,l.withCtx)(()=>[...a[1]||(a[1]=[(0,l.createElementVNode)('div',{class:'inventory-container'},[(0,l.createElementVNode)('div',{class:'inventory-menu-column'},[(0,l.createCommentVNode)(' 分类菜单将由JS填充 '),(0,l.createElementVNode)('div',{class:'menu-item active'},'全部'),(0,l.createElementVNode)('div',{class:'menu-item'},'消耗品'),(0,l.createElementVNode)('div',{class:'menu-item'},'装备'),(0,l.createElementVNode)('div',{class:'menu-item'},'任务物品')]),(0,l.createElementVNode)('div',{class:'inventory-display-column'},[(0,l.createCommentVNode)(' 物品列表将由JS填充 '),(0,l.createElementVNode)('p',{class:'empty-category-text'},'背包是空的。')])],-1)])]),_:1},8,['show']))}),We=(0,Ve.A)(Re,[['__scopeId','data-v-7be4a277']]),Xe=(0,l.defineComponent)({__name:'SaveLoadModal',props:{show:{type:Boolean}},emits:['close'],setup:e=>(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(xe,{show:e.show,onClose:t[0]||(t[0]=t=>e.$emit('close'))},{header:(0,l.withCtx)(()=>[...t[1]||(t[1]=[(0,l.createElementVNode)('h2',{class:'modal-title'},'存档/读档',-1)])]),body:(0,l.withCtx)(()=>[...t[2]||(t[2]=[(0,l.createElementVNode)('p',null,'存档/读档功能将在此处实现。',-1)])]),_:1},8,['show']))}),Ye={class:'top-status'},Je={class:'status-item'},Ke={id:'val-char-info',class:'status-value'},Ze={class:'world-info-container'},Qe={class:'info-panel time-panel'},et={class:'info-item'},tt={id:'val-date',class:'info-value'},at={class:'info-item'},nt={id:'val-time-period',class:'info-value'},ot={class:'info-panel environment-panel'},lt={id:'info-weather',class:'info-item clickable'},rt={id:'val-weather',class:'info-value'},ct={id:'info-location',class:'info-item clickable'},st={id:'val-location',class:'info-value'},it={class:'status-item'},dt={id:'val-main-resources',class:'status-value'},ut={id:'bar-resources',class:'guixu-charge'},mt=(0,l.defineComponent)({__name:'TopStatusBar',setup(e){const t=(0,l.computed)(()=>h.value),a=(0,l.computed)(()=>y.value),n=(0,l.computed)(()=>k.value),o=(0,l.computed)(()=>E.value),r=(0,l.computed)(()=>w.value),c=(0,l.computed)(()=>b.value),s=(0,l.computed)(()=>S.value);return(e,i)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ye,[(0,l.createElementVNode)('div',Je,[i[0]||(i[0]=(0,l.createElementVNode)('div',{class:'status-label'},'角色信息',-1)),(0,l.createElementVNode)('div',Ke,(0,l.toDisplayString)(t.value),1)]),(0,l.createElementVNode)('div',Ze,[(0,l.createElementVNode)('div',Qe,[(0,l.createElementVNode)('div',et,[i[1]||(i[1]=(0,l.createElementVNode)('span',{class:'info-label'},'日期:',-1)),(0,l.createElementVNode)('span',tt,(0,l.toDisplayString)(a.value),1)]),(0,l.createElementVNode)('div',at,[i[2]||(i[2]=(0,l.createElementVNode)('span',{class:'info-label'},'时间:',-1)),(0,l.createElementVNode)('span',nt,(0,l.toDisplayString)(n.value),1)])]),(0,l.createElementVNode)('div',ot,[(0,l.createElementVNode)('div',lt,[i[3]||(i[3]=(0,l.createElementVNode)('span',{class:'info-label'},'天气:',-1)),(0,l.createElementVNode)('span',rt,(0,l.toDisplayString)(o.value),1)]),(0,l.createElementVNode)('div',ct,[i[4]||(i[4]=(0,l.createElementVNode)('span',{class:'info-label'},'地点:',-1)),(0,l.createElementVNode)('span',st,(0,l.toDisplayString)(r.value),1)])])]),(0,l.createElementVNode)('div',it,[i[5]||(i[5]=(0,l.createElementVNode)('div',{class:'status-label'},'核心资源',-1)),(0,l.createElementVNode)('div',dt,(0,l.toDisplayString)(c.value),1),(0,l.createElementVNode)('div',ut,[(0,l.createElementVNode)('div',{class:'guixu-fill',style:(0,l.normalizeStyle)({width:s.value+'%'})},null,4)])])]))}}),pt=(0,Ve.A)(mt,[['__scopeId','data-v-bf75757c']]);function vt(e){return document.getElementById(e)}const ht=(0,l.reactive)({activeApp:null,activeChatId:null,openApp(e,t){this.activeApp=e,'tianhuachat'===e&&t?.chatId&&(this.activeChatId=t.chatId)},closeApp(){this.activeApp=null,this.activeChatId=null}}),gt='a'.charCodeAt(0),z='z'.charCodeAt(0),ft='A'.charCodeAt(0),yt='Z'.charCodeAt(0),kt=['#1abc9c','#2ecc71','#3498db','#9b59b6','#34495e','#16a085','#27ae60','#2980b9','#8e44ad','#2c3e50','#f1c40f','#e67e22','#e74c3c','#ecf0f1','#95a5a6','#f39c12','#d35400','#c0392b','#bdc3c7','#7f8c8d'];function Et(e,t){if(t){const a=(0,d.get)(i.worldState,['角色头像',t],null)||(0,d.get)(i.worldState,['角色',t,'头像'],null);if(a&&'string'==typeof a)return`<img src="${a}" alt="${e}" style="width: 100%; height: 100%; object-fit: cover;">`}if(!e)return`<div style="background-color: ${kt[0]}; display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; color: white; font-weight: bold;">?</div>`;const a=e.substring(0,1).toUpperCase(),n=function(e){if(!e||0===e.length)return kt[0];const t=e.charCodeAt(0);let a;return a=t>=gt&&t<=z?t-gt:t>=ft&&t<=yt?t-ft:0,kt[a%kt.length]}(e);return`<div style="background-color: ${n}; display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; color: white; font-weight: bold;">${a}</div>`}const wt={class:'message-view'},Nt={class:'chat-list'},Vt=['onClick'],bt=['innerHTML'],St={class:'chat-info'},Bt={class:'chat-name'},Ct={key:0,class:'group-tag'},$t={class:'last-message'},Dt={class:'chat-meta'},It={class:'last-time'},_t={key:0,class:'unread-badge'},At=(0,l.defineComponent)({__name:'MessageView',emits:['view-chat'],setup(e){const t=(0,l.computed)(()=>T.value);return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',wt,[(0,l.createElementVNode)('div',Nt,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:'chat-item',key:t.id,onClick:a=>e.$emit('view-chat',t.id)},[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['avatar',{'group-avatar':t.isGroup}]),innerHTML:(0,l.unref)(Et)(t.name,t.characterId||t.id)},null,10,bt),(0,l.createElementVNode)('div',St,[(0,l.createElementVNode)('div',Bt,[(0,l.createTextVNode)((0,l.toDisplayString)(t.name)+' ',1),t.isGroup?((0,l.openBlock)(),(0,l.createElementBlock)('span',Ct,'群')):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',$t,(0,l.toDisplayString)(t.lastMessage),1)]),(0,l.createElementVNode)('div',Dt,[(0,l.createElementVNode)('div',It,(0,l.toDisplayString)(t.lastTime),1),t.unreadCount>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',_t,(0,l.toDisplayString)(t.unreadCount),1)):(0,l.createCommentVNode)('v-if',!0)])],8,Vt))),128))])]))}}),xt=(0,Ve.A)(At,[['__scopeId','data-v-578c2f82']]),Mt={class:'contacts-view'},Tt={class:'contacts-header contact-search-bar'},Lt={class:'contact-function-list'},Ft={class:'count'},Ot={class:'count'},jt={class:'contacts-list',id:'contact-groups-container'},qt=['onClick','data-contact-id','data-is-group'],Ut=['innerHTML'],Ht={class:'contact-details'},zt={class:'contact-name'},Pt={key:0,class:'contact-signature'},Gt=(0,l.defineComponent)({__name:'ContactsView',emits:['view-chat','view-new-friends','view-group-list','view-contact-detail'],setup(e,{emit:t}){const a=(0,l.computed)(()=>L.value),n=(0,l.ref)(''),o=(0,l.computed)(()=>{if(!n.value)return a.value;const e=n.value.toLowerCase();return a.value.map(t=>{const a=t.contacts.filter(t=>t.name.toLowerCase().includes(e));return{...t,contacts:a}}).filter(e=>e.contacts.length>0)}),r=(0,l.computed)(()=>{const e=a.value.find(e=>'新的朋友'===e.name);return e?e.contacts.length:0}),c=t;const s=(0,l.computed)(()=>{const e=a.value.find(e=>'群聊'===e.name);return e?e.contacts.length:0});function d(){c('view-new-friends')}function u(){c('view-group-list')}function m(){i.isAddFriendModalVisible=!0}return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Mt,[(0,l.createElementVNode)('div',Tt,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'text',placeholder:'🔍 搜索','onUpdate:modelValue':t[0]||(t[0]=e=>n.value=e)},null,512),[[l.vModelText,n.value]]),(0,l.createElementVNode)('button',{class:'add-friend-btn',onClick:m},'+')]),(0,l.createElementVNode)('div',Lt,[(0,l.createElementVNode)('div',{class:'function-item',onClick:d},[t[1]||(t[1]=(0,l.createElementVNode)('span',null,'新的朋友',-1)),(0,l.createElementVNode)('span',Ft,(0,l.toDisplayString)(r.value),1)]),(0,l.createElementVNode)('div',{class:'function-item',onClick:u},[t[2]||(t[2]=(0,l.createElementVNode)('span',null,'群聊',-1)),(0,l.createElementVNode)('span',Ot,(0,l.toDisplayString)(s.value),1)])]),(0,l.createElementVNode)('div',jt,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('details',{class:'contact-group',key:e.name,open:''},[(0,l.createElementVNode)('summary',null,[(0,l.createTextVNode)((0,l.toDisplayString)(e.name)+' ',1),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(e.contacts.length),1)]),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.contacts,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:'contact-item',key:e.id,onClick:t=>function(e){e.isGroup?c('view-chat',e.id):c('view-contact-detail',e.id)}(e),'data-contact-id':e.id,'data-is-group':e.isGroup},[(0,l.createElementVNode)('div',{class:'avatar',innerHTML:(0,l.unref)(Et)(e.name,e.id)},null,8,Ut),(0,l.createElementVNode)('div',Ht,[(0,l.createElementVNode)('span',zt,(0,l.toDisplayString)(e.name),1),e.signature?((0,l.openBlock)(),(0,l.createElementBlock)('p',Pt,(0,l.toDisplayString)(e.signature),1)):(0,l.createCommentVNode)('v-if',!0)])],8,qt))),128))]))),128))])]))}}),Rt=(0,Ve.A)(Gt,[['__scopeId','data-v-7396e567']]),Wt={class:'moments-view'},Xt={class:'moment-header'},Yt={class:'avatar'},Jt={class:'author-info'},Kt={class:'author-name'},Zt={class:'timestamp'},Qt={class:'moment-content'},ea={class:'moment-actions'},ta=(0,l.defineComponent)({__name:'MomentsView',setup(e){const t=(0,l.computed)(()=>F.value);return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Wt,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:'moment-card',key:e.ID},[(0,l.createElementVNode)('div',Xt,[(0,l.createElementVNode)('div',Yt,(0,l.toDisplayString)(e.avatarName),1),(0,l.createElementVNode)('div',Jt,[(0,l.createElementVNode)('div',Kt,(0,l.toDisplayString)(e.authorName),1),(0,l.createElementVNode)('div',Zt,(0,l.toDisplayString)(e.时间戳),1)])]),(0,l.createElementVNode)('div',Qt,[(0,l.createElementVNode)('p',null,(0,l.toDisplayString)(e.内容),1)]),(0,l.createElementVNode)('div',ea,[(0,l.createElementVNode)('button',null,'❤️ '+(0,l.toDisplayString)(e.点赞.length),1),(0,l.createElementVNode)('button',null,'💬 '+(0,l.toDisplayString)(e.评论.length),1)])]))),128))]))}}),aa=(0,Ve.A)(ta,[['__scopeId','data-v-329cf6a5']]),na={class:'chat-view'},oa={class:'chat-header'},la={class:'chat-title'},ra={key:0,class:'chat-bubble-wrapper system'},ca={class:'chat-bubble'},sa=['innerHTML'],ia={class:'chat-bubble-content'},da={class:'chat-sender-name'},ua={class:'message-line'},ma={class:'chat-bubble'},pa={class:'chat-timestamp'},va={class:'chat-input-area'},ha=['onKeypress'],ga=(0,l.defineComponent)({__name:'ChatView',props:{conversationId:{type:String,required:!0}},emits:['back'],setup(e){const t=e,a=(0,l.computed)(()=>{const e=T.value.find(e=>e.id===t.conversationId);return e?e.name:'聊天'}),n=(0,l.ref)(null),o=(0,l.ref)(null),r=(0,l.ref)(''),c=(0,l.computed)(()=>{if(!i.worldState)return[];const e=T.value.find(e=>e.id===t.conversationId);if(!e)return[];return(e.isGroup?(0,d.get)(i.worldState,`聊天群组.${t.conversationId}.历史`,[]):(0,d.get)(i.worldState,`聊天会话列表.${t.conversationId}.历史`,[])).map(e=>{const t='string'==typeof e&&e.startsWith('[')&&e.endsWith(']')?e.slice(1,-1):e,a=t.split('|'),n=a[0],o=g.value||'{{user}}',l=(0,d.get)(i.worldState,'角色',{});if('私聊'===n||'群聊'===n){let e=a[1]||'',t=a[3]||'',n=a.slice(4).join('|'),r='未知';const c=e===i.userId||'{{user}}'===e;if(c)r=o,e=i.userId;else{const t=l[e];r=t?`${(0,d.get)(t,'姓[0]','')}${(0,d.get)(t,'名[0]','')}`:e}return{isSystem:!1,isUser:c,sender:r,senderId:e,text:n,timestamp:t}}return{isSystem:!0,text:a.length>1?a.slice(1).join('|'):t,isUser:!1,sender:'System',timestamp:'',senderId:'system'}})}),s=(0,l.ref)('');function u(){const e=s.value.trim();if(!e)return;const a=T.value.find(e=>e.id===t.conversationId);if(!a)return;const n=r.value,c=n?`【${n}】${e}`:e,u=a.isGroup?`worldState.聊天群组.${t.conversationId}.历史`:`worldState.聊天会话列表.${t.conversationId}.历史`,m=(0,d.get)(i,u,[]),h=a.isGroup?t.conversationId:a.characterId,g=`[${a.isGroup?'群聊':'私聊'}|${i.userId}|${h}|${k.value}|${c}]`;m.push(g),he.addActionToQueue({action:'chat',chatId:t.conversationId,isGroup:a.isGroup,message:c}),s.value='',(0,l.nextTick)(()=>{o.value&&v(),p()})}function m(e){e.shiftKey||u()}function p(){n.value&&(n.value.scrollTop=n.value.scrollHeight)}function v(){if(o.value){o.value.style.height='auto',o.value.style.height=`${o.value.scrollHeight}px`;const e=o.value.closest('.chat-input-area');n.value&&e&&(n.value.style.paddingBottom=`${e.clientHeight}px`)}}return(0,l.watch)(c,()=>{(0,l.nextTick)(p)},{deep:!0,immediate:!0}),(0,l.onMounted)(()=>{const e=T.value.find(e=>e.id===t.conversationId);if(e&&!e.isGroup&&e.unreadCount>0){const e=(0,d.get)(i.worldState,`聊天会话列表.${t.conversationId}`);e&&(e.未读数=0)}(0,l.nextTick)(()=>{v(),p()})}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',na,[(0,l.createElementVNode)('div',oa,[(0,l.createElementVNode)('button',{class:'back-btn',onClick:t[0]||(t[0]=t=>e.$emit('back'))},'‹'),(0,l.createElementVNode)('span',la,(0,l.toDisplayString)(a.value),1)]),(0,l.createElementVNode)('div',{class:'message-list',ref_key:'messageListEl',ref:n},[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(c.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:t},[e.isSystem?((0,l.openBlock)(),(0,l.createElementBlock)('div',ra,[(0,l.createElementVNode)('div',ca,(0,l.toDisplayString)(e.text),1)])):((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:1,class:(0,l.normalizeClass)(['chat-bubble-wrapper',{user:e.isUser,other:!e.isUser}])},[(0,l.createElementVNode)('div',{class:'chat-avatar',innerHTML:(0,l.unref)(Et)(e.sender,e.senderId)},null,8,sa),(0,l.createElementVNode)('div',ia,[(0,l.createElementVNode)('div',da,(0,l.toDisplayString)(e.sender),1),(0,l.createElementVNode)('div',ua,[(0,l.createElementVNode)('div',ma,(0,l.toDisplayString)(e.text),1),(0,l.createElementVNode)('div',pa,(0,l.toDisplayString)(e.timestamp),1)])])],2))],64))),128))],512),(0,l.createElementVNode)('div',va,[(0,l.withDirectives)((0,l.createElementVNode)('select',{class:'chat-prefix-select','onUpdate:modelValue':t[1]||(t[1]=e=>r.value=e)},[...t[3]||(t[3]=[(0,l.createElementVNode)('option',{value:''},'对话',-1),(0,l.createElementVNode)('option',{value:'图片'},'图片',-1),(0,l.createElementVNode)('option',{value:'红包'},'红包',-1),(0,l.createElementVNode)('option',{value:'语音'},'语音',-1)])],512),[[l.vModelSelect,r.value]]),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{placeholder:'输入消息...','onUpdate:modelValue':t[2]||(t[2]=e=>s.value=e),onKeypress:(0,l.withKeys)((0,l.withModifiers)(m,['prevent']),['enter']),ref_key:'inputEl',ref:o,onInput:v},null,40,ha),[[l.vModelText,s.value]]),(0,l.createElementVNode)('button',{onClick:u,class:'interaction-btn primary-btn'},[...t[4]||(t[4]=[(0,l.createElementVNode)('svg',{xmlns:'http://www.w3.org/2000/svg',width:'20',height:'20',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2','stroke-linecap':'round','stroke-linejoin':'round'},[(0,l.createElementVNode)('line',{x1:'22',y1:'2',x2:'11',y2:'13'}),(0,l.createElementVNode)('polygon',{points:'22 2 15 22 11 13 2 9 22 2'})],-1)])])])]))}}),fa=(0,Ve.A)(ga,[['__scopeId','data-v-8d9c9384']]),ya={class:'new-friends-view'},ka={class:'header'},Ea={class:'friend-request-list'},wa=['innerHTML'],Na={class:'request-info'},Va={class:'name'},ba={class:'actions'},Sa=['onClick'],Ba=['onClick'],Ca={key:0,class:'no-requests'},$a=(0,l.defineComponent)({__name:'NewFriendsView',emits:['back'],setup(e){const t=(0,l.computed)(()=>{const e=L.value.find(e=>'新的朋友'===e.name);return e?e.contacts:[]});function a(e,a){const n=t.value.find(t=>t.id===e)?.name||'该用户',o='accept'===a?`接受了 ${n} 的好友请求`:`拒绝了 ${n} 的好友请求`;he.addActionToQueue({action:'handleFriendRequest',characterId:e,requestType:a}),he.handleAction(o),alert(`${'accept'===a?'已接受':'已拒绝'} ${n} 的好友请求。`)}return(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',ya,[(0,l.createElementVNode)('div',ka,[(0,l.createElementVNode)('button',{onClick:n[0]||(n[0]=t=>e.$emit('back')),class:'back-btn'},'<'),n[1]||(n[1]=(0,l.createElementVNode)('h1',null,'新的朋友',-1))]),(0,l.createElementVNode)('div',Ea,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'request-item'},[(0,l.createElementVNode)('div',{class:'avatar',innerHTML:(0,l.unref)(Et)(e.name,e.id)},null,8,wa),(0,l.createElementVNode)('div',Na,[(0,l.createElementVNode)('div',Va,(0,l.toDisplayString)(e.name),1),n[2]||(n[2]=(0,l.createElementVNode)('div',{class:'message'},'请求添加你为好友',-1))]),(0,l.createElementVNode)('div',ba,[(0,l.createElementVNode)('button',{onClick:t=>a(e.id,'accept'),class:'accept-btn'},'接受',8,Sa),(0,l.createElementVNode)('button',{onClick:t=>a(e.id,'reject'),class:'reject-btn'},'拒绝',8,Ba)])]))),128)),0===t.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ca,' 没有新的朋友请求 ')):(0,l.createCommentVNode)('v-if',!0)])]))}}),Da=(0,Ve.A)($a,[['__scopeId','data-v-62dcff5d']]),Ia={class:'group-list-view'},_a={class:'header'},Aa={class:'group-list'},xa=['onClick'],Ma={class:'avatar group-avatar'},Ta={class:'group-name'},La={key:0,class:'no-groups'},Fa=(0,l.defineComponent)({__name:'GroupListView',emits:['back','view-chat'],setup(e){const t=(0,l.computed)(()=>{const e=L.value.find(e=>'群聊'===e.name);return e?e.contacts:[]});return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ia,[(0,l.createElementVNode)('div',_a,[(0,l.createElementVNode)('button',{onClick:a[0]||(a[0]=t=>e.$emit('back')),class:'back-btn'},'<'),a[1]||(a[1]=(0,l.createElementVNode)('h1',null,'群聊',-1))]),(0,l.createElementVNode)('div',Aa,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:'group-item',onClick:a=>e.$emit('view-chat',t.id)},[(0,l.createElementVNode)('div',Ma,(0,l.toDisplayString)(t.avatarName),1),(0,l.createElementVNode)('div',Ta,(0,l.toDisplayString)(t.name),1)],8,xa))),128)),0===t.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',La,' 你还没有加入任何群聊 ')):(0,l.createCommentVNode)('v-if',!0)])]))}}),Oa=(0,Ve.A)(Fa,[['__scopeId','data-v-456cb086']]),ja={class:'contact-detail-view'},qa={class:'header'},Ua={key:0,class:'contact-content'},Ha={class:'profile-header'},za=['innerHTML'],Pa={class:'name-section'},Ga={class:'name'},Ra={class:'signature'},Wa={class:'info-list'},Xa={class:'info-item'},Ya={class:'value'},Ja={class:'info-item'},Ka={class:'value'},Za={class:'actions'},Qa={key:1,class:'loading'},en=(0,l.defineComponent)({__name:'ContactDetailView',props:{contactId:{type:String,required:!0}},emits:['back','view-chat'],setup(e){const t=e,a=(0,l.computed)(()=>{if(!t.contactId||!i.worldState)return null;const e=(0,d.get)(i.worldState,`角色.${t.contactId}`);if(!e)return null;const a=[i.userId,t.contactId].sort(),n=`chat_${a[0]}_${a[1]}`;return{id:t.contactId,name:`${u(e,'姓','',!0)}${u(e,'名','',!0)}`||t.contactId,signature:u(e,'签名','...',!0),class:u(e,'班级','未知',!0),chatId:n}});return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',ja,[(0,l.createElementVNode)('div',qa,[(0,l.createElementVNode)('button',{onClick:t[0]||(t[0]=t=>e.$emit('back')),class:'back-btn'},'<'),t[2]||(t[2]=(0,l.createElementVNode)('h1',null,'详细资料',-1))]),a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ua,[(0,l.createElementVNode)('div',Ha,[(0,l.createElementVNode)('div',{class:'avatar',innerHTML:(0,l.unref)(Et)(a.value.name,a.value.id)},null,8,za),(0,l.createElementVNode)('div',Pa,[(0,l.createElementVNode)('h2',Ga,(0,l.toDisplayString)(a.value.name),1),(0,l.createElementVNode)('p',Ra,'"'+(0,l.toDisplayString)(a.value.signature)+'"',1)])]),(0,l.createElementVNode)('div',Wa,[(0,l.createElementVNode)('div',Xa,[t[3]||(t[3]=(0,l.createElementVNode)('span',{class:'label'},'班级',-1)),(0,l.createElementVNode)('span',Ya,(0,l.toDisplayString)(a.value.class),1)]),(0,l.createElementVNode)('div',Ja,[t[4]||(t[4]=(0,l.createElementVNode)('span',{class:'label'},'ID',-1)),(0,l.createElementVNode)('span',Ka,(0,l.toDisplayString)(a.value.id),1)])]),(0,l.createElementVNode)('div',Za,[(0,l.createElementVNode)('button',{onClick:t[1]||(t[1]=t=>e.$emit('view-chat',a.value.chatId)),class:'chat-btn'},'发消息')])])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Qa,' 加载中... '))]))}}),tn=(0,Ve.A)(en,[['__scopeId','data-v-03746552']]),an={class:'tianhuachat-app'},nn={key:0,class:'main-view'},on={class:'app-header'},ln={class:'app-content'},rn={class:'app-nav'},cn=(0,l.defineComponent)({__name:'TianhuaChat',setup(e){const t=(0,l.ref)('messages'),a=(0,l.ref)(null),n=(0,l.ref)(null),o=(0,l.ref)('main'),r={messages:{component:xt,name:'天华信'},contacts:{component:Rt,name:'联系人'},moments:{component:aa,name:'MX空间'}},c=(0,l.computed)(()=>r[t.value].component),s=(0,l.computed)(()=>r[t.value].name);function i(e){a.value=e,o.value='chat'}function d(){a.value=null,o.value='main'}function u(e){n.value=e,o.value='contactDetail'}return(e,r)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',an,['main'===o.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',nn,[(0,l.createElementVNode)('div',on,[(0,l.createElementVNode)('h1',null,(0,l.toDisplayString)(s.value),1)]),(0,l.createElementVNode)('div',ln,[((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(c.value),{onViewChat:i,onViewNewFriends:r[0]||(r[0]=e=>o.value='newFriends'),onViewGroupList:r[1]||(r[1]=e=>o.value='groupList'),onViewContactDetail:u},null,32))]),(0,l.createElementVNode)('div',rn,[(0,l.createElementVNode)('button',{onClick:r[2]||(r[2]=e=>t.value='messages'),class:(0,l.normalizeClass)({active:'messages'===t.value})},'消息',2),(0,l.createElementVNode)('button',{onClick:r[3]||(r[3]=e=>t.value='contacts'),class:(0,l.normalizeClass)({active:'contacts'===t.value})},'联系人',2),(0,l.createElementVNode)('button',{onClick:r[4]||(r[4]=e=>t.value='moments'),class:(0,l.normalizeClass)({active:'moments'===t.value})},'空间',2)])])):'chat'===o.value&&a.value?((0,l.openBlock)(),(0,l.createBlock)(fa,{key:1,'conversation-id':a.value,onBack:d},null,8,['conversation-id'])):'newFriends'===o.value?((0,l.openBlock)(),(0,l.createBlock)(Da,{key:2,onBack:r[5]||(r[5]=e=>o.value='main')})):'groupList'===o.value?((0,l.openBlock)(),(0,l.createBlock)(Oa,{key:3,onBack:r[6]||(r[6]=e=>o.value='main'),onViewChat:i})):'contactDetail'===o.value&&n.value?((0,l.openBlock)(),(0,l.createBlock)(tn,{key:4,'contact-id':n.value,onBack:r[7]||(r[7]=e=>o.value='main'),onViewChat:i},null,8,['contact-id'])):(0,l.createCommentVNode)('v-if',!0)]))}}),sn=(0,Ve.A)(cn,[['__scopeId','data-v-74dca3e8']]),dn={class:'schedule-view'},un={key:0,class:'event-notice'},mn={key:1},pn={class:'debug-info'},vn={class:'timeline-grid'},hn={class:'time-axis'},gn={class:'schedule-lanes'},fn={class:'day-header'},yn={class:'courses-container'},kn={class:'course-name'},En={class:'course-details'},wn=(0,l.defineComponent)({__name:'ScheduleView',setup(e){const t=['周一','周二','周三','周四','周五','周六','周日'],a=['08:00','09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00'],n=(0,l.computed)(()=>(0,d.get)(f.value,'星期','')),o=(0,l.computed)(()=>j.value),r=(0,l.computed)(()=>o.value?.效果?.some(e=>'暂停课程'===e.类型&&'激活'===e.状态)),c=(0,l.computed)(()=>o.value?.名称||'特别事件'),s=(0,l.computed)(()=>{const e=v.value?.['班级'];return Array.isArray(e)?e[0]:e||''}),u=(0,l.computed)(()=>{const e=(0,d.get)(i.worldState,'课程表-主','');if(!e||'string'!=typeof e)return[];return e.split('\n').filter(e=>!e.startsWith('#')&&''!==e.trim()).map((e,t)=>{const a=e.split('|');if(a.length<6)return null;const[n,o,l,r,c,s]=a;try{return{id:`${r}-${o}-${t}`,班级ID:n,课程名称:o,教师:l,上课日:r,节次:JSON.parse(c),教室ID:s}}catch(t){return console.error(`Failed to parse sections for line: ${e}`,t),null}}).filter(Boolean)}),m=(0,l.computed)(()=>u.value.length),p=(0,l.computed)(()=>u.value.filter(e=>e&&e.班级ID===s.value)),h=e=>p.value.filter(t=>t.上课日===e),g=e=>{const t=[0,0,1,2,3,5,6,7,8],a=Math.min(...e.节次),n=Math.max(...e.节次),o=t[a]||0,l=['#3b82f6','#10b981','#f59e0b','#ef4444','#8b5cf6','#ec4899','#f97316','#14b8a6'];return{top:`${60*o}px`,height:`${60*((t[n]||o)-o+1)-4}px`,backgroundColor:l[Math.abs(e.课程名称.split('').reduce((e,t)=>e+t.charCodeAt(0),0))%l.length]}};return(e,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',dn,[r.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',un,[(0,l.createElementVNode)('h3',null,(0,l.toDisplayString)(c.value),1),o[0]||(o[0]=(0,l.createElementVNode)('p',null,'事件进行中，课程已暂停。',-1))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',mn,[(0,l.createCommentVNode)(' Debug Info '),(0,l.createElementVNode)('div',pn,[(0,l.createElementVNode)('p',null,[o[1]||(o[1]=(0,l.createTextVNode)(' Player Class: ',-1)),(0,l.createElementVNode)('code',null,(0,l.toDisplayString)(s.value),1)]),(0,l.createElementVNode)('p',null,[o[2]||(o[2]=(0,l.createTextVNode)(' Total Courses Parsed: ',-1)),(0,l.createElementVNode)('code',null,(0,l.toDisplayString)(m.value),1)]),(0,l.createElementVNode)('p',null,[o[3]||(o[3]=(0,l.createTextVNode)(' Filtered Courses: ',-1)),(0,l.createElementVNode)('code',null,(0,l.toDisplayString)(p.value.length),1)])]),(0,l.createElementVNode)('div',vn,[(0,l.createElementVNode)('div',hn,[((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a,e=>(0,l.createElementVNode)('div',{key:e,class:'time-slot'},(0,l.toDisplayString)(e),1)),64))]),(0,l.createElementVNode)('div',gn,[((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t,e=>(0,l.createElementVNode)('div',{key:e,class:(0,l.normalizeClass)(['day-lane',{today:e===n.value}])},[(0,l.createElementVNode)('div',fn,(0,l.toDisplayString)(e),1),(0,l.createElementVNode)('div',yn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(h(e),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'course-item',style:(0,l.normalizeStyle)(g(e))},[(0,l.createElementVNode)('p',kn,(0,l.toDisplayString)(e.课程名称),1),(0,l.createElementVNode)('p',En,'@ '+(0,l.toDisplayString)(e.教室ID),1)],4))),128))])],2)),64))])])]))]))}}),Nn=(0,Ve.A)(wn,[['__scopeId','data-v-2a5a5544']]),Vn={class:'grades-view'},bn={class:'summary-card'},Sn={class:'summary-item'},Bn={class:'value rank'},Cn={class:'subjects-grid'},$n={class:'subject-name'},Dn={class:'details'},In={class:'detail-item'},_n={class:'value score'},An={class:'detail-item'},xn={class:'value'},Mn=(0,l.defineComponent)({__name:'GradesView',setup(e){const t=(0,l.computed)(()=>D.value),a=(0,l.computed)(()=>(0,d.get)(v.value,'学业.综合排名[0]')??'N/A');return(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Vn,[(0,l.createElementVNode)('div',bn,[(0,l.createElementVNode)('div',Sn,[n[0]||(n[0]=(0,l.createElementVNode)('span',{class:'label'},'综合排名',-1)),(0,l.createElementVNode)('span',Bn,(0,l.toDisplayString)(a.value),1)])]),(0,l.createElementVNode)('div',Cn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'subject-card'},[(0,l.createElementVNode)('h3',$n,(0,l.toDisplayString)(t),1),(0,l.createElementVNode)('div',Dn,[(0,l.createElementVNode)('div',In,[n[1]||(n[1]=(0,l.createElementVNode)('span',{class:'label'},'最近分数',-1)),(0,l.createElementVNode)('span',_n,(0,l.toDisplayString)(e.最近一次分数),1)]),(0,l.createElementVNode)('div',An,[n[2]||(n[2]=(0,l.createElementVNode)('span',{class:'label'},'知识水平',-1)),(0,l.createElementVNode)('span',xn,(0,l.toDisplayString)(e.知识水平),1)])])]))),128))])]))}}),Tn=(0,Ve.A)(Mn,[['__scopeId','data-v-3a096e44']]),Ln={class:'notifications-view'},Fn={key:0,class:'notifications-list'},On={class:'card-header'},jn={class:'title'},qn={class:'time'},Un={class:'content'},Hn={class:'publisher'},zn={key:1,class:'no-notifications'},Pn=(0,l.defineComponent)({__name:'NotificationsView',setup(e){const t=(0,l.computed)(()=>{const e=(0,d.get)(i.worldState,'世界状态.公告');if(Array.isArray(e)){const t=e.filter(e=>e&&'object'==typeof e&&e.hasOwnProperty('标题'));if(t.length>0)return t.sort((e,t)=>new Date(t.时间).getTime()-new Date(e.时间).getTime())}return[{标题:'关于文化祭的通知',内容:'一年一度的天华学园文化祭将于下月15日举行，请各班级和社团踊跃报名参加。',发布者:'学生会',时间:'2024-09-1'},{标题:'图书馆闭馆通知',内容:'因系统维护，图书馆将于下周五（9月12日）下午闭馆半天，请同学们提前安排好借阅事宜。',发布者:'图书馆',时间:'2024-09-01'},{标题:'寻物启事',内容:'本人于今日在体育馆丢失一个蓝色水壶，如有拾获者请联系2年D班的比企谷八幡，万分感谢。',发布者:'比企谷八幡',时间:'2024-09-01'}].sort((e,t)=>new Date(t.时间).getTime()-new Date(e.时间).getTime())});return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ln,[t.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Fn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'notification-card'},[(0,l.createElementVNode)('div',On,[(0,l.createElementVNode)('h3',jn,(0,l.toDisplayString)(e.标题),1),(0,l.createElementVNode)('span',qn,(0,l.toDisplayString)(e.时间),1)]),(0,l.createElementVNode)('p',Un,(0,l.toDisplayString)(e.内容),1),(0,l.createElementVNode)('p',Hn,'发布者: '+(0,l.toDisplayString)(e.发布者),1)]))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',zn,[...a[0]||(a[0]=[(0,l.createElementVNode)('p',null,'暂无校园通知。',-1)])]))]))}}),Gn=(0,Ve.A)(Pn,[['__scopeId','data-v-420ddbcc']]),Rn={class:'campus-pass-app'},Wn={class:'app-tabs'},Xn={class:'app-content'},Yn=(0,l.defineComponent)({__name:'CampusPass',setup(e){const t=(0,l.ref)('schedule'),a={schedule:Nn,grades:Tn,notifications:Gn},n=(0,l.computed)(()=>a[t.value]);return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Rn,[a[3]||(a[3]=(0,l.createElementVNode)('div',{class:'app-header'},[(0,l.createElementVNode)('h1',null,'校园通')],-1)),(0,l.createElementVNode)('div',Wn,[(0,l.createElementVNode)('button',{onClick:a[0]||(a[0]=e=>t.value='schedule'),class:(0,l.normalizeClass)({active:'schedule'===t.value})},'课程表',2),(0,l.createElementVNode)('button',{onClick:a[1]||(a[1]=e=>t.value='grades'),class:(0,l.normalizeClass)({active:'grades'===t.value})},'成绩查询',2),(0,l.createElementVNode)('button',{onClick:a[2]||(a[2]=e=>t.value='notifications'),class:(0,l.normalizeClass)({active:'notifications'===t.value})},'校园通知',2)]),(0,l.createElementVNode)('div',Xn,[((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(n.value)))])]))}}),Jn=(0,Ve.A)(Yn,[['__scopeId','data-v-20695e41']]);async function Kn(e,t){const a={},n=await oe('[系统]事件触发器'),o=await oe('[世界观]世界事件库');if(!n||!o)return a;const l=await async function(e){const t=[];return e?(e.split('\n').filter(Boolean).forEach(e=>{if(e.startsWith('#'))return;const a=e.split('|');'date'===a[0]&&a.length>=3&&t.push({type:'date',condition:a[1],eventId:a[2]})}),t):t}(n),r=await async function(e){const t=new Map;return e?(e.split('\n').filter(Boolean).forEach(e=>{if(e.startsWith('#'))return;const a=e.split('|');a.length>=5&&t.set(a[0],{id:a[0],name:a[1],type:a[2],duration:parseInt(a[3],10),description:a[4]})}),t):t}(o);return l.forEach(n=>{if('date'===n.type){const[o,l]=n.condition.split('-').map(Number);if(o===t+1){const o=r.get(n.eventId);if(o){const r=new Date(e,t,l).toISOString().split('T')[0];a[r]||(a[r]=[]),a[r].push({id:n.eventId,name:o.name,type:'upcoming'})}}}}),a}function Zn(e){const t=new Map;if(!e)return t;const a=e.split('\n').filter(Boolean);let n={};return a.forEach(e=>{if(e.startsWith('#'))return;const[a,...o]=e.split('|'),l=o.join('|').trim();if('ID'===a.toUpperCase())n.id&&t.set(n.id,{...n,children:[]}),n={id:l};else{const e={名称:'name',类型:'type',父级ID:'parentId',描述:'description',网格坐标:'gridCoords',网格尺寸:'gridSize'}[a];if('gridCoords'===e&&l){const[e,t]=l.split(',').map(Number);n.gridX=e,n.gridY=t}else if('gridSize'===e&&l){const[e,t]=l.split(',').map(Number);n.gridWidth=e,n.gridHeight=t}else e&&(n[e]='null'===l?null:l)}}),n.id&&t.set(n.id,{...n,children:[]}),t}let Qn=null;async function eo(){if(Qn)return Qn;const e=await oe('[世界观]地点列表');return Qn=Zn(e),function(e){const t=[];e.forEach(a=>{if(a.parentId){const n=e.get(a.parentId);n?n.children.push(a):t.push(a)}else t.push(a)})}(Qn),Qn}const to={class:'modal-content'},ao={class:'form-group'},no={class:'form-group'},oo={class:'form-group'},lo=['value'],ro={class:'form-group'},co=(0,l.defineComponent)({__name:'AddScheduleModal',props:{show:{type:Boolean},date:{}},emits:['close'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.reactive)({timeOfDay:'上午',action:'',locationId:'',participants:''}),r=(0,l.ref)([]),c=(0,l.computed)(()=>a.date?a.date.toLocaleDateString('zh-CN',{month:'long',day:'numeric'}):''),s=()=>{n('close')},i=()=>{if(!a.date||!o.action)return;const e=`${o.timeOfDay} - ${o.action}`,t=r.value.find(e=>e.id===o.locationId)?.name||'未知地点',n=`(地点: ${t}, 参与者: ${o.participants})`,l={ID:`personal-${Date.now()}`,标题:`${e} ${n}`,日期:a.date.toISOString().split('T')[0],时间段:o.timeOfDay,行为:o.action,地点ID:o.locationId,地点名称:t,参与者:o.participants.split(',').map(e=>e.trim()).filter(Boolean)};he.updateCharacterData('日程[0]',l,!0),s()};return(0,l.watch)(()=>a.show,async e=>{if(e&&(o.timeOfDay='上午',o.action='',o.locationId='',o.participants='',0===r.value.length)){const e=await TavernHelper.world.getEntryText('天华校园','[世界观]地点列表');if(e){const t=Zn(e);r.value=Array.from(t.values())}}}),(e,t)=>e.show?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-backdrop',onClick:(0,l.withModifiers)(s,['self'])},[(0,l.createElementVNode)('div',to,[(0,l.createElementVNode)('h3',null,'为 '+(0,l.toDisplayString)(c.value)+' 添加日程',1),(0,l.createElementVNode)('form',{onSubmit:(0,l.withModifiers)(i,['prevent'])},[(0,l.createElementVNode)('div',ao,[t[5]||(t[5]=(0,l.createElementVNode)('label',null,'时间段',-1)),(0,l.withDirectives)((0,l.createElementVNode)('select',{'onUpdate:modelValue':t[0]||(t[0]=e=>o.timeOfDay=e)},[...t[4]||(t[4]=[(0,l.createElementVNode)('option',{value:'上午'},'上午',-1),(0,l.createElementVNode)('option',{value:'下午'},'下午',-1),(0,l.createElementVNode)('option',{value:'晚上'},'晚上',-1)])],512),[[l.vModelSelect,o.timeOfDay]])]),(0,l.createElementVNode)('div',no,[t[6]||(t[6]=(0,l.createElementVNode)('label',null,'行为',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'text','onUpdate:modelValue':t[1]||(t[1]=e=>o.action=e),placeholder:'要做什么？',required:''},null,512),[[l.vModelText,o.action]])]),(0,l.createElementVNode)('div',oo,[t[8]||(t[8]=(0,l.createElementVNode)('label',null,'地点',-1)),(0,l.withDirectives)((0,l.createElementVNode)('select',{'onUpdate:modelValue':t[2]||(t[2]=e=>o.locationId=e)},[t[7]||(t[7]=(0,l.createElementVNode)('option',{disabled:'',value:''},'请选择地点',-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(r.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:e.id,value:e.id},(0,l.toDisplayString)(e.name),9,lo))),128))],512),[[l.vModelSelect,o.locationId]])]),(0,l.createElementVNode)('div',ro,[t[9]||(t[9]=(0,l.createElementVNode)('label',null,'参与者',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'text','onUpdate:modelValue':t[3]||(t[3]=e=>o.participants=e),placeholder:'和谁一起？(用,分隔)'},null,512),[[l.vModelText,o.participants]])]),(0,l.createElementVNode)('div',{class:'modal-actions'},[(0,l.createElementVNode)('button',{type:'button',onClick:s},'取消'),t[10]||(t[10]=(0,l.createElementVNode)('button',{type:'submit'},'保存',-1))])],32)])])):(0,l.createCommentVNode)('v-if',!0)}}),so=(0,Ve.A)(co,[['__scopeId','data-v-0729bba8']]),io={class:'calendar-app'},uo={class:'app-header'},mo={class:'calendar-grid'},po=['onClick','onDblclick'],vo={class:'day-number'},ho={class:'events-container'},go=['title'],fo={key:0,class:'selected-day-details'},yo=(0,l.defineComponent)({__name:'CalendarApp',setup(e){const t=['日','一','二','三','四','五','六'],a=(0,l.ref)(new Date),n=(0,l.ref)(new Date),o=(0,l.computed)(()=>i.selectedDate),r=(0,l.ref)({}),c=(0,l.ref)(!1),s=(0,l.ref)(null),d=(0,l.computed)(()=>{const e=f.value;return e&&e.年&&e.月&&e.日});async function u(e,t){const a=q.value(e,t),n=await Kn(e,t),o={...a};for(const e in n)o[e]||(o[e]=[]),o[e].push(...n[e]);r.value=o}(0,l.watch)(n,e=>{d.value&&u(e.getFullYear(),e.getMonth())},{immediate:!0}),(0,l.watch)(d,e=>{if(e){const e=f.value,t=new Date(e.年,e.月-1,e.日);a.value=t,n.value=t,he.setSelectedDate(t),u(t.getFullYear(),t.getMonth())}},{immediate:!0});const m=(0,l.computed)(()=>d.value?`${n.value.getFullYear()}年 ${n.value.getMonth()+1}月`:'加载中...'),p=(0,l.computed)(()=>{const e=n.value.getFullYear(),t=n.value.getMonth(),o=new Date(e,t,1),l=new Date(e,t+1,0),c=l.getDate(),s=o.getDay(),i=[];for(let e=0;e<s;e++){const t=new Date(o);t.setDate(t.getDate()-(s-e)),i.push({date:t,isToday:!1,isCurrentMonth:!1,events:[]})}for(let n=1;n<=c;n++){const o=new Date(e,t,n),l=o.toISOString().split('T')[0];i.push({date:o,isToday:o.toDateString()===a.value.toDateString(),isCurrentMonth:!0,events:r.value[l]||[]})}const d=42-i.length;for(let e=1;e<=d;e++){const t=new Date(l);t.setDate(t.getDate()+e),i.push({date:t,isToday:!1,isCurrentMonth:!1,events:[]})}return i}),v=(0,l.computed)(()=>o.value?o.value.toLocaleDateString('zh-CN',{year:'numeric',month:'long',day:'numeric'}):''),h=(0,l.computed)(()=>{if(!o.value)return[];const e=o.value.toISOString().split('T')[0];return r.value[e]||[]}),g=()=>{n.value=new Date(n.value.setMonth(n.value.getMonth()-1))},y=()=>{n.value=new Date(n.value.setMonth(n.value.getMonth()+1))};return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createElementVNode)('div',io,[(0,l.createElementVNode)('div',uo,[(0,l.createElementVNode)('button',{onClick:g},'<'),(0,l.createElementVNode)('h2',null,(0,l.toDisplayString)(m.value),1),(0,l.createElementVNode)('button',{onClick:y},'>')]),(0,l.createElementVNode)('div',mo,[((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t,e=>(0,l.createElementVNode)('div',{key:e,class:'day-header'},(0,l.toDisplayString)(e),1)),64)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(p.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.date.toISOString(),class:(0,l.normalizeClass)(['day-cell',{'is-today':e.isToday,'is-other-month':!e.isCurrentMonth}]),onClick:t=>(0,l.unref)(he).setSelectedDate(e.date),onDblclick:t=>{return a=e.date,s.value=a,void(c.value=!0);var a}},[(0,l.createElementVNode)('span',vo,(0,l.toDisplayString)(e.date.getDate()),1),(0,l.createElementVNode)('div',ho,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.events,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['event-dot',`event-type-${e.type}`]),title:e.name},null,10,go))),128))])],42,po))),128))]),h.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',fo,[(0,l.createElementVNode)('h4',null,(0,l.toDisplayString)(v.value),1),(0,l.createElementVNode)('ul',null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(h.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:e.id,class:(0,l.normalizeClass)(`event-type-${e.type}`)},[a[1]||(a[1]=(0,l.createElementVNode)('span',{class:'list-dot'},null,-1)),(0,l.createTextVNode)((0,l.toDisplayString)(e.name),1)],2))),128))])])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createVNode)(so,{show:c.value,date:s.value,onClose:a[0]||(a[0]=e=>c.value=!1)},null,8,['show','date'])],64))}}),ko=(0,Ve.A)(yo,[['__scopeId','data-v-74f1f188']]),Eo={class:'modal-content'},wo={class:'character-list'},No=['onClick'],Vo={class:'name'},bo=(0,l.defineComponent)({__name:'LocationCharacterList',props:{show:{type:Boolean,required:!0},characters:{type:Array,required:!0},locationName:{type:String,required:!0}},emits:['close'],setup(e,{emit:t}){const a=t,n=()=>{a('close')},o=e=>{if(e===i.userId)return'我';const t=m(i.worldState,e);return t?`${u(t,'姓','?',!0)}`:'?'},r=e=>{const t=m(i.worldState,e);return t?`${u(t,'姓','',!0)}${u(t,'名',e,!0)}`:e};return(t,a)=>e.show?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-backdrop',onClick:(0,l.withModifiers)(n,['self'])},[(0,l.createElementVNode)('div',Eo,[(0,l.createElementVNode)('h4',null,(0,l.toDisplayString)(e.locationName)+' 内的角色',1),(0,l.createElementVNode)('ul',wo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.characters,e=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:e.id,onClick:t=>(e=>{if(e===i.userId)return;const t=T.value.find(t=>t.characterId===e);t?ht.openApp('tianhuachat',{chatId:t.id}):alert('还不是好友，无法聊天。'),n()})(e.id)},[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['avatar',{'is-user':e.id===(0,l.unref)(i).userId}])},(0,l.toDisplayString)(o(e.id)),3),(0,l.createElementVNode)('span',Vo,(0,l.toDisplayString)(r(e.id)),1)],8,No))),128))]),(0,l.createElementVNode)('button',{onClick:n,class:'close-btn'},'关闭')])])):(0,l.createCommentVNode)('v-if',!0)}}),So=(0,Ve.A)(bo,[['__scopeId','data-v-55bd1704']]);function Bo(e,t){const a=new Set([e]),n=t.filter(t=>t.parentId===e);for(const e of n){Bo(e.id,t).forEach(e=>a.add(e))}return a}function Co(e,t,a){const n=Bo(e,t),o=[];for(const e in a)n.has(a[e])&&o.push(e);return o}const $o={class:'breadcrumbs'},Do=['onClick'],Io={class:'map-sidebar'},_o={class:'sidebar-tabs'},Ao={class:'sidebar-content'},xo={class:'location-list'},Mo=['onClick'],To={class:'sidebar-content'},Lo={class:'location-list search-results'},Fo=['onClick'],Oo={class:'search-result-name'},jo={class:'search-result-path'},qo={class:'sidebar-content'},Uo={class:'filter-group'},Ho=['onUpdate:modelValue'],zo=['onClick','onDblclick'],Po={class:'location-text'},Go=['onClick'],Ro={class:'cluster-count'},Wo={key:1,class:'loading-pane'},Xo={key:0},Yo=(0,l.defineComponent)({__name:'MapApp',setup(t){const a=(0,l.ref)(null),n=(0,l.computed)(()=>U.value),o=(0,l.computed)(()=>H.value),r=(0,l.ref)(new Map),c=(0,l.ref)(null),s=(0,l.ref)(null);let d=null;const p=(0,l.ref)(!1),v=(0,l.ref)(null),h=(0,l.ref)(null),g=(0,l.ref)(null),f=(0,l.ref)([]),y=(0,l.reactive)({店铺:!0,娱乐场所:!0,社团活动室:!0,运动设施:!0,公共设施:!0,名胜古迹:!0,特殊地点:!0}),k=(0,l.ref)(!1),E=(0,l.ref)(!1),w=(0,l.ref)(null),N=(0,l.ref)(null),V=(0,l.ref)('collection'),b=(0,l.ref)(''),S={店铺:'#f59e0b',娱乐场所:'#d946ef',社团活动室:'#db2777',运动设施:'#0ea5e9',公共设施:'#7c3aed',名胜古迹:'#c026d3',特殊地点:'#475569'},B=(0,l.reactive)({x:0,y:0,scale:1}),C=(0,l.computed)(()=>Array.from(r.value.values())),D=(0,l.computed)(()=>{if(!b.value)return[];const e=b.value.toLowerCase();return C.value.filter(t=>t.name.toLowerCase().includes(e))}),I=(0,l.computed)(()=>N.value&&C.value.find(e=>e.id===N.value)||null),A=(0,l.computed)(()=>w.value&&x.value[w.value.id]||[]),x=(0,l.computed)(()=>{const e={};if(!a.value)return e;for(const t of a.value){const a=Co(t.id,C.value,o.value);e[t.id]=a.map(e=>{const t=m(i.worldState,e);return{id:e,name:t?`${u(t,'姓','',!0)}`:'?'}})}return e}),M=(0,l.computed)(()=>{if(!a.value)return{};return{'grid-template-columns':`repeat(${Math.max(...C.value.map(e=>(e.gridX||0)+(e.gridWidth||1)))}, 50px)`,'grid-template-rows':`repeat(${Math.max(...C.value.map(e=>(e.gridY||0)+(e.gridHeight||1)))}, 50px)`}}),T=(0,l.computed)(()=>N.value&&n.value[N.value]||[]),L=e=>!(e.type in y)||y[e.type],F=(0,l.computed)(()=>a.value||[]);async function O(){if(p.value=!0,a.value=await async function(e){const t=await eo();if(!e)return Array.from(t.values()).filter(e=>!e.parentId);const a=t.get(e);return a?a.children:[]}(g.value),async function(){const e=[{name:'世界',contextId:null}];if(g.value){let t=g.value;const a=[];for(;t;){const e=r.value.get(t);if(!e)break;a.unshift(e),t=e.parentId}a.forEach(t=>{e.push({name:t.name,contextId:t.id})})}f.value=e}(),d&&d.dispose(),s.value){d=e(s.value,{maxZoom:5,minZoom:.1});const t=()=>{if(!d)return;const e=d.getTransform();B.x=e.x,B.y=e.y,B.scale=e.scale};d.on('pan',t),d.on('zoom',t),d.on('transform',t)}(0,l.nextTick)(()=>{if(d&&s.value){const e=F.value;if(0===e.length)return void(p.value=!1);let t=1/0,a=1/0,n=-1/0,o=-1/0;e.forEach(e=>{t=Math.min(t,e.gridX||0),a=Math.min(a,e.gridY||0),n=Math.max(n,(e.gridX||0)+(e.gridWidth||1)),o=Math.max(o,(e.gridY||0)+(e.gridHeight||1))});const l=50,r=20,s={left:t*l-r,top:a*l-r,right:n*l+r,bottom:o*l+r};if(!c.value)return;const i=c.value.getBoundingClientRect(),u=k.value?220:0,m={left:u,top:0,width:i.width-u,height:i.height};d.showRectangle(s,{viewbox:m});const{x:v,y:h,scale:g}=d.getTransform();B.x=v,B.y=h,B.scale=g,setTimeout(()=>{p.value=!1},50)}else p.value=!1})}(0,l.onMounted)(()=>{eo().then(e=>{r.value=e,O()})}),(0,l.watch)(g,O,{immediate:!0});const j=()=>{k.value=!k.value},q=e=>{if(!d||!c.value)return;N.value=e.id;const t={left:50*(e.gridX||0)-50,top:50*(e.gridY||0)-50,right:50*((e.gridX||0)+(e.gridWidth||1))+50,bottom:50*((e.gridY||0)+(e.gridHeight||1))+50},a=c.value.getBoundingClientRect(),n=k.value?220:0,o={left:n,top:0,width:a.width-n,height:a.height};d.showRectangle(t,{viewbox:o})},P=e=>{const t=[];let a=e;for(;a;){const e=r.value.get(a);if(!e)break;t.unshift(e.name),a=e.parentId}return t.slice(0,-1).join(' / ')};const G=e=>{if(void 0===e.gridX||void 0===e.gridY)return{};const t=e.gridWidth||1,a=e.gridHeight||1,n=t*a;let o=8*Math.sqrt(n);return o=Math.max(8,o),{'grid-column-start':e.gridX+1,'grid-column-end':`span ${t}`,'grid-row-start':e.gridY+1,'grid-row-end':`span ${a}`,opacity:L(e)?1:.3,'font-size':`${o.toFixed(2)}px`}},R=()=>{d?.zoomIn()},W=()=>{d?.zoomOut()};return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['map-app',{'filter-sidebar-open':k.value}])},[(0,l.createElementVNode)('div',{class:'filter-sidebar-handle',onClick:j},'功能'),(0,l.createElementVNode)('div',{class:'app-header',ref_key:'breadcrumbsContainer',ref:v},[(0,l.createElementVNode)('div',$o,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(f.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:t,onClick:e=>function(e){const t=f.value[e];g.value=t.contextId,b.value=''}(t),class:'crumb'},(0,l.toDisplayString)(e.name),9,Do))),128))])],512),(0,l.createElementVNode)('div',Io,[(0,l.createElementVNode)('div',_o,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)({active:'collection'===V.value}),onClick:t[0]||(t[0]=e=>V.value='collection')},'集合',2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)({active:'search'===V.value}),onClick:t[1]||(t[1]=e=>V.value='search')},'搜索',2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)({active:'filter'===V.value}),onClick:t[2]||(t[2]=e=>V.value='filter')},'筛选',2)]),(0,l.withDirectives)((0,l.createElementVNode)('div',Ao,[t[5]||(t[5]=(0,l.createElementVNode)('h4',null,'当前层级地点',-1)),(0,l.createElementVNode)('ul',xo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(F.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:e.id,onClick:t=>q(e)},(0,l.toDisplayString)(e.name),9,Mo))),128))])],512),[[l.vShow,'collection'===V.value]]),(0,l.withDirectives)((0,l.createElementVNode)('div',To,[t[6]||(t[6]=(0,l.createElementVNode)('h4',null,'搜索地点',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'text','onUpdate:modelValue':t[3]||(t[3]=e=>b.value=e),placeholder:'输入地点名称...',class:'search-input'},null,512),[[l.vModelText,b.value]]),(0,l.createElementVNode)('ul',Lo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(D.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:e.id,onClick:t=>(async e=>{g.value=e.parentId,await(0,l.nextTick)(),q(e)})(e)},[(0,l.createElementVNode)('span',Oo,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('span',jo,(0,l.toDisplayString)(P(e.id)),1)],8,Fo))),128))])],512),[[l.vShow,'search'===V.value]]),(0,l.withDirectives)((0,l.createElementVNode)('div',qo,[t[7]||(t[7]=(0,l.createElementVNode)('h4',null,'地点类型筛选',-1)),(0,l.createElementVNode)('div',Uo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(y,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('label',{key:t},[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox','onUpdate:modelValue':e=>y[t]=e},null,8,Ho),[[l.vModelCheckbox,y[t]]]),(0,l.createElementVNode)('span',{class:'color-indicator',style:(0,l.normalizeStyle)({backgroundColor:S[t]})},null,4),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(t),1)]))),128))])],512),[[l.vShow,'filter'===V.value]])]),(0,l.createElementVNode)('div',{class:'map-container',ref_key:'mapContainer',ref:c},[(0,l.createElementVNode)('div',{class:'map-controls'},[(0,l.createElementVNode)('button',{onClick:R},'+'),(0,l.createElementVNode)('button',{onClick:W},'-')]),a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,ref_key:'panzoomContainer',ref:s,class:'map-pan-container'},[(0,l.createElementVNode)('div',{class:'map-grid',style:(0,l.normalizeStyle)(M.value)},[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(F.value,e=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['location-node',[{'has-event':(a=e.id,n.value[a]?.length>0)},`type-${e.type}`]]),style:(0,l.normalizeStyle)(G(e)),onClick:t=>N.value=e.id,onDblclick:t=>(e=>{C.value.some(t=>t.parentId===e.id)&&(g.value=e.id,b.value='')})(e)},[(0,l.createElementVNode)('span',Po,(0,l.toDisplayString)(e.name),1),x.value[e.id]&&x.value[e.id].length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'character-cluster-icon',onClick:(0,l.withModifiers)(t=>(e=>{w.value=e,E.value=!0})(e),['stop'])},[t[8]||(t[8]=(0,l.createStaticVNode)('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-2ce9d506><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" data-v-2ce9d506></path><circle cx="9" cy="7" r="4" data-v-2ce9d506></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87" data-v-2ce9d506></path><path d="M16 3.13a4 4 0 0 1 0 7.75" data-v-2ce9d506></path></svg>',1)),(0,l.createElementVNode)('span',Ro,(0,l.toDisplayString)(x.value[e.id].length),1)],8,Go)):(0,l.createCommentVNode)('v-if',!0)],46,zo);var a}),128))],4)],512)):((0,l.openBlock)(),(0,l.createElementBlock)('div',Wo,'加载地图中...'))],512),I.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'info-panel',ref_key:'infoPanelContainer',ref:h},[(0,l.createElementVNode)('h3',null,(0,l.toDisplayString)(I.value.name),1),(0,l.createElementVNode)('p',null,(0,l.toDisplayString)(I.value.description),1),T.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Xo,[t[9]||(t[9]=(0,l.createElementVNode)('h4',null,'今日日程:',-1)),(0,l.createElementVNode)('ul',null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(T.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:e.ID},(0,l.toDisplayString)(e.标题),1))),128))])])):(0,l.createCommentVNode)('v-if',!0)],512)):(0,l.createCommentVNode)('v-if',!0),(0,l.createVNode)(So,{show:E.value,characters:A.value,'location-name':w.value?.name||'',onClose:t[4]||(t[4]=e=>E.value=!1)},null,8,['show','characters','location-name'])],2))}}),Jo=(0,Ve.A)(Yo,[['__scopeId','data-v-2ce9d506']]),Ko={class:'tab-bar'},Zo=(0,l.defineComponent)({__name:'TabBar',emits:['navigate'],setup:e=>(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ko,[(0,l.createElementVNode)('div',{class:'tab-item',onClick:t[0]||(t[0]=t=>e.$emit('navigate','MallHomeView'))},'主页'),(0,l.createElementVNode)('div',{class:'tab-item',onClick:t[1]||(t[1]=t=>e.$emit('navigate','CartView'))},'购物车'),(0,l.createElementVNode)('div',{class:'tab-item',onClick:t[2]||(t[2]=t=>e.$emit('navigate','MyMallView'))},'我的')]))}),Qo=(0,Ve.A)(Zo,[['__scopeId','data-v-74ae756e']]),el={class:'category-nav-container'},tl={class:'category-nav'},al=['onClick'],nl=(0,l.defineComponent)({__name:'NewCategoryNav',props:{categories:{type:Array,required:!0},selectedCategory:{type:String,required:!0}},emits:['selectCategory'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',el,[(0,l.createElementVNode)('div',tl,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.categories,a=>((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:a,onClick:e=>t.$emit('selectCategory',a),class:(0,l.normalizeClass)({active:e.selectedCategory===a})},(0,l.toDisplayString)(a),11,al))),128))])]))}),ol=(0,Ve.A)(nl,[['__scopeId','data-v-f0389972']]),ll={class:'product-card'},rl={class:'product-details'},cl={class:'product-name'},sl={class:'product-description'},il={class:'product-footer'},dl={class:'product-price'},ul={class:'product-stock'},ml=['disabled'],pl=(0,l.defineComponent)({__name:'ProductCard',props:{product:{type:Object,required:!0}},emits:['addToCart'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',ll,[a[1]||(a[1]=(0,l.createElementVNode)('div',{class:'product-image-container'},[(0,l.createElementVNode)('div',{class:'product-image'},[(0,l.createCommentVNode)(' Placeholder ')])],-1)),(0,l.createElementVNode)('div',rl,[(0,l.createElementVNode)('h3',cl,(0,l.toDisplayString)(e.product.名称),1),(0,l.createElementVNode)('p',sl,(0,l.toDisplayString)(e.product.描述),1),(0,l.createElementVNode)('div',il,[(0,l.createElementVNode)('p',dl,'¥ '+(0,l.toDisplayString)(e.product.价格),1),(0,l.createElementVNode)('p',ul,'库存: '+(0,l.toDisplayString)(e.product.库存),1),(0,l.createElementVNode)('button',{onClick:a[0]||(a[0]=a=>t.$emit('addToCart',e.product)),disabled:0===e.product.库存},' + ',8,ml)])])]))}),vl=(0,Ve.A)(pl,[['__scopeId','data-v-ab9c1578']]),hl={class:'promotion-banner'},gl={key:0,class:'promo-container'},fl={class:'promo-details'},yl={class:'promo-name'},kl={class:'promo-price'},El={class:'original-price'},wl={class:'discounted-price'},Nl={key:1,class:'no-promo'},Vl=(0,l.defineComponent)({__name:'PromotionBanner',setup(e){const t=(0,l.computed)(()=>i.promotions);return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',hl,[a[1]||(a[1]=(0,l.createElementVNode)('h2',null,'本周特惠',-1)),t.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',gl,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.ID,class:'promo-card'},[a[0]||(a[0]=(0,l.createElementVNode)('div',{class:'promo-image-placeholder'},null,-1)),(0,l.createElementVNode)('div',fl,[(0,l.createElementVNode)('div',yl,(0,l.toDisplayString)(e.名称),1),(0,l.createElementVNode)('div',kl,[(0,l.createElementVNode)('span',El,'¥'+(0,l.toDisplayString)(e.价格),1),(0,l.createElementVNode)('span',wl,'¥'+(0,l.toDisplayString)(Math.round(e.价格*e.discount)),1)])])]))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Nl,' 本周暂无特惠活动，敬请期待！ '))]))}}),bl=(0,Ve.A)(Vl,[['__scopeId','data-v-435ddfc7']]);let Sl=null;async function Bl(){if(Sl)return Promise.resolve(Sl);try{const e=(await TavernHelper.getWorldbook('天华校园')).find(e=>'[世界观]商品列表'===e.name);if(!e||!e.content)return console.error('Could not fetch or parse the product list from the world book.'),[];const t=e.content.split(/\n(?=ID\|)/).map(e=>e.trim()).map(e=>function(e){const t=e.split('\n').map(e=>e.trim()),a={};return t.forEach(e=>{const[t,...n]=e.split('|'),o=n.join('|').trim();if(t&&o)switch(t){case'ID':a.ID=o;break;case'名称':a.名称=o;break;case'价格':a.价格=parseInt(o,10);break;case'分类':a.分类=o;break;case'上架时间':a.上架时间=o.split(',').map(Number);break;case'生效时间':a.生效时间=parseInt(o,10);break;case'耐久度':a.耐久度=parseInt(o,10);break;case'库存':a.库存=parseInt(o,10);break;case'最大库存':a.最大库存=parseInt(o,10);break;case'补货周期':a.补货周期=parseInt(o,10);break;case'送货时间':a.送货时间=o;break;case'描述':a.描述=o;break;case'效果':a.效果=o}}),a.ID?a:null}(e)).filter(e=>null!==e);return Sl=t,t}catch(e){return console.error('Error fetching products:',e),[]}}const Cl={class:'mall-home-view'},$l={class:'top-section'},Dl={key:0,class:'product-grid'},Il={key:1,class:'no-results'},_l=(0,l.defineComponent)({__name:'MallHomeView',setup(e){const t=(0,l.ref)([]),a=(0,l.ref)(''),n=(0,l.ref)(['全部']),o=(0,l.ref)('全部'),r=(0,l.computed)(()=>{let e=t.value;return'全部'!==o.value&&(e=e.filter(e=>e.分类&&e.分类.includes(o.value))),a.value&&(e=e.filter(e=>e.名称.toLowerCase().includes(a.value.toLowerCase()))),e});function c(e){o.value=e}function s(e){he.addToCart(e)}return(0,l.onMounted)(async()=>{const e=await Bl();if(t.value=e,e.length>0){const t=e.flatMap(e=>e.分类?e.分类.split('-'):[]),a=['全部',...new Set(t)];n.value=a}}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Cl,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'text','onUpdate:modelValue':t[0]||(t[0]=e=>a.value=e),placeholder:'搜索商品...',class:'search-bar'},null,512),[[l.vModelText,a.value]]),(0,l.createElementVNode)('div',$l,[(0,l.createVNode)(ol,{categories:n.value,'selected-category':o.value,onSelectCategory:c},null,8,['categories','selected-category']),(0,l.createVNode)(bl)]),r.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Dl,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(r.value,e=>((0,l.openBlock)(),(0,l.createBlock)(vl,{key:e.ID,product:e,onAddToCart:s},null,8,['product']))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Il,'没有找到相关商品。'))]))}}),Al=(0,Ve.A)(_l,[['__scopeId','data-v-e056aa4c']]),xl={class:'cart-view mall-page-container'},Ml={key:0,class:'empty-state'},Tl={key:1},Ll={class:'cart-items'},Fl={class:'item-name'},Ol={class:'item-quantity'},jl={class:'item-price'},ql={class:'cart-summary'},Ul={class:'summary-row'},Hl={class:'summary-row total'},zl=['disabled'],Pl=(0,l.defineComponent)({__name:'CartView',setup(e){const t=(0,l.computed)(()=>i.cartItems),a=(0,l.computed)(()=>N.value),n=(0,l.computed)(()=>i.cartItems.reduce((e,t)=>e+t.价格*t.quantity,0));function o(){he.checkout()}return(e,r)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',xl,[r[3]||(r[3]=(0,l.createElementVNode)('h1',{class:'page-title'},'购物车',-1)),0===t.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ml,[...r[0]||(r[0]=[(0,l.createElementVNode)('p',null,'🛒',-1),(0,l.createElementVNode)('p',null,'购物车是空的',-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Tl,[(0,l.createElementVNode)('div',Ll,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.ID,class:'cart-item'},[(0,l.createElementVNode)('span',Fl,(0,l.toDisplayString)(e.名称),1),(0,l.createElementVNode)('span',Ol,'x '+(0,l.toDisplayString)(e.quantity),1),(0,l.createElementVNode)('span',jl,'¥ '+(0,l.toDisplayString)(e.价格*e.quantity),1)]))),128))]),(0,l.createElementVNode)('div',ql,[(0,l.createElementVNode)('div',Ul,[r[1]||(r[1]=(0,l.createElementVNode)('span',null,'商品小计',-1)),(0,l.createElementVNode)('span',null,'¥ '+(0,l.toDisplayString)(n.value),1)]),(0,l.createElementVNode)('div',Hl,[r[2]||(r[2]=(0,l.createElementVNode)('span',null,'总计',-1)),(0,l.createElementVNode)('span',null,'¥ '+(0,l.toDisplayString)(n.value),1)])]),(0,l.createElementVNode)('button',{onClick:o,class:'checkout-btn',disabled:n.value<=0||a.value<n.value},(0,l.toDisplayString)(a.value<n.value?'余额不足':'结算'),9,zl)]))]))}}),Gl=(0,Ve.A)(Pl,[['__scopeId','data-v-5bb81000']]),Rl={class:'my-mall-view mall-page-container'},Wl={class:'user-info-card'},Xl={class:'pending-orders'},Yl={key:0,class:'empty-state'},Jl={key:1},Kl={class:'order-details'},Zl={class:'order-delivery-time'},Ql=(0,l.defineComponent)({__name:'MyMallView',setup(e){(0,l.computed)(()=>i.character);const t=(0,l.computed)(()=>N.value),a=(0,l.computed)(()=>i.pendingOrders),n=(0,l.computed)(()=>g.value);return(e,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Rl,[(0,l.createElementVNode)('div',Wl,[(0,l.createElementVNode)('h2',null,(0,l.toDisplayString)(n.value),1),(0,l.createElementVNode)('p',null,'余额: ¥ '+(0,l.toDisplayString)(t.value),1)]),(0,l.createElementVNode)('div',Xl,[o[1]||(o[1]=(0,l.createElementVNode)('h3',{class:'section-title'},'待收货的订单',-1)),0===a.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Yl,[...o[0]||(o[0]=[(0,l.createElementVNode)('p',null,'📦',-1),(0,l.createElementVNode)('p',null,'没有待收货的订单',-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Jl,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.orderId,class:'order-item'},[(0,l.createElementVNode)('span',Kl,(0,l.toDisplayString)(e.名称)+' x'+(0,l.toDisplayString)(e.quantity),1),(0,l.createElementVNode)('span',Zl,'预计送达: '+(0,l.toDisplayString)(new Date(e.deliveryTime).toLocaleString()),1)]))),128))]))])]))}}),er=(0,Ve.A)(Ql,[['__scopeId','data-v-0f99efb0']]),tr={class:'mall-app'},ar=(0,l.defineComponent)({__name:'MallApp',setup(e){const t=(0,l.ref)('MallHomeView'),a=(0,l.shallowRef)(Al),n={MallHomeView:Al,CartView:Gl,MyMallView:er};function o(e){t.value=e,a.value=n[e]}return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',tr,[((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(a.value))),(0,l.createVNode)(Qo,{onNavigate:o})]))}}),nr={class:'diary-timeline'},or={class:'timeline-date'},lr={class:'timeline-content'},rr={key:0,class:'timeline-empty'},cr=(0,l.defineComponent)({__name:'DiaryTimeline',props:{entries:{type:Array,default:()=>[]}},setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',nr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.entries,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:'timeline-entry',key:e.id},[(0,l.createElementVNode)('div',or,(0,l.toDisplayString)(e.date),1),(0,l.createElementVNode)('div',lr,(0,l.toDisplayString)(e.content),1)]))),128)),e.entries.length?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',rr,[...a[0]||(a[0]=[(0,l.createElementVNode)('p',null,'日记还是空的，快去创造一些回忆吧。',-1)])]))]))}),sr=(0,Ve.A)(cr,[['__scopeId','data-v-19ce03a0']]),ir={key:0,class:'modal-overlay'},dr={class:'modal-content'},ur={class:'modal-header'},mr={class:'modal-body'},pr={class:'modal-footer'},vr=(0,l.defineComponent)({__name:'SummaryEditorModal',props:{show:Boolean,summary:String},emits:['close','save'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)('');(0,l.watch)(()=>a.summary,e=>{o.value=e||''});const r=()=>{n('save',o.value),n('close')};return(t,a)=>e.show?((0,l.openBlock)(),(0,l.createElementBlock)('div',ir,[(0,l.createElementVNode)('div',dr,[(0,l.createElementVNode)('div',ur,[a[3]||(a[3]=(0,l.createElementVNode)('h3',{class:'modal-title'},'编辑总结',-1)),(0,l.createElementVNode)('button',{class:'modal-close',onClick:a[0]||(a[0]=e=>t.$emit('close'))},'×')]),(0,l.createElementVNode)('div',mr,[(0,l.withDirectives)((0,l.createElementVNode)('textarea',{class:'summary-editor','onUpdate:modelValue':a[1]||(a[1]=e=>o.value=e)},null,512),[[l.vModelText,o.value]])]),(0,l.createElementVNode)('div',pr,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:a[2]||(a[2]=e=>t.$emit('close'))},'取消'),(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:r},'保存并更新日志')])])])):(0,l.createCommentVNode)('v-if',!0)}}),hr=(0,Ve.A)(vr,[['__scopeId','data-v-49c98eea']]),gr={class:'summary-panel'},fr={class:'summary-section'},yr={class:'summary-content small-summary'},kr={class:'summary-section'},Er={class:'summary-content large-summary'},wr=(0,l.defineComponent)({__name:'SummaryPanel',setup(e){const t=(0,l.computed)(()=>G.value),a=(0,l.computed)(()=>R.value),n=(0,l.ref)(!1),o=(0,l.ref)(null),r=(0,l.ref)(''),c=e=>{he.generateDiarySummary(e)},s=()=>{he.saveDiarySummaries()},d=e=>{o.value=e,r.value='small'===e?t.value:a.value,n.value=!0},u=e=>{if(o.value){console.log(`Updating log from ${o.value} summary:`,e);const t='small'===o.value?i.diary.smallSummaryEntries:i.diary.largeSummaryEntries;he.updateLogFromSummary(t,e,o.value)}};return(e,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',gr,[(0,l.createElementVNode)('div',fr,[o[5]||(o[5]=(0,l.createElementVNode)('h3',{class:'summary-title'},'小总结 (近期提要)',-1)),(0,l.createElementVNode)('div',yr,[(0,l.createElementVNode)('p',null,(0,l.toDisplayString)(t.value||'点击按钮生成近期事件总结...'),1)]),(0,l.createElementVNode)('button',{class:'btn-edit',onClick:o[0]||(o[0]=e=>c('small'))},'生成'),(0,l.createElementVNode)('button',{class:'btn-edit',onClick:o[1]||(o[1]=e=>d('small'))},'编辑'),(0,l.createElementVNode)('button',{class:'btn-edit',onClick:s},'保存')]),(0,l.createElementVNode)('div',kr,[o[6]||(o[6]=(0,l.createElementVNode)('h3',{class:'summary-title'},'大总结 (往事概览)',-1)),(0,l.createElementVNode)('div',Er,[(0,l.createElementVNode)('p',null,(0,l.toDisplayString)(a.value||'点击按钮生成往事概览...'),1)]),(0,l.createElementVNode)('button',{class:'btn-edit',onClick:o[2]||(o[2]=e=>c('large'))},'生成'),(0,l.createElementVNode)('button',{class:'btn-edit',onClick:o[3]||(o[3]=e=>d('large'))},'编辑'),(0,l.createElementVNode)('button',{class:'btn-edit',onClick:s},'保存')]),(0,l.createVNode)(hr,{show:n.value,summary:r.value,onClose:o[4]||(o[4]=e=>n.value=!1),onSave:u},null,8,['show','summary'])]))}}),Nr=(0,Ve.A)(wr,[['__scopeId','data-v-574a653d']]),Vr={class:'diary-app-container'},br={class:'diary-tabs'},Sr={class:'diary-content'},Br={key:0,class:'diary-timeline-wrapper'},Cr={key:1,class:'summary-wrapper'},$r={class:'summary-controls'},Dr={class:'setting-item'},Ir={class:'setting-item'},_r={class:'setting-item'},Ar=(0,l.defineComponent)({__name:'DiaryApp',setup(e){const t=(0,l.ref)('diary'),a=(0,l.ref)(30),n=(0,l.ref)(50),o=(0,l.computed)(()=>P.value),r=(0,l.computed)({get:()=>i.diary.isAutoUpdateEnabled,set:e=>{i.diary.isAutoUpdateEnabled=e}});return(0,l.onMounted)(()=>{he.fetchDiaryEntries()}),(e,c)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Vr,[(0,l.createElementVNode)('div',br,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)({active:'diary'===t.value}),onClick:c[0]||(c[0]=e=>t.value='diary')},'日记',2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)({active:'summary'===t.value}),onClick:c[1]||(c[1]=e=>t.value='summary')},'总结',2)]),(0,l.createElementVNode)('div',Sr,['diary'===t.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Br,[(0,l.createVNode)(sr,{entries:o.value},null,8,['entries'])])):(0,l.createCommentVNode)('v-if',!0),'summary'===t.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Cr,[(0,l.createElementVNode)('div',$r,[(0,l.createElementVNode)('div',Dr,[c[5]||(c[5]=(0,l.createElementVNode)('label',{for:'x-value'},'分段正文保留数 (X):',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{id:'x-value',type:'number','onUpdate:modelValue':c[2]||(c[2]=e=>a.value=e)},null,512),[[l.vModelText,a.value]])]),(0,l.createElementVNode)('div',Ir,[c[6]||(c[6]=(0,l.createElementVNode)('label',{for:'y-value'},'小总结条目数 (Y):',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{id:'y-value',type:'number','onUpdate:modelValue':c[3]||(c[3]=e=>n.value=e)},null,512),[[l.vModelText,n.value]])]),(0,l.createElementVNode)('div',_r,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox',id:'auto-update','onUpdate:modelValue':c[4]||(c[4]=e=>r.value=e)},null,512),[[l.vModelCheckbox,r.value]]),c[7]||(c[7]=(0,l.createElementVNode)('label',{for:'auto-update'},'自动更新总结',-1))])]),(0,l.createVNode)(Nr)])):(0,l.createCommentVNode)('v-if',!0)])]))}}),xr={class:'attribute-item'},Mr={class:'attribute-name'},Tr={class:'attribute-value'},Lr=(0,l.defineComponent)({__name:'AttributeDisplay',props:{name:{},value:{}},setup:e=>(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',xr,[(0,l.createElementVNode)('span',Mr,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('span',Tr,(0,l.toDisplayString)(e.value),1)]))}),Fr=(0,Ve.A)(Lr,[['__scopeId','data-v-29a51f0e']]),Or={class:'character-panel'},jr={class:'panel-section'},qr={id:'base-attributes-list',class:'attributes-list'},Ur={class:'panel-section'},Hr={id:'secondary-attributes-list',class:'attributes-list'},zr={class:'panel-section'},Pr={id:'grades-list',class:'attributes-list'},Gr={class:'panel-section'},Rr={id:'skills-list',class:'attributes-list'},Wr={class:'panel-section'},Xr={id:'talents-list',class:'attributes-list'},Yr={class:'panel-section'},Jr={id:'schedule-list',class:'attributes-list'},Kr={class:'panel-section'},Zr={id:'relations-list',class:'attributes-list'},Qr={class:'attribute-name'},ec={class:'attribute-value'},tc=(0,l.defineComponent)({__name:'CharacterView',setup(e){const{baseAttributes:t,secondaryAttributes:a,subjects:n,skills:r,talents:c,todayCourses:s,relationships:i}=o;return(e,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Or,[(0,l.createElementVNode)('div',jr,[o[0]||(o[0]=(0,l.createElementVNode)('div',{class:'section-title'},'基础属性',-1)),(0,l.createElementVNode)('div',qr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(t),(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(Fr,{key:t,name:String(t),value:`${e.值} / ${e.软上限}`},null,8,['name','value']))),128))])]),(0,l.createElementVNode)('div',Ur,[o[1]||(o[1]=(0,l.createElementVNode)('div',{class:'section-title'},'二级属性',-1)),(0,l.createElementVNode)('div',Hr,[(0,l.createVNode)(Fr,{name:'财力',value:`¥ ${(0,l.unref)(a).财力}`},null,8,['value']),(0,l.createVNode)(Fr,{name:'声望',value:(0,l.unref)(a).声望},null,8,['value'])])]),(0,l.createElementVNode)('div',zr,[o[2]||(o[2]=(0,l.createElementVNode)('div',{class:'section-title'},'各科成绩',-1)),(0,l.createElementVNode)('div',Pr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(n),(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(Fr,{key:t,name:String(t),value:`${e.知识水平} (${e.最近一次分数})`},null,8,['name','value']))),128))])]),(0,l.createElementVNode)('div',Gr,[o[3]||(o[3]=(0,l.createElementVNode)('div',{class:'section-title'},'技能与知识',-1)),(0,l.createElementVNode)('div',Rr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(r),(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(Fr,{key:t,name:String(t),value:`Lv.${e.等级} / ${e.软上限}`},null,8,['name','value']))),128))])]),(0,l.createElementVNode)('div',Wr,[o[4]||(o[4]=(0,l.createElementVNode)('div',{class:'section-title'},'天赋与特长',-1)),(0,l.createElementVNode)('div',Xr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(c),(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(Fr,{key:t,name:e.名称,value:e.描述},null,8,['name','value']))),128))])]),(0,l.createElementVNode)('div',Yr,[o[5]||(o[5]=(0,l.createElementVNode)('div',{class:'section-title'},'今日课程',-1)),(0,l.createElementVNode)('div',Jr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(s),(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(Fr,{key:t,name:e.标题,value:e.时间段},null,8,['name','value']))),128))])]),(0,l.createElementVNode)('div',Kr,[o[6]||(o[6]=(0,l.createElementVNode)('div',{class:'section-title'},'人际关系',-1)),(0,l.createElementVNode)('div',Zr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(i),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'attribute-item'},[(0,l.createElementVNode)('span',Qr,(0,l.toDisplayString)(t),1),(0,l.createElementVNode)('span',ec,' 亲密:'+(0,l.toDisplayString)(e.亲密)+' 信赖:'+(0,l.toDisplayString)(e.信赖),1)]))),128))])])]))}}),ac=(0,Ve.A)(tc,[['__scopeId','data-v-248ead5c']]),nc={class:'main-content-wrapper'},oc=['innerHTML'],lc=(0,l.defineComponent)({__name:'MainContentView',setup(e){const t=(0,l.computed)(()=>O.value);return(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',nc,[(0,l.createElementVNode)('div',{id:'game-text-display',class:'game-text-container',innerHTML:t.value},null,8,oc),a[0]||(a[0]=(0,l.createElementVNode)('button',{id:'tablet-trigger',class:'tablet-trigger-btn'},'📱',-1))]))}}),rc=(0,Ve.A)(lc,[['__scopeId','data-v-76de7015']]),cc={class:'sidebar-handles'},sc={class:'game-container'},ic={id:'tablet-container',class:'font-sans'},dc={class:'tablet-case'},uc={class:'phone-screen'},mc={class:'phone-status-bar'},pc={class:'status-center'},vc={class:'status-right'},hc={class:'battery-level'},gc={class:'battery-icon'},fc={class:'phone-content-area'},yc={key:0,class:'phone-desktop'},kc={class:'desktop-header'},Ec={class:'time-display'},wc={id:'desktop-time'},Nc={id:'desktop-date'},Vc=['data-app-id'],bc=['innerHTML'],Sc={class:'app-icon-name'},Bc=(0,l.defineComponent)({__name:'app',setup(e){const t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(!1),r=(0,l.ref)(!1),c=(0,l.ref)(!1),s=(0,l.ref)(!1),d=(0,l.ref)(!1),u=(0,l.computed)(()=>S.value),m=(0,l.computed)(()=>{if(!ht.activeApp)return null;return{tianhuachat:sn,'campus-pass':Jn,calendar:ko,map:Jo,mall:ar,diary:Ar}[ht.activeApp]||null}),p=(0,l.ref)([{id:'tianhuachat',name:'天华信',icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>'},{id:'campus-pass',name:'校园通',icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>'},{id:'calendar',name:'日历',icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>'},{id:'map',name:'地图',icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon><line x1="8" y1="2" x2="8" y2="18"></line><line x1="16" y1="6" x2="16" y2="22"></line></svg>'},{id:'mall',name:'天华百货',icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" x2="21" y1="6" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>'},{id:'diary',name:'日记',icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>'}]);function v(){ht.closeApp()}function h(e){const t=e.target.closest('.app-icon');var a;t?.dataset.appId&&(e.preventDefault(),a=t.dataset.appId,ht.openApp(a))}function g(e){'left'===e?(s.value=!s.value,s.value&&d.value&&(d.value=!1)):(d.value=!d.value,d.value&&s.value&&(s.value=!1))}function y(e){t.value=e;const a=vt('tablet-container');a&&a.classList.toggle('is-visible',e)}return(0,l.onMounted)(()=>{he.loadAllData(),he.initializeEventListeners();const e=vt('tablet-trigger');e&&e.addEventListener('click',()=>y(!0));const t=vt('tablet-container');t&&t.addEventListener('click',e=>{'tablet-container'===e.target.id&&y(!1)})}),(0,l.watch)(()=>f.value,()=>{he.checkForScheduleUpdate()},{deep:!0}),(e,t)=>{const f=(0,l.resolveComponent)('router-view');return(0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['guixu-root-container',{'left-sidebar-open':s.value,'right-sidebar-open':d.value}])},[(0,l.createCommentVNode)(' 侧边栏控制标签 '),(0,l.createElementVNode)('div',cc,[(0,l.createElementVNode)('div',{id:'left-sidebar-handle',class:'sidebar-handle',onClick:t[0]||(t[0]=e=>g('left'))},'角色'),(0,l.createElementVNode)('div',{id:'right-sidebar-handle',class:'sidebar-handle',onClick:t[1]||(t[1]=e=>g('right'))},'交互')]),(0,l.createVNode)(pt),(0,l.createElementVNode)('div',sc,[(0,l.createVNode)(ac),(0,l.createVNode)(rc,null,{default:(0,l.withCtx)(()=>[(0,l.createVNode)(f)]),_:1}),(0,l.createVNode)(Ce,{onShowInventory:t[2]||(t[2]=e=>a.value=!0),onShowCommandCenter:t[3]||(t[3]=e=>n.value=!0),onShowExtracted:t[4]||(t[4]=e=>r.value=!0),onShowSaveLoad:t[5]||(t[5]=e=>c.value=!0)})]),(0,l.createVNode)(be),(0,l.createCommentVNode)(' Modals '),(0,l.createVNode)(We,{show:a.value,onClose:t[6]||(t[6]=e=>a.value=!1)},null,8,['show']),(0,l.createVNode)(Pe,{show:n.value,onClose:t[7]||(t[7]=e=>n.value=!1)},null,8,['show']),(0,l.createVNode)(Ge,{show:r.value,onClose:t[8]||(t[8]=e=>r.value=!1)},null,8,['show']),(0,l.createVNode)(Xe,{show:c.value,onClose:t[9]||(t[9]=e=>c.value=!1)},null,8,['show']),(0,l.createVNode)(ze,{show:(0,l.unref)(i).isAddFriendModalVisible,onClose:t[10]||(t[10]=e=>(0,l.unref)(i).isAddFriendModalVisible=!1)},null,8,['show']),(0,l.createCommentVNode)(' 滑出式智能平板 '),(0,l.createElementVNode)('div',ic,[(0,l.createElementVNode)('div',dc,[(0,l.createElementVNode)('div',uc,[(0,l.createElementVNode)('div',mc,[t[11]||(t[11]=(0,l.createStaticVNode)('<div class="status-left"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 18a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2Z"></path><path d="M10 20a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2Z"></path><path d="M4 22a2 2 0 0 1-2-2V12a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2Z"></path></svg></div>',1)),(0,l.createElementVNode)('div',pc,[(0,l.createElementVNode)('span',null,(0,l.toDisplayString)((0,l.unref)(o).timeStr.value),1)]),(0,l.createElementVNode)('div',vc,[(0,l.createElementVNode)('span',hc,(0,l.toDisplayString)(u.value)+'%',1),(0,l.createElementVNode)('div',gc,[(0,l.createElementVNode)('div',{class:'battery-fill',style:(0,l.normalizeStyle)({width:`${u.value}%`})},null,4)])])]),(0,l.createElementVNode)('div',fc,[(0,l.unref)(ht).activeApp?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',yc,[(0,l.createElementVNode)('div',kc,[(0,l.createElementVNode)('div',Ec,[(0,l.createElementVNode)('span',wc,(0,l.toDisplayString)((0,l.unref)(o).timeStr.value),1),(0,l.createElementVNode)('span',Nc,(0,l.toDisplayString)((0,l.unref)(o).dateStr.value)+' '+(0,l.toDisplayString)((0,l.unref)(o).worldTime.value?.星期),1)])]),(0,l.createElementVNode)('div',{class:'app-grid',onClick:h},[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(p.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('a',{href:'#',class:'app-icon',key:e.id,'data-app-id':e.id},[(0,l.createElementVNode)('div',{class:'app-icon-visual',innerHTML:e.icon},null,8,bc),(0,l.createElementVNode)('span',Sc,(0,l.toDisplayString)(e.name),1)],8,Vc))),128))]),t[12]||(t[12]=(0,l.createElementVNode)('div',{class:'desktop-dock-indicator'},[(0,l.createElementVNode)('span')],-1))])),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['app-view-container',{active:(0,l.unref)(ht).activeApp}])},[((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(m.value)))],2)]),(0,l.createElementVNode)('div',{class:'phone-nav-bar'},[(0,l.createElementVNode)('button',{class:'nav-btn',onClick:v},[...t[13]||(t[13]=[(0,l.createElementVNode)('svg',{xmlns:'http://www.w3.org/2000/svg',width:'24',height:'24',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2','stroke-linecap':'round','stroke-linejoin':'round'},[(0,l.createElementVNode)('line',{x1:'4',x2:'20',y1:'12',y2:'12'}),(0,l.createElementVNode)('line',{x1:'4',x2:'20',y1:'6',y2:'6'}),(0,l.createElementVNode)('line',{x1:'4',x2:'20',y1:'18',y2:'18'})],-1)])]),t[14]||(t[14]=(0,l.createStaticVNode)('<button class="nav-btn nav-btn-home"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect></svg></button><button class="nav-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 19 22 12 13 5 13 19"></polygon></svg></button>',2))])])])])],2)}}}),Cc=Bc,$c={class:'inventory-panel'},Dc={class:'panel-section'},Ic={class:'inventory-grid'},_c={class:'item-name'},Ac={class:'item-quantity'},xc=(0,l.defineComponent)({__name:'InventoryView',setup(e){const t=(0,l.ref)([]);return(0,l.onMounted)(()=>{t.value=[{id:'food001',name:'学生A套餐',quantity:1},{id:'snack002',name:'Pocky巧克力棒',quantity:3},{id:'study001',name:'《高等数学辅导》',quantity:1}]}),(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',$c,[(0,l.createElementVNode)('div',Dc,[a[0]||(a[0]=(0,l.createElementVNode)('div',{class:'section-title'},'我的背包',-1)),(0,l.createElementVNode)('div',Ic,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'inventory-item'},[(0,l.createElementVNode)('div',_c,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('div',Ac,'x'+(0,l.toDisplayString)(e.quantity),1)]))),128))])])]))}}),Mc=(0,Ve.A)(xc,[['__scopeId','data-v-74e5075d']]),Tc={class:'npc-list-panel'},Lc={class:'panel-section'},Fc={class:'npc-list'},Oc={class:'npc-name'},jc={class:'npc-relationship'},qc=(0,l.defineComponent)({__name:'NpcListView',setup(e){const t=(0,l.ref)([]);return(0,l.onMounted)(()=>{t.value=[{id:'yukinoshita_yukino',name:'雪之下雪乃',favorability:55},{id:'yuigahama_yui',name:'由比滨结衣',favorability:60}]}),(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Tc,[(0,l.createElementVNode)('div',Lc,[a[0]||(a[0]=(0,l.createElementVNode)('div',{class:'section-title'},'NPC 列表',-1)),(0,l.createElementVNode)('div',Fc,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'npc-item'},[(0,l.createElementVNode)('div',Oc,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('div',jc,'好感度: '+(0,l.toDisplayString)(e.favorability),1)]))),128))])])]))}}),Uc=(0,Ve.A)(qc,[['__scopeId','data-v-6e94cfcc']]),Hc={class:'world-state-panel'},zc={class:'panel-section'},Pc={class:'state-list'},Gc=(0,l.defineComponent)({__name:'WorldStateView',setup(e){const t=(0,l.ref)(null),a=(0,l.computed)(()=>{if(!t.value)return'';const e=t.value.当前时间;return`${e.年}-${e.月}-${e.日} ${e.时}:${e.分} (${e.星期})`});return(0,l.onMounted)(()=>{t.value={当前时间:{年:2024,月:9,日:1,时:8,分:0,星期:'周一'},季节:'秋',天气:'晴',温度:22,经济指数:100,流行趋势:'复古Y2K穿搭'}}),(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Hc,[(0,l.createElementVNode)('div',zc,[n[0]||(n[0]=(0,l.createElementVNode)('div',{class:'section-title'},'世界状态',-1)),(0,l.createElementVNode)('div',Pc,[(0,l.createVNode)(Fr,{name:'当前时间',value:a.value},null,8,['value']),(0,l.createVNode)(Fr,{name:'季节',value:t.value?.季节||'N/A'},null,8,['value']),(0,l.createVNode)(Fr,{name:'天气',value:t.value?.天气||'N/A'},null,8,['value']),(0,l.createVNode)(Fr,{name:'温度',value:`${t.value?.温度||'N/A'}°C`},null,8,['value']),(0,l.createVNode)(Fr,{name:'经济指数',value:t.value?.经济指数||0},null,8,['value']),(0,l.createVNode)(Fr,{name:'流行趋势',value:t.value?.流行趋势||'N/A'},null,8,['value'])])])]))}}),Rc=[{path:'/',component:rc},{path:'/character',component:ac},{path:'/npc-list',component:Uc},{path:'/inventory',component:Mc},{path:'/world-state',component:(0,Ve.A)(Gc,[['__scopeId','data-v-6b569493']])}],Wc=(0,r.createRouter)({history:(0,r.createMemoryHistory)(),routes:Rc});Wc.replace('/'),$(()=>{(0,l.createApp)(Cc).use(Wc).mount('#app')});const Xc=['周一','周二','周三','周四','周五'];function Yc(e){for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e}async function Jc(e){console.log(`[ScheduleService] Starting to generate schedule for ${e}...`);const t=await oe('课程池-主'),a=(n=t)?n.split('\n').filter(e=>!e.startsWith('#')&&''!==e.trim()).map(e=>{const[t,a,n,o,l]=e.split('|');return{班级ID:t,课程名称:a,教师:n,教室ID:o,课程类型:l}}):[];var n;const{general:o,nonGeneral:l}=function(e,t){const a=t.substring(0,2),n=e.filter(e=>'通用'===e.班级ID||e.班级ID===a||e.班级ID===t);return{general:n.filter(e=>'选修'===e.课程类型||'通用'===e.班级ID),nonGeneral:n.filter(e=>'必修'===e.课程类型&&'通用'!==e.班级ID)}}(a,e);if(l.length<14)return console.warn(`[ScheduleService] Not enough non-general courses for ${e}. Have ${l.length}, need 14`),!1;const r=[...Yc([...l]).slice(0,14),...Yc([...o]).slice(0,4)],c=[],s={};Xc.forEach(e=>{s[e]=Array(4).fill(!1)});Xc.length;const i=[];Xc.forEach(e=>{for(let t=0;t<4;t++)i.push({day:e,sectionIndex:t})}),Yc(i);for(const e of r){let t=!1,a=0;for(;!t&&a<i.length;){const n=Math.floor(Math.random()*i.length),{day:o,sectionIndex:l}=i[n];if(!s[o][l]){const a=2*l+1,r=[a,a+1];c.push({id:`${o}-${e.课程名称}-${a}`,课程名称:e.课程名称,教师:e.教师,教室ID:e.教室ID,上课日:o,节次:r}),s[o][l]=!0,t=!0,i.splice(n,1)}a++}t||console.warn(`[ScheduleService] Could not find a slot for course: ${e.课程名称}`)}c.length<18&&console.warn(`[ScheduleService] Could only schedule ${c.length}/18 courses.`);const d=function(e,t){return`# ${t} - 本周课程表\n# 自动生成于: ${(new Date).toISOString()}\n# 格式: 班级ID|课程名称|教师|上课日|节次(数组)|教室ID\n\n`+e.map(e=>`${t}|${e.课程名称}|${e.教师}|${e.上课日}|[${e.节次.join(',')}]|${e.教室ID}`).join('\n')}(c,e);return await le('课程表-主',d),console.log(`[ScheduleService] Successfully generated and saved new schedule for ${e}.`),eventEmit('tavern-helper:schedule-updated'),!0}function Kc(e){const t=(0,d.get)(i.worldState,'世界状态.当前时间');if(!t)return!1;const[a,n]=e.split('-').map(Number);return t.月===a&&t.日===n}function Zc(e){const t=e.match(/(.+)(>|<|=)(.+)/);if(!t)return!1;const[a,n,o,l]=t,r=(0,d.get)(i.worldState,n.trim()),c=parseFloat(l);if(void 0===r)return!1;switch(o){case'>':return r>c;case'<':return r<c;case'=':return r==c;default:return!1}}function Qc(e){const[t]=e.split(','),a=parseFloat(t);return Math.random()<a}eventOn('tavern-helper:request-schedule-update',e=>{Jc(e)}),eventOn('tavern-helper:request-schedule-load',async()=>{const e=await async function(){return{'课程表-主':await oe('课程表-主')}}();(0,d.merge)(i.worldState,e),console.log('[ScheduleService] Schedule data loaded and merged into worldState.')}),eventOn('tavern-helper:request-event-check',async()=>{await async function(){const e=(0,d.get)(i.worldState,'世界状态.当前事件[0]');if(!e||!e.ID)return;const t=e.已持续天数+1;t>e.总持续天数?async function(e,t){eventEmit('tavern-helper:deactivate-event',{initialEventState:{ID:'',名称:'',已持续天数:0,总持续天数:0,效果:[['$__META_EXTENSIBLE__$']]},eventName:t}),eventEmit('tavern-helper:event-ended',e),console.log(`[EventService] Event "${t}" has ended.`)}(e.ID,e.名称):(eventEmit('tavern-helper:progress-event',t),console.log(`[EventService] Event "${e.名称}" progressed to day ${t}.`))}(),await async function(){const e=(t=await oe('事件触发器'),t?t.split('\n').filter(e=>!e.startsWith('#')&&''!==e.trim()).map(e=>{const[t,a,n,o]=e.split('|');return{type:t,condition:a,eventId:n,priority:parseInt(o,10)||0}}):[]);var t;if(!(0,d.get)(i.worldState,'世界状态.当前时间'))return;const a=[];for(const t of e){let e=!1;switch(t.type){case'date':e=Kc(t.condition);break;case'variable':e=Zc(t.condition);break;case'random':e=Qc(t.condition)}e&&a.push(t)}if(a.length>0){a.sort((e,t)=>t.priority-e.priority);const e=a[0];!async function(e){const t=(0,d.get)(i.worldState,'世界状态.当前事件[0]');if(t&&t.ID)return void console.warn(`[EventService] An event (${t.ID}) is already active. Cannot activate ${e}.`);const a=await oe('世界事件库');if(!a)return;const n=a.split('\n').find(t=>t.startsWith(e));if(!n)return void console.error(`[EventService] Event with ID ${e} not found in the database.`);const[o,l,r,c,s]=n.split('|'),u=parseInt(c,10)||1,m={ID:o,名称:l,已持续天数:1,总持续天数:u,效果:[]};(l.includes('祭')||l.includes('假期')||l.includes('考试周'))&&m.效果.push({类型:'暂停课程',状态:'激活'});l.includes('考试周')&&m.效果.push({类型:'社团活动暂停',状态:'激活'});eventEmit('tavern-helper:activate-event',{newEvent:m,description:s}),console.log(`[EventService] Event "${l}" activated for ${u} day(s).`)}(e.eventId),console.log(`[EventService] Triggered event: ${e.eventId}`)}}()});const es=new class{intervalId=null;lastCheckedDay=-1;start(){null===this.intervalId&&(console.log('[MallService] Starting service...'),this.intervalId=window.setInterval(()=>{const e=f.value;if(!e)return;const t=e.日;t!==this.lastCheckedDay&&(this.checkPromotions(e),this.checkRestocks(e),this.lastCheckedDay=t),this.checkDeliveries(e),this.checkPendingRestocks(e)},1e4))}stop(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,console.log('[MallService] Service stopped.'))}async checkPromotions(e){if('周日'===e?.星期){console.log('[MallService] Sunday! Updating promotions.');const e=(await Bl()).filter(e=>e.库存>0),t=[];for(let a=0;a<3&&e.length>0;a++){const a=Math.floor(Math.random()*e.length),n=e.splice(a,1)[0],o=Math.floor(3*Math.random()+7)/10;t.push({...n,discount:o})}i.promotions=t}}async checkRestocks(e){console.log('[MallService] Checking for out-of-stock items...');const t=await Bl(),a=(0,d.get)(i.worldState,'世界状态.补货计划[0]',[]);t.forEach(t=>{if(0===t.库存&&!a.some(e=>e.ID===t.ID)){const a=t.补货周期||7,n=new Date(e.年,e.月-1,e.日+a,e.时,e.分).toISOString();ae(`_.assign('世界状态.补货计划[0]', ${JSON.stringify({ID:t.ID,名称:t.名称,补货时间:n,最大库存:t.最大库存})})`,i.worldState),console.log(`[MallService] ${t.名称} is out of stock. Scheduled for restock on ${n}.`)}})}async checkPendingRestocks(e){if(!e)return;const t=new Date(`${e.年}-${e.月}-${e.日}T${e.时}:${e.分}`),a=(0,d.get)(i.worldState,'世界状态.补货计划[0]',[]);for(let e=a.length-1;e>=0;e--){const n=a[e];if(t>=new Date(n.补货时间)){console.log(`[MallService] Restocking ${n.名称} now.`),await Y.updateStock(n.ID,n.最大库存);const t=`_.remove('世界状态.补货计划[0]', ${e})`;await ae(t,i.worldState)}}}checkDeliveries(e){if(!e)return;const t=new Date(`${e.年}-${e.月}-${e.日}T${e.时}:${e.分}`);for(let e=i.pendingOrders.length-1;e>=0;e--){const a=i.pendingOrders[e];if(t>=new Date(a.deliveryTime)){console.log(`[MallService] Order for ${a.名称} has arrived.`);const t=`[到货] ${a.名称}x${a.quantity} 已送达`;he.addActionToQueue({action:'custom',command:t}),i.pendingOrders.splice(e,1)}}}};class ts{static instance;intervalId=null;POLLING_INTERVAL=3e5;constructor(){this.watchAutoUpdateFlag()}static getInstance(){return ts.instance||(ts.instance=new ts),ts.instance}watchAutoUpdateFlag(){(0,l.watch)(()=>i.diary.isAutoUpdateEnabled,e=>{e?this.start():this.stop()},{immediate:!0})}start(){null===this.intervalId?(console.log('[DiaryPolling] Starting polling for diary updates...'),this.runUpdate(),this.intervalId=window.setInterval(()=>{this.runUpdate()},this.POLLING_INTERVAL)):console.log('[DiaryPolling] Polling is already active.')}stop(){null!==this.intervalId&&(console.log('[DiaryPolling] Stopping polling.'),clearInterval(this.intervalId),this.intervalId=null)}async runUpdate(){console.log('[DiaryPolling] Running scheduled diary update...');try{await he.generateDiarySummary('small'),await he.generateDiarySummary('large'),await he.saveDiarySummaries(),console.log('[DiaryPolling] Scheduled diary update completed.')}catch(e){console.error('[DiaryPolling] Error during scheduled diary update:',e)}}}ts.getInstance();es.start();</script><style>.guixu-root-container[data-v-b700c938]{display:grid;grid-template-rows:auto 1fr auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;background-color:#fdfbf6;color:#3a3f4b;border:1px solid #eae6dd;border-radius:12px;overflow:hidden;max-width:100%;margin:auto;box-shadow:0 8px 35px rgba(58,63,75,.12);position:relative;width:100%;height:720px}.guixu-root-container[data-v-b700c938] *{margin:0;padding:0;box-sizing:border-box}.game-container[data-v-b700c938]{display:grid;grid-template-columns:220px 1fr 160px;width:100%;height:100%;overflow:hidden;gap:1px}.character-panel[data-v-b700c938],.interaction-panel[data-v-b700c938]{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.character-panel[data-v-b700c938]{border-right:1px solid #eae6dd}.interaction-panel[data-v-b700c938]{border-left:1px solid #eae6dd}.main-content[data-v-b700c938]{padding:25px;overflow-y:auto;background:#fdfbf6;position:relative}#tablet-trigger[data-v-b700c938]{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-trigger[data-v-b700c938]:hover{background-color:#f5f1e9;color:#4169e1}#tablet-container[data-v-b700c938]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(58,63,75,.4);backdrop-filter:blur(5px);opacity:0;visibility:hidden;transform:scale(1.1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease;z-index:200}#tablet-container.is-visible[data-v-b700c938]{opacity:1;visibility:visible;transform:scale(1)}#tablet-container .tablet-case[data-v-b700c938]{width:90%;max-width:380px;height:90vh;max-height:800px;background-color:#1a1a1a;border-radius:40px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.3),inset 0 0 15px hsla(0,0%,100%,.1);display:flex;flex-direction:column}#tablet-container .phone-screen[data-v-b700c938]{width:100%;height:100%;background:linear-gradient(160deg,#f87171 0%,#a855f7 100%);border-radius:28px;overflow:hidden;position:relative;display:flex;flex-direction:column;color:#fff}#tablet-container .phone-content-area[data-v-b700c938]{flex-grow:1;position:relative;display:flex;flex-direction:column}#tablet-container .phone-desktop[data-v-b700c938]{display:flex;flex-direction:column;height:100%;padding:20px;box-sizing:border-box}#tablet-container .desktop-header[data-v-b700c938]{flex-shrink:0;padding:40px 0;text-align:center}#tablet-container .desktop-header .time-display #desktop-time[data-v-b700c938]{font-size:72px;font-weight:300;letter-spacing:1px;display:block;line-height:1}#tablet-container .desktop-header .time-display #desktop-date[data-v-b700c938]{font-size:16px;font-weight:400;opacity:.9}#tablet-container .app-grid[data-v-b700c938]{flex-grow:1;display:grid;grid-template-columns:repeat(4,1fr);gap:20px;align-content:flex-start}#tablet-container .desktop-dock-indicator[data-v-b700c938]{flex-shrink:0;display:flex;justify-content:center;padding:15px 0}#tablet-container .desktop-dock-indicator span[data-v-b700c938]{width:8px;height:8px;background-color:hsla(0,0%,100%,.5);border-radius:50%}#tablet-container .app-view-container[data-v-b700c938]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fdfbf6;z-index:10;flex-direction:column;color:#3a3f4b}#tablet-container .app-view-container.active[data-v-b700c938]{display:flex}#tablet-container .phone-nav-bar[data-v-b700c938]{height:50px;flex-shrink:0;display:flex;justify-content:space-around;align-items:center;padding:0 20px;background:rgba(0,0,0,.1)}#tablet-container .phone-nav-bar .nav-btn[data-v-b700c938]{background:none;border:none;color:#fff;opacity:.8;cursor:pointer;padding:5px}#tablet-container .phone-nav-bar .nav-btn svg[data-v-b700c938]{width:20px;height:20px}#tablet-container .guixu-root-container:not(.mobile-view) .main-content[data-v-b700c938]{grid-column:1/-1}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-b700c938],#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-b700c938]{position:absolute;top:0;height:100%;z-index:1000;transition:transform .35s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 25px rgba(0,0,0,.15);background:#f5f1e9;border:none}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-b700c938]{width:240px;left:0;transform:translateX(-100%);border-right:1px solid #eae6dd}#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-b700c938]{width:180px;right:0;transform:translateX(100%);border-left:1px solid #eae6dd}#tablet-container .guixu-root-container.left-sidebar-open .character-panel[data-v-b700c938]{transform:translateX(0)}#tablet-container .guixu-root-container.right-sidebar-open .interaction-panel[data-v-b700c938]{transform:translateX(0)}#tablet-container .sidebar-handle[data-v-b700c938]{position:fixed;z-index:1001;width:32px;height:80px;background:#fff;color:#6c757d;writing-mode:vertical-rl;text-orientation:mixed;display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #eae6dd;font-size:14px;font-weight:500;transition:background-color .2s;box-shadow:2px 0 8px rgba(58,63,75,.08)}#tablet-container .sidebar-handle[data-v-b700c938]:hover{background:#f5f1e9;color:#4169e1}#tablet-container #left-sidebar-handle[data-v-b700c938]{top:40%;left:0;border-left:none;border-top-right-radius:8px;border-bottom-right-radius:8px}#tablet-container #right-sidebar-handle[data-v-b700c938]{top:55%;right:0;border-right:none;border-left:1px solid #eae6dd;border-radius:8px 0 0 8px;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-container .app-icon[data-v-b700c938]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;text-decoration:none}#tablet-container .app-icon .app-icon-visual[data-v-b700c938]{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:transform .2s ease}#tablet-container .app-icon .app-icon-visual svg[data-v-b700c938]{width:28px;height:28px}#tablet-container .app-icon .app-icon-name[data-v-b700c938]{font-size:12px;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.3)}#tablet-container .app-icon:hover .app-icon-visual[data-v-b700c938]{transform:scale(1.1)}#tablet-container .app-icon[data-app-id=tianhuachat] .app-icon-visual[data-v-b700c938]{background-color:#3b82f6}#tablet-container .app-icon[data-app-id=campus-pass] .app-icon-visual[data-v-b700c938]{background-color:#14b8a6}#tablet-container .app-icon[data-app-id=schedule] .app-icon-visual[data-v-b700c938]{background-color:#8b5cf6}#tablet-container .app-icon[data-app-id=health] .app-icon-visual[data-v-b700c938]{background-color:#ef4444}#tablet-container .app-icon[data-app-id=forum] .app-icon-visual[data-v-b700c938]{background-color:#0ea5e9}#tablet-container .app-icon[data-app-id=shopping] .app-icon-visual[data-v-b700c938]{background-color:#f97316}#tablet-container .app-icon[data-app-id=inventory] .app-icon-visual[data-v-b700c938]{background-color:#ec4899}#tablet-container .app-icon[data-app-id=map] .app-icon-visual[data-v-b700c938]{background-color:#22c55e}#tablet-container .app-icon[data-app-id=settings] .app-icon-visual[data-v-b700c938]{background-color:#6b7280}.phone-status-bar[data-v-b700c938]{display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background-color:rgba(0,0,0,.1);color:#fff;font-size:12px;position:absolute;top:0;left:0;right:0;z-index:100}.phone-status-bar .status-left[data-v-b700c938],.phone-status-bar .status-right[data-v-b700c938]{display:flex;align-items:center;gap:6px}.phone-status-bar .status-center[data-v-b700c938]{font-weight:500}.phone-status-bar .battery-icon[data-v-b700c938]{width:22px;height:11px;border:1px solid #fff;border-radius:3px;position:relative;padding:1px}.phone-status-bar .battery-icon[data-v-b700c938]::after{content:"";position:absolute;right:-3px;top:2px;width:2px;height:5px;background-color:#fff;border-top-right-radius:1px;border-bottom-right-radius:1px}.phone-status-bar .battery-icon .battery-fill[data-v-b700c938]{height:100%;background-color:#fff;border-radius:1px;transition:width .3s ease}.phone-content-area[data-v-b700c938]{padding-top:24px}.mall-app[data-v-b700c938]{background-color:#f8f9fa}.mall-home-view .search-bar[data-v-b700c938]{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar[data-v-b700c938]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid[data-v-b700c938]{padding-bottom:4rem}.product-card[data-v-b700c938]{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container[data-v-b700c938]{flex-shrink:0;width:90px;height:90px}.product-card .product-image[data-v-b700c938]{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details[data-v-b700c938]{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name[data-v-b700c938]{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description[data-v-b700c938]{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer[data-v-b700c938]{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price[data-v-b700c938]{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock[data-v-b700c938]{font-size:.75rem;color:#6b7280}.product-card button[data-v-b700c938]{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button[data-v-b700c938]:hover{background-color:#4338ca}.product-card button[data-v-b700c938]:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container[data-v-b700c938]{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title[data-v-b700c938]{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state[data-v-b700c938]{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item[data-v-b700c938]{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name[data-v-b700c938]{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity[data-v-b700c938]{color:#6b7280}.cart-view .cart-item .item-price[data-v-b700c938]{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary[data-v-b700c938]{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row[data-v-b700c938]{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total[data-v-b700c938]{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn[data-v-b700c938]{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn[data-v-b700c938]:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card[data-v-b700c938]{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2[data-v-b700c938]{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p[data-v-b700c938]{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title[data-v-b700c938]{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item[data-v-b700c938]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details[data-v-b700c938]{font-weight:500}.my-mall-view .order-item .order-delivery-time[data-v-b700c938]{font-size:.8rem;color:#6b7280}.bottom-status[data-v-b700c938]{background:#fff;border-top:1px solid #eae6dd;display:flex;align-items:center;justify-content:space-between;gap:15px;padding:10px 15px;height:auto}.status-effects-wrapper[data-v-b700c938]{display:flex;gap:8px;overflow-x:auto}.status-effect[data-v-b700c938]{display:flex;align-items:center;gap:8px;padding:6px 12px;background-color:rgba(65,105,225,.1);border:1px solid rgba(65,105,225,.2);border-radius:16px;font-size:13px;cursor:help;transition:all .2s ease}.status-effect[data-v-b700c938]:hover{background-color:rgba(65,105,225,.15);transform:translateY(-1px)}.quick-send-container[data-v-b700c938]{display:flex;align-items:center;gap:8px}.quick-send-input[data-v-b700c938]{background:#fff;border:1px solid #a9a9a9;border-radius:6px;color:#3a3f4b;padding:8px 12px;font-size:14px;width:250px;height:38px;resize:none;line-height:1.5;font-family:inherit;transition:all .2s ease}.quick-send-input[data-v-b700c938]:focus{height:80px;border-color:#4169e1;box-shadow:0 0 0 3px rgba(65,105,225,.2)}.quick-send-input[data-v-b700c938]::placeholder{color:#a9a9a9}.interaction-btn[data-v-b700c938]{padding:10px 15px;background-image:linear-gradient(to bottom,#ffffff,#f7f7f7);border:1px solid #a9a9a9;border-radius:6px;color:#3a3f4b;font-size:13px;cursor:pointer;text-align:center;transition:all .2s ease;font-weight:500;box-shadow:0 1px 2px rgba(0,0,0,.05)}.interaction-btn[data-v-b700c938]:hover{border-color:#4169e1;color:#4169e1;transform:translateY(-2px);box-shadow:0 3px 8px rgba(65,105,225,.15)}
.guixu-root-container[data-v-7b143514]{display:grid;grid-template-rows:auto 1fr auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;background-color:#fdfbf6;color:#3a3f4b;border:1px solid #eae6dd;border-radius:12px;overflow:hidden;max-width:100%;margin:auto;box-shadow:0 8px 35px rgba(58,63,75,.12);position:relative;width:100%;height:720px}.guixu-root-container[data-v-7b143514] *{margin:0;padding:0;box-sizing:border-box}.game-container[data-v-7b143514]{display:grid;grid-template-columns:220px 1fr 160px;width:100%;height:100%;overflow:hidden;gap:1px}.character-panel[data-v-7b143514],.interaction-panel[data-v-7b143514]{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.character-panel[data-v-7b143514]{border-right:1px solid #eae6dd}.interaction-panel[data-v-7b143514]{border-left:1px solid #eae6dd}.main-content[data-v-7b143514]{padding:25px;overflow-y:auto;background:#fdfbf6;position:relative}#tablet-trigger[data-v-7b143514]{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-trigger[data-v-7b143514]:hover{background-color:#f5f1e9;color:#4169e1}#tablet-container[data-v-7b143514]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(58,63,75,.4);backdrop-filter:blur(5px);opacity:0;visibility:hidden;transform:scale(1.1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease;z-index:200}#tablet-container.is-visible[data-v-7b143514]{opacity:1;visibility:visible;transform:scale(1)}#tablet-container .tablet-case[data-v-7b143514]{width:90%;max-width:380px;height:90vh;max-height:800px;background-color:#1a1a1a;border-radius:40px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.3),inset 0 0 15px hsla(0,0%,100%,.1);display:flex;flex-direction:column}#tablet-container .phone-screen[data-v-7b143514]{width:100%;height:100%;background:linear-gradient(160deg,#f87171 0%,#a855f7 100%);border-radius:28px;overflow:hidden;position:relative;display:flex;flex-direction:column;color:#fff}#tablet-container .phone-content-area[data-v-7b143514]{flex-grow:1;position:relative;display:flex;flex-direction:column}#tablet-container .phone-desktop[data-v-7b143514]{display:flex;flex-direction:column;height:100%;padding:20px;box-sizing:border-box}#tablet-container .desktop-header[data-v-7b143514]{flex-shrink:0;padding:40px 0;text-align:center}#tablet-container .desktop-header .time-display #desktop-time[data-v-7b143514]{font-size:72px;font-weight:300;letter-spacing:1px;display:block;line-height:1}#tablet-container .desktop-header .time-display #desktop-date[data-v-7b143514]{font-size:16px;font-weight:400;opacity:.9}#tablet-container .app-grid[data-v-7b143514]{flex-grow:1;display:grid;grid-template-columns:repeat(4,1fr);gap:20px;align-content:flex-start}#tablet-container .desktop-dock-indicator[data-v-7b143514]{flex-shrink:0;display:flex;justify-content:center;padding:15px 0}#tablet-container .desktop-dock-indicator span[data-v-7b143514]{width:8px;height:8px;background-color:hsla(0,0%,100%,.5);border-radius:50%}#tablet-container .app-view-container[data-v-7b143514]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fdfbf6;z-index:10;flex-direction:column;color:#3a3f4b}#tablet-container .app-view-container.active[data-v-7b143514]{display:flex}#tablet-container .phone-nav-bar[data-v-7b143514]{height:50px;flex-shrink:0;display:flex;justify-content:space-around;align-items:center;padding:0 20px;background:rgba(0,0,0,.1)}#tablet-container .phone-nav-bar .nav-btn[data-v-7b143514]{background:none;border:none;color:#fff;opacity:.8;cursor:pointer;padding:5px}#tablet-container .phone-nav-bar .nav-btn svg[data-v-7b143514]{width:20px;height:20px}#tablet-container .guixu-root-container:not(.mobile-view) .main-content[data-v-7b143514]{grid-column:1/-1}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-7b143514],#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-7b143514]{position:absolute;top:0;height:100%;z-index:1000;transition:transform .35s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 25px rgba(0,0,0,.15);background:#f5f1e9;border:none}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-7b143514]{width:240px;left:0;transform:translateX(-100%);border-right:1px solid #eae6dd}#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-7b143514]{width:180px;right:0;transform:translateX(100%);border-left:1px solid #eae6dd}#tablet-container .guixu-root-container.left-sidebar-open .character-panel[data-v-7b143514]{transform:translateX(0)}#tablet-container .guixu-root-container.right-sidebar-open .interaction-panel[data-v-7b143514]{transform:translateX(0)}#tablet-container .sidebar-handle[data-v-7b143514]{position:fixed;z-index:1001;width:32px;height:80px;background:#fff;color:#6c757d;writing-mode:vertical-rl;text-orientation:mixed;display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #eae6dd;font-size:14px;font-weight:500;transition:background-color .2s;box-shadow:2px 0 8px rgba(58,63,75,.08)}#tablet-container .sidebar-handle[data-v-7b143514]:hover{background:#f5f1e9;color:#4169e1}#tablet-container #left-sidebar-handle[data-v-7b143514]{top:40%;left:0;border-left:none;border-top-right-radius:8px;border-bottom-right-radius:8px}#tablet-container #right-sidebar-handle[data-v-7b143514]{top:55%;right:0;border-right:none;border-left:1px solid #eae6dd;border-radius:8px 0 0 8px;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-container .app-icon[data-v-7b143514]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;text-decoration:none}#tablet-container .app-icon .app-icon-visual[data-v-7b143514]{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:transform .2s ease}#tablet-container .app-icon .app-icon-visual svg[data-v-7b143514]{width:28px;height:28px}#tablet-container .app-icon .app-icon-name[data-v-7b143514]{font-size:12px;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.3)}#tablet-container .app-icon:hover .app-icon-visual[data-v-7b143514]{transform:scale(1.1)}#tablet-container .app-icon[data-app-id=tianhuachat] .app-icon-visual[data-v-7b143514]{background-color:#3b82f6}#tablet-container .app-icon[data-app-id=campus-pass] .app-icon-visual[data-v-7b143514]{background-color:#14b8a6}#tablet-container .app-icon[data-app-id=schedule] .app-icon-visual[data-v-7b143514]{background-color:#8b5cf6}#tablet-container .app-icon[data-app-id=health] .app-icon-visual[data-v-7b143514]{background-color:#ef4444}#tablet-container .app-icon[data-app-id=forum] .app-icon-visual[data-v-7b143514]{background-color:#0ea5e9}#tablet-container .app-icon[data-app-id=shopping] .app-icon-visual[data-v-7b143514]{background-color:#f97316}#tablet-container .app-icon[data-app-id=inventory] .app-icon-visual[data-v-7b143514]{background-color:#ec4899}#tablet-container .app-icon[data-app-id=map] .app-icon-visual[data-v-7b143514]{background-color:#22c55e}#tablet-container .app-icon[data-app-id=settings] .app-icon-visual[data-v-7b143514]{background-color:#6b7280}.phone-status-bar[data-v-7b143514]{display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background-color:rgba(0,0,0,.1);color:#fff;font-size:12px;position:absolute;top:0;left:0;right:0;z-index:100}.phone-status-bar .status-left[data-v-7b143514],.phone-status-bar .status-right[data-v-7b143514]{display:flex;align-items:center;gap:6px}.phone-status-bar .status-center[data-v-7b143514]{font-weight:500}.phone-status-bar .battery-icon[data-v-7b143514]{width:22px;height:11px;border:1px solid #fff;border-radius:3px;position:relative;padding:1px}.phone-status-bar .battery-icon[data-v-7b143514]::after{content:"";position:absolute;right:-3px;top:2px;width:2px;height:5px;background-color:#fff;border-top-right-radius:1px;border-bottom-right-radius:1px}.phone-status-bar .battery-icon .battery-fill[data-v-7b143514]{height:100%;background-color:#fff;border-radius:1px;transition:width .3s ease}.phone-content-area[data-v-7b143514]{padding-top:24px}.mall-app[data-v-7b143514]{background-color:#f8f9fa}.mall-home-view .search-bar[data-v-7b143514]{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar[data-v-7b143514]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid[data-v-7b143514]{padding-bottom:4rem}.product-card[data-v-7b143514]{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container[data-v-7b143514]{flex-shrink:0;width:90px;height:90px}.product-card .product-image[data-v-7b143514]{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details[data-v-7b143514]{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name[data-v-7b143514]{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description[data-v-7b143514]{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer[data-v-7b143514]{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price[data-v-7b143514]{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock[data-v-7b143514]{font-size:.75rem;color:#6b7280}.product-card button[data-v-7b143514]{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button[data-v-7b143514]:hover{background-color:#4338ca}.product-card button[data-v-7b143514]:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container[data-v-7b143514]{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title[data-v-7b143514]{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state[data-v-7b143514]{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item[data-v-7b143514]{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name[data-v-7b143514]{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity[data-v-7b143514]{color:#6b7280}.cart-view .cart-item .item-price[data-v-7b143514]{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary[data-v-7b143514]{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row[data-v-7b143514]{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total[data-v-7b143514]{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn[data-v-7b143514]{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn[data-v-7b143514]:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card[data-v-7b143514]{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2[data-v-7b143514]{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p[data-v-7b143514]{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title[data-v-7b143514]{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item[data-v-7b143514]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details[data-v-7b143514]{font-weight:500}.my-mall-view .order-item .order-delivery-time[data-v-7b143514]{font-size:.8rem;color:#6b7280}.interaction-panel[data-v-7b143514]{border-left:1px solid #eae6dd;display:flex;flex-direction:column;gap:12px;background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.interaction-btn[data-v-7b143514]{padding:10px 15px;background-image:linear-gradient(to bottom,#ffffff,#f7f7f7);border:1px solid #a9a9a9;border-radius:6px;color:#3a3f4b;font-size:13px;cursor:pointer;text-align:center;transition:all .2s ease;font-weight:500;box-shadow:0 1px 2px rgba(0,0,0,.05)}.interaction-btn[data-v-7b143514]:hover{border-color:#4169e1;color:#4169e1;transform:translateY(-2px);box-shadow:0 3px 8px rgba(65,105,225,.15)}.interaction-btn.primary-btn[data-v-7b143514]{background-image:linear-gradient(to bottom,#4a89dc,rgb(54.2911111111,124.1511111111,216.1888888889));border-color:rgb(49.3638888889,120.9388888889,215.2361111111);color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.1)}.interaction-btn.primary-btn[data-v-7b143514]:hover{background-image:linear-gradient(to bottom,rgb(83.05,142.9,221.75),#4a89dc);border-color:rgb(61.6819444444,128.9694444444,217.6180555556);box-shadow:0 3px 8px rgba(74,137,220,.25)}.panel-section[data-v-7b143514]{margin-bottom:20px;padding:15px;background:#fff;border-radius:8px;border:1px solid #eae6dd;box-shadow:0 2px 8px rgba(58,63,75,.05);transition:box-shadow .3s ease}.panel-section[data-v-7b143514]:hover{box-shadow:0 4px 12px rgba(58,63,75,.08)}.section-title[data-v-7b143514]{font-size:14px;font-weight:600;color:#3a3f4b;margin-bottom:12px;text-align:left;border-bottom:2px solid #4169e1;padding-bottom:8px;display:inline-block}.world-book-controls-content[data-v-7b143514]{display:flex;flex-direction:column;gap:8px}.world-book-control-row[data-v-7b143514]{display:flex;align-items:center;gap:8px}.world-book-label[data-v-7b143514],.auto-write-label[data-v-7b143514]{font-size:13px;color:#6c757d}.world-book-input[data-v-7b143514]{width:60px;padding:4px 8px;border-radius:4px;border:1px solid #a9a9a9}.world-line-section[data-v-7b143514]{margin-top:auto;padding-top:15px;border-top:1px dashed #eae6dd}.world-line-title[data-v-7b143514]{font-size:14px;font-weight:600;color:#6c757d;margin-bottom:10px;text-align:center}.history-buttons-container[data-v-7b143514]{display:flex;flex-direction:column;gap:8px}
.guixu-root-container[data-v-65298b40]{display:grid;grid-template-rows:auto 1fr auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;background-color:#fdfbf6;color:#3a3f4b;border:1px solid #eae6dd;border-radius:12px;overflow:hidden;max-width:100%;margin:auto;box-shadow:0 8px 35px rgba(58,63,75,.12);position:relative;width:100%;height:720px}.guixu-root-container[data-v-65298b40] *{margin:0;padding:0;box-sizing:border-box}.game-container[data-v-65298b40]{display:grid;grid-template-columns:220px 1fr 160px;width:100%;height:100%;overflow:hidden;gap:1px}.character-panel[data-v-65298b40],.interaction-panel[data-v-65298b40]{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.character-panel[data-v-65298b40]{border-right:1px solid #eae6dd}.interaction-panel[data-v-65298b40]{border-left:1px solid #eae6dd}.main-content[data-v-65298b40]{padding:25px;overflow-y:auto;background:#fdfbf6;position:relative}#tablet-trigger[data-v-65298b40]{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-trigger[data-v-65298b40]:hover{background-color:#f5f1e9;color:#4169e1}#tablet-container[data-v-65298b40]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(58,63,75,.4);backdrop-filter:blur(5px);opacity:0;visibility:hidden;transform:scale(1.1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease;z-index:200}#tablet-container.is-visible[data-v-65298b40]{opacity:1;visibility:visible;transform:scale(1)}#tablet-container .tablet-case[data-v-65298b40]{width:90%;max-width:380px;height:90vh;max-height:800px;background-color:#1a1a1a;border-radius:40px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.3),inset 0 0 15px hsla(0,0%,100%,.1);display:flex;flex-direction:column}#tablet-container .phone-screen[data-v-65298b40]{width:100%;height:100%;background:linear-gradient(160deg,#f87171 0%,#a855f7 100%);border-radius:28px;overflow:hidden;position:relative;display:flex;flex-direction:column;color:#fff}#tablet-container .phone-content-area[data-v-65298b40]{flex-grow:1;position:relative;display:flex;flex-direction:column}#tablet-container .phone-desktop[data-v-65298b40]{display:flex;flex-direction:column;height:100%;padding:20px;box-sizing:border-box}#tablet-container .desktop-header[data-v-65298b40]{flex-shrink:0;padding:40px 0;text-align:center}#tablet-container .desktop-header .time-display #desktop-time[data-v-65298b40]{font-size:72px;font-weight:300;letter-spacing:1px;display:block;line-height:1}#tablet-container .desktop-header .time-display #desktop-date[data-v-65298b40]{font-size:16px;font-weight:400;opacity:.9}#tablet-container .app-grid[data-v-65298b40]{flex-grow:1;display:grid;grid-template-columns:repeat(4,1fr);gap:20px;align-content:flex-start}#tablet-container .desktop-dock-indicator[data-v-65298b40]{flex-shrink:0;display:flex;justify-content:center;padding:15px 0}#tablet-container .desktop-dock-indicator span[data-v-65298b40]{width:8px;height:8px;background-color:hsla(0,0%,100%,.5);border-radius:50%}#tablet-container .app-view-container[data-v-65298b40]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fdfbf6;z-index:10;flex-direction:column;color:#3a3f4b}#tablet-container .app-view-container.active[data-v-65298b40]{display:flex}#tablet-container .phone-nav-bar[data-v-65298b40]{height:50px;flex-shrink:0;display:flex;justify-content:space-around;align-items:center;padding:0 20px;background:rgba(0,0,0,.1)}#tablet-container .phone-nav-bar .nav-btn[data-v-65298b40]{background:none;border:none;color:#fff;opacity:.8;cursor:pointer;padding:5px}#tablet-container .phone-nav-bar .nav-btn svg[data-v-65298b40]{width:20px;height:20px}#tablet-container .guixu-root-container:not(.mobile-view) .main-content[data-v-65298b40]{grid-column:1/-1}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-65298b40],#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-65298b40]{position:absolute;top:0;height:100%;z-index:1000;transition:transform .35s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 25px rgba(0,0,0,.15);background:#f5f1e9;border:none}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-65298b40]{width:240px;left:0;transform:translateX(-100%);border-right:1px solid #eae6dd}#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-65298b40]{width:180px;right:0;transform:translateX(100%);border-left:1px solid #eae6dd}#tablet-container .guixu-root-container.left-sidebar-open .character-panel[data-v-65298b40]{transform:translateX(0)}#tablet-container .guixu-root-container.right-sidebar-open .interaction-panel[data-v-65298b40]{transform:translateX(0)}#tablet-container .sidebar-handle[data-v-65298b40]{position:fixed;z-index:1001;width:32px;height:80px;background:#fff;color:#6c757d;writing-mode:vertical-rl;text-orientation:mixed;display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #eae6dd;font-size:14px;font-weight:500;transition:background-color .2s;box-shadow:2px 0 8px rgba(58,63,75,.08)}#tablet-container .sidebar-handle[data-v-65298b40]:hover{background:#f5f1e9;color:#4169e1}#tablet-container #left-sidebar-handle[data-v-65298b40]{top:40%;left:0;border-left:none;border-top-right-radius:8px;border-bottom-right-radius:8px}#tablet-container #right-sidebar-handle[data-v-65298b40]{top:55%;right:0;border-right:none;border-left:1px solid #eae6dd;border-radius:8px 0 0 8px;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-container .app-icon[data-v-65298b40]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;text-decoration:none}#tablet-container .app-icon .app-icon-visual[data-v-65298b40]{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:transform .2s ease}#tablet-container .app-icon .app-icon-visual svg[data-v-65298b40]{width:28px;height:28px}#tablet-container .app-icon .app-icon-name[data-v-65298b40]{font-size:12px;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.3)}#tablet-container .app-icon:hover .app-icon-visual[data-v-65298b40]{transform:scale(1.1)}#tablet-container .app-icon[data-app-id=tianhuachat] .app-icon-visual[data-v-65298b40]{background-color:#3b82f6}#tablet-container .app-icon[data-app-id=campus-pass] .app-icon-visual[data-v-65298b40]{background-color:#14b8a6}#tablet-container .app-icon[data-app-id=schedule] .app-icon-visual[data-v-65298b40]{background-color:#8b5cf6}#tablet-container .app-icon[data-app-id=health] .app-icon-visual[data-v-65298b40]{background-color:#ef4444}#tablet-container .app-icon[data-app-id=forum] .app-icon-visual[data-v-65298b40]{background-color:#0ea5e9}#tablet-container .app-icon[data-app-id=shopping] .app-icon-visual[data-v-65298b40]{background-color:#f97316}#tablet-container .app-icon[data-app-id=inventory] .app-icon-visual[data-v-65298b40]{background-color:#ec4899}#tablet-container .app-icon[data-app-id=map] .app-icon-visual[data-v-65298b40]{background-color:#22c55e}#tablet-container .app-icon[data-app-id=settings] .app-icon-visual[data-v-65298b40]{background-color:#6b7280}.phone-status-bar[data-v-65298b40]{display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background-color:rgba(0,0,0,.1);color:#fff;font-size:12px;position:absolute;top:0;left:0;right:0;z-index:100}.phone-status-bar .status-left[data-v-65298b40],.phone-status-bar .status-right[data-v-65298b40]{display:flex;align-items:center;gap:6px}.phone-status-bar .status-center[data-v-65298b40]{font-weight:500}.phone-status-bar .battery-icon[data-v-65298b40]{width:22px;height:11px;border:1px solid #fff;border-radius:3px;position:relative;padding:1px}.phone-status-bar .battery-icon[data-v-65298b40]::after{content:"";position:absolute;right:-3px;top:2px;width:2px;height:5px;background-color:#fff;border-top-right-radius:1px;border-bottom-right-radius:1px}.phone-status-bar .battery-icon .battery-fill[data-v-65298b40]{height:100%;background-color:#fff;border-radius:1px;transition:width .3s ease}.phone-content-area[data-v-65298b40]{padding-top:24px}.mall-app[data-v-65298b40]{background-color:#f8f9fa}.mall-home-view .search-bar[data-v-65298b40]{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar[data-v-65298b40]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid[data-v-65298b40]{padding-bottom:4rem}.product-card[data-v-65298b40]{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container[data-v-65298b40]{flex-shrink:0;width:90px;height:90px}.product-card .product-image[data-v-65298b40]{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details[data-v-65298b40]{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name[data-v-65298b40]{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description[data-v-65298b40]{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer[data-v-65298b40]{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price[data-v-65298b40]{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock[data-v-65298b40]{font-size:.75rem;color:#6b7280}.product-card button[data-v-65298b40]{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button[data-v-65298b40]:hover{background-color:#4338ca}.product-card button[data-v-65298b40]:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container[data-v-65298b40]{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title[data-v-65298b40]{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state[data-v-65298b40]{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item[data-v-65298b40]{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name[data-v-65298b40]{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity[data-v-65298b40]{color:#6b7280}.cart-view .cart-item .item-price[data-v-65298b40]{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary[data-v-65298b40]{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row[data-v-65298b40]{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total[data-v-65298b40]{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn[data-v-65298b40]{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn[data-v-65298b40]:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card[data-v-65298b40]{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2[data-v-65298b40]{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p[data-v-65298b40]{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title[data-v-65298b40]{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item[data-v-65298b40]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details[data-v-65298b40]{font-weight:500}.my-mall-view .order-item .order-delivery-time[data-v-65298b40]{font-size:.8rem;color:#6b7280}.modal-backdrop[data-v-65298b40]{display:flex;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(58,63,75,.5);backdrop-filter:blur(8px);justify-content:center;align-items:center;z-index:1000;transition:opacity .3s ease}.modal-content[data-v-65298b40]{background:#fff;border:1px solid #eae6dd;border-radius:12px;padding:25px;width:90%;max-width:800px;height:90%;max-height:600px;display:flex;flex-direction:column;box-shadow:0 5px 30px rgba(0,0,0,.2);transform:scale(0.95);transition:transform .3s ease}.modal-backdrop.is-visible .modal-content[data-v-65298b40]{transform:scale(1)}.modal-header[data-v-65298b40]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #eae6dd;padding-bottom:15px;margin-bottom:20px;flex-shrink:0}.modal-title[data-v-65298b40]{font-size:20px;color:#4169e1;font-weight:600}.modal-close-btn[data-v-65298b40]{font-size:28px;color:#a9a9a9;cursor:pointer;background:none;border:none;transition:color .2s ease;margin-left:15px}.modal-close-btn[data-v-65298b40]:hover{color:#e74c3c}.modal-body[data-v-65298b40]{flex-grow:1;overflow-y:auto}
.add-friend-search-bar[data-v-bea6e394]{display:flex;gap:10px;margin-bottom:15px}.add-friend-search-bar input[data-v-bea6e394]{flex-grow:1;padding:8px 12px;border:1px solid #ccc;border-radius:6px}.search-results-list[data-v-bea6e394]{min-height:200px;max-height:40vh;overflow-y:auto}.search-prompt[data-v-bea6e394]{color:#6c757d;text-align:center;padding-top:20px}.search-result-item[data-v-bea6e394]{display:flex;justify-content:space-between;align-items:center;padding:10px 5px;border-bottom:1px solid #f0f0f0}
.guixu-root-container[data-v-7be4a277]{display:grid;grid-template-rows:auto 1fr auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;background-color:#fdfbf6;color:#3a3f4b;border:1px solid #eae6dd;border-radius:12px;overflow:hidden;max-width:100%;margin:auto;box-shadow:0 8px 35px rgba(58,63,75,.12);position:relative;width:100%;height:720px}.guixu-root-container[data-v-7be4a277] *{margin:0;padding:0;box-sizing:border-box}.game-container[data-v-7be4a277]{display:grid;grid-template-columns:220px 1fr 160px;width:100%;height:100%;overflow:hidden;gap:1px}.character-panel[data-v-7be4a277],.interaction-panel[data-v-7be4a277]{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.character-panel[data-v-7be4a277]{border-right:1px solid #eae6dd}.interaction-panel[data-v-7be4a277]{border-left:1px solid #eae6dd}.main-content[data-v-7be4a277]{padding:25px;overflow-y:auto;background:#fdfbf6;position:relative}#tablet-trigger[data-v-7be4a277]{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-trigger[data-v-7be4a277]:hover{background-color:#f5f1e9;color:#4169e1}#tablet-container[data-v-7be4a277]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(58,63,75,.4);backdrop-filter:blur(5px);opacity:0;visibility:hidden;transform:scale(1.1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease;z-index:200}#tablet-container.is-visible[data-v-7be4a277]{opacity:1;visibility:visible;transform:scale(1)}#tablet-container .tablet-case[data-v-7be4a277]{width:90%;max-width:380px;height:90vh;max-height:800px;background-color:#1a1a1a;border-radius:40px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.3),inset 0 0 15px hsla(0,0%,100%,.1);display:flex;flex-direction:column}#tablet-container .phone-screen[data-v-7be4a277]{width:100%;height:100%;background:linear-gradient(160deg,#f87171 0%,#a855f7 100%);border-radius:28px;overflow:hidden;position:relative;display:flex;flex-direction:column;color:#fff}#tablet-container .phone-content-area[data-v-7be4a277]{flex-grow:1;position:relative;display:flex;flex-direction:column}#tablet-container .phone-desktop[data-v-7be4a277]{display:flex;flex-direction:column;height:100%;padding:20px;box-sizing:border-box}#tablet-container .desktop-header[data-v-7be4a277]{flex-shrink:0;padding:40px 0;text-align:center}#tablet-container .desktop-header .time-display #desktop-time[data-v-7be4a277]{font-size:72px;font-weight:300;letter-spacing:1px;display:block;line-height:1}#tablet-container .desktop-header .time-display #desktop-date[data-v-7be4a277]{font-size:16px;font-weight:400;opacity:.9}#tablet-container .app-grid[data-v-7be4a277]{flex-grow:1;display:grid;grid-template-columns:repeat(4,1fr);gap:20px;align-content:flex-start}#tablet-container .desktop-dock-indicator[data-v-7be4a277]{flex-shrink:0;display:flex;justify-content:center;padding:15px 0}#tablet-container .desktop-dock-indicator span[data-v-7be4a277]{width:8px;height:8px;background-color:hsla(0,0%,100%,.5);border-radius:50%}#tablet-container .app-view-container[data-v-7be4a277]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fdfbf6;z-index:10;flex-direction:column;color:#3a3f4b}#tablet-container .app-view-container.active[data-v-7be4a277]{display:flex}#tablet-container .phone-nav-bar[data-v-7be4a277]{height:50px;flex-shrink:0;display:flex;justify-content:space-around;align-items:center;padding:0 20px;background:rgba(0,0,0,.1)}#tablet-container .phone-nav-bar .nav-btn[data-v-7be4a277]{background:none;border:none;color:#fff;opacity:.8;cursor:pointer;padding:5px}#tablet-container .phone-nav-bar .nav-btn svg[data-v-7be4a277]{width:20px;height:20px}#tablet-container .guixu-root-container:not(.mobile-view) .main-content[data-v-7be4a277]{grid-column:1/-1}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-7be4a277],#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-7be4a277]{position:absolute;top:0;height:100%;z-index:1000;transition:transform .35s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 25px rgba(0,0,0,.15);background:#f5f1e9;border:none}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-7be4a277]{width:240px;left:0;transform:translateX(-100%);border-right:1px solid #eae6dd}#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-7be4a277]{width:180px;right:0;transform:translateX(100%);border-left:1px solid #eae6dd}#tablet-container .guixu-root-container.left-sidebar-open .character-panel[data-v-7be4a277]{transform:translateX(0)}#tablet-container .guixu-root-container.right-sidebar-open .interaction-panel[data-v-7be4a277]{transform:translateX(0)}#tablet-container .sidebar-handle[data-v-7be4a277]{position:fixed;z-index:1001;width:32px;height:80px;background:#fff;color:#6c757d;writing-mode:vertical-rl;text-orientation:mixed;display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #eae6dd;font-size:14px;font-weight:500;transition:background-color .2s;box-shadow:2px 0 8px rgba(58,63,75,.08)}#tablet-container .sidebar-handle[data-v-7be4a277]:hover{background:#f5f1e9;color:#4169e1}#tablet-container #left-sidebar-handle[data-v-7be4a277]{top:40%;left:0;border-left:none;border-top-right-radius:8px;border-bottom-right-radius:8px}#tablet-container #right-sidebar-handle[data-v-7be4a277]{top:55%;right:0;border-right:none;border-left:1px solid #eae6dd;border-radius:8px 0 0 8px;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-container .app-icon[data-v-7be4a277]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;text-decoration:none}#tablet-container .app-icon .app-icon-visual[data-v-7be4a277]{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:transform .2s ease}#tablet-container .app-icon .app-icon-visual svg[data-v-7be4a277]{width:28px;height:28px}#tablet-container .app-icon .app-icon-name[data-v-7be4a277]{font-size:12px;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.3)}#tablet-container .app-icon:hover .app-icon-visual[data-v-7be4a277]{transform:scale(1.1)}#tablet-container .app-icon[data-app-id=tianhuachat] .app-icon-visual[data-v-7be4a277]{background-color:#3b82f6}#tablet-container .app-icon[data-app-id=campus-pass] .app-icon-visual[data-v-7be4a277]{background-color:#14b8a6}#tablet-container .app-icon[data-app-id=schedule] .app-icon-visual[data-v-7be4a277]{background-color:#8b5cf6}#tablet-container .app-icon[data-app-id=health] .app-icon-visual[data-v-7be4a277]{background-color:#ef4444}#tablet-container .app-icon[data-app-id=forum] .app-icon-visual[data-v-7be4a277]{background-color:#0ea5e9}#tablet-container .app-icon[data-app-id=shopping] .app-icon-visual[data-v-7be4a277]{background-color:#f97316}#tablet-container .app-icon[data-app-id=inventory] .app-icon-visual[data-v-7be4a277]{background-color:#ec4899}#tablet-container .app-icon[data-app-id=map] .app-icon-visual[data-v-7be4a277]{background-color:#22c55e}#tablet-container .app-icon[data-app-id=settings] .app-icon-visual[data-v-7be4a277]{background-color:#6b7280}.phone-status-bar[data-v-7be4a277]{display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background-color:rgba(0,0,0,.1);color:#fff;font-size:12px;position:absolute;top:0;left:0;right:0;z-index:100}.phone-status-bar .status-left[data-v-7be4a277],.phone-status-bar .status-right[data-v-7be4a277]{display:flex;align-items:center;gap:6px}.phone-status-bar .status-center[data-v-7be4a277]{font-weight:500}.phone-status-bar .battery-icon[data-v-7be4a277]{width:22px;height:11px;border:1px solid #fff;border-radius:3px;position:relative;padding:1px}.phone-status-bar .battery-icon[data-v-7be4a277]::after{content:"";position:absolute;right:-3px;top:2px;width:2px;height:5px;background-color:#fff;border-top-right-radius:1px;border-bottom-right-radius:1px}.phone-status-bar .battery-icon .battery-fill[data-v-7be4a277]{height:100%;background-color:#fff;border-radius:1px;transition:width .3s ease}.phone-content-area[data-v-7be4a277]{padding-top:24px}.mall-app[data-v-7be4a277]{background-color:#f8f9fa}.mall-home-view .search-bar[data-v-7be4a277]{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar[data-v-7be4a277]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid[data-v-7be4a277]{padding-bottom:4rem}.product-card[data-v-7be4a277]{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container[data-v-7be4a277]{flex-shrink:0;width:90px;height:90px}.product-card .product-image[data-v-7be4a277]{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details[data-v-7be4a277]{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name[data-v-7be4a277]{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description[data-v-7be4a277]{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer[data-v-7be4a277]{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price[data-v-7be4a277]{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock[data-v-7be4a277]{font-size:.75rem;color:#6b7280}.product-card button[data-v-7be4a277]{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button[data-v-7be4a277]:hover{background-color:#4338ca}.product-card button[data-v-7be4a277]:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container[data-v-7be4a277]{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title[data-v-7be4a277]{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state[data-v-7be4a277]{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item[data-v-7be4a277]{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name[data-v-7be4a277]{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity[data-v-7be4a277]{color:#6b7280}.cart-view .cart-item .item-price[data-v-7be4a277]{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary[data-v-7be4a277]{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row[data-v-7be4a277]{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total[data-v-7be4a277]{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn[data-v-7be4a277]{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn[data-v-7be4a277]:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card[data-v-7be4a277]{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2[data-v-7be4a277]{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p[data-v-7be4a277]{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title[data-v-7be4a277]{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item[data-v-7be4a277]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details[data-v-7be4a277]{font-weight:500}.my-mall-view .order-item .order-delivery-time[data-v-7be4a277]{font-size:.8rem;color:#6b7280}.inventory-container[data-v-7be4a277]{display:flex;height:100%;gap:15px}.inventory-menu-column[data-v-7be4a277]{flex:0 0 150px;border-right:1px solid #eae6dd;padding-right:15px;overflow-y:auto}.inventory-menu-column .menu-item[data-v-7be4a277]{padding:10px 12px;border-radius:6px;cursor:pointer;font-size:14px;transition:background-color .2s ease,color .2s ease}.inventory-menu-column .menu-item[data-v-7be4a277]:hover{background-color:#f5f1e9}.inventory-menu-column .menu-item.active[data-v-7be4a277]{background-color:rgba(65,105,225,.1);color:#4169e1;font-weight:600}.inventory-display-column[data-v-7be4a277]{flex-grow:1;overflow-y:auto}.empty-category-text[data-v-7be4a277]{display:flex;justify-content:center;align-items:center;height:100%;color:#a9a9a9;font-style:italic}
.guixu-root-container[data-v-bf75757c]{display:grid;grid-template-rows:auto 1fr auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;background-color:#fdfbf6;color:#3a3f4b;border:1px solid #eae6dd;border-radius:12px;overflow:hidden;max-width:100%;margin:auto;box-shadow:0 8px 35px rgba(58,63,75,.12);position:relative;width:100%;height:720px}.guixu-root-container[data-v-bf75757c] *{margin:0;padding:0;box-sizing:border-box}.game-container[data-v-bf75757c]{display:grid;grid-template-columns:220px 1fr 160px;width:100%;height:100%;overflow:hidden;gap:1px}.character-panel[data-v-bf75757c],.interaction-panel[data-v-bf75757c]{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.character-panel[data-v-bf75757c]{border-right:1px solid #eae6dd}.interaction-panel[data-v-bf75757c]{border-left:1px solid #eae6dd}.main-content[data-v-bf75757c]{padding:25px;overflow-y:auto;background:#fdfbf6;position:relative}#tablet-trigger[data-v-bf75757c]{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-trigger[data-v-bf75757c]:hover{background-color:#f5f1e9;color:#4169e1}#tablet-container[data-v-bf75757c]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(58,63,75,.4);backdrop-filter:blur(5px);opacity:0;visibility:hidden;transform:scale(1.1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease;z-index:200}#tablet-container.is-visible[data-v-bf75757c]{opacity:1;visibility:visible;transform:scale(1)}#tablet-container .tablet-case[data-v-bf75757c]{width:90%;max-width:380px;height:90vh;max-height:800px;background-color:#1a1a1a;border-radius:40px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.3),inset 0 0 15px hsla(0,0%,100%,.1);display:flex;flex-direction:column}#tablet-container .phone-screen[data-v-bf75757c]{width:100%;height:100%;background:linear-gradient(160deg,#f87171 0%,#a855f7 100%);border-radius:28px;overflow:hidden;position:relative;display:flex;flex-direction:column;color:#fff}#tablet-container .phone-content-area[data-v-bf75757c]{flex-grow:1;position:relative;display:flex;flex-direction:column}#tablet-container .phone-desktop[data-v-bf75757c]{display:flex;flex-direction:column;height:100%;padding:20px;box-sizing:border-box}#tablet-container .desktop-header[data-v-bf75757c]{flex-shrink:0;padding:40px 0;text-align:center}#tablet-container .desktop-header .time-display #desktop-time[data-v-bf75757c]{font-size:72px;font-weight:300;letter-spacing:1px;display:block;line-height:1}#tablet-container .desktop-header .time-display #desktop-date[data-v-bf75757c]{font-size:16px;font-weight:400;opacity:.9}#tablet-container .app-grid[data-v-bf75757c]{flex-grow:1;display:grid;grid-template-columns:repeat(4,1fr);gap:20px;align-content:flex-start}#tablet-container .desktop-dock-indicator[data-v-bf75757c]{flex-shrink:0;display:flex;justify-content:center;padding:15px 0}#tablet-container .desktop-dock-indicator span[data-v-bf75757c]{width:8px;height:8px;background-color:hsla(0,0%,100%,.5);border-radius:50%}#tablet-container .app-view-container[data-v-bf75757c]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fdfbf6;z-index:10;flex-direction:column;color:#3a3f4b}#tablet-container .app-view-container.active[data-v-bf75757c]{display:flex}#tablet-container .phone-nav-bar[data-v-bf75757c]{height:50px;flex-shrink:0;display:flex;justify-content:space-around;align-items:center;padding:0 20px;background:rgba(0,0,0,.1)}#tablet-container .phone-nav-bar .nav-btn[data-v-bf75757c]{background:none;border:none;color:#fff;opacity:.8;cursor:pointer;padding:5px}#tablet-container .phone-nav-bar .nav-btn svg[data-v-bf75757c]{width:20px;height:20px}#tablet-container .guixu-root-container:not(.mobile-view) .main-content[data-v-bf75757c]{grid-column:1/-1}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-bf75757c],#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-bf75757c]{position:absolute;top:0;height:100%;z-index:1000;transition:transform .35s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 25px rgba(0,0,0,.15);background:#f5f1e9;border:none}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-bf75757c]{width:240px;left:0;transform:translateX(-100%);border-right:1px solid #eae6dd}#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-bf75757c]{width:180px;right:0;transform:translateX(100%);border-left:1px solid #eae6dd}#tablet-container .guixu-root-container.left-sidebar-open .character-panel[data-v-bf75757c]{transform:translateX(0)}#tablet-container .guixu-root-container.right-sidebar-open .interaction-panel[data-v-bf75757c]{transform:translateX(0)}#tablet-container .sidebar-handle[data-v-bf75757c]{position:fixed;z-index:1001;width:32px;height:80px;background:#fff;color:#6c757d;writing-mode:vertical-rl;text-orientation:mixed;display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #eae6dd;font-size:14px;font-weight:500;transition:background-color .2s;box-shadow:2px 0 8px rgba(58,63,75,.08)}#tablet-container .sidebar-handle[data-v-bf75757c]:hover{background:#f5f1e9;color:#4169e1}#tablet-container #left-sidebar-handle[data-v-bf75757c]{top:40%;left:0;border-left:none;border-top-right-radius:8px;border-bottom-right-radius:8px}#tablet-container #right-sidebar-handle[data-v-bf75757c]{top:55%;right:0;border-right:none;border-left:1px solid #eae6dd;border-radius:8px 0 0 8px;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-container .app-icon[data-v-bf75757c]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;text-decoration:none}#tablet-container .app-icon .app-icon-visual[data-v-bf75757c]{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:transform .2s ease}#tablet-container .app-icon .app-icon-visual svg[data-v-bf75757c]{width:28px;height:28px}#tablet-container .app-icon .app-icon-name[data-v-bf75757c]{font-size:12px;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.3)}#tablet-container .app-icon:hover .app-icon-visual[data-v-bf75757c]{transform:scale(1.1)}#tablet-container .app-icon[data-app-id=tianhuachat] .app-icon-visual[data-v-bf75757c]{background-color:#3b82f6}#tablet-container .app-icon[data-app-id=campus-pass] .app-icon-visual[data-v-bf75757c]{background-color:#14b8a6}#tablet-container .app-icon[data-app-id=schedule] .app-icon-visual[data-v-bf75757c]{background-color:#8b5cf6}#tablet-container .app-icon[data-app-id=health] .app-icon-visual[data-v-bf75757c]{background-color:#ef4444}#tablet-container .app-icon[data-app-id=forum] .app-icon-visual[data-v-bf75757c]{background-color:#0ea5e9}#tablet-container .app-icon[data-app-id=shopping] .app-icon-visual[data-v-bf75757c]{background-color:#f97316}#tablet-container .app-icon[data-app-id=inventory] .app-icon-visual[data-v-bf75757c]{background-color:#ec4899}#tablet-container .app-icon[data-app-id=map] .app-icon-visual[data-v-bf75757c]{background-color:#22c55e}#tablet-container .app-icon[data-app-id=settings] .app-icon-visual[data-v-bf75757c]{background-color:#6b7280}.phone-status-bar[data-v-bf75757c]{display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background-color:rgba(0,0,0,.1);color:#fff;font-size:12px;position:absolute;top:0;left:0;right:0;z-index:100}.phone-status-bar .status-left[data-v-bf75757c],.phone-status-bar .status-right[data-v-bf75757c]{display:flex;align-items:center;gap:6px}.phone-status-bar .status-center[data-v-bf75757c]{font-weight:500}.phone-status-bar .battery-icon[data-v-bf75757c]{width:22px;height:11px;border:1px solid #fff;border-radius:3px;position:relative;padding:1px}.phone-status-bar .battery-icon[data-v-bf75757c]::after{content:"";position:absolute;right:-3px;top:2px;width:2px;height:5px;background-color:#fff;border-top-right-radius:1px;border-bottom-right-radius:1px}.phone-status-bar .battery-icon .battery-fill[data-v-bf75757c]{height:100%;background-color:#fff;border-radius:1px;transition:width .3s ease}.phone-content-area[data-v-bf75757c]{padding-top:24px}.mall-app[data-v-bf75757c]{background-color:#f8f9fa}.mall-home-view .search-bar[data-v-bf75757c]{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar[data-v-bf75757c]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid[data-v-bf75757c]{padding-bottom:4rem}.product-card[data-v-bf75757c]{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container[data-v-bf75757c]{flex-shrink:0;width:90px;height:90px}.product-card .product-image[data-v-bf75757c]{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details[data-v-bf75757c]{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name[data-v-bf75757c]{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description[data-v-bf75757c]{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer[data-v-bf75757c]{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price[data-v-bf75757c]{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock[data-v-bf75757c]{font-size:.75rem;color:#6b7280}.product-card button[data-v-bf75757c]{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button[data-v-bf75757c]:hover{background-color:#4338ca}.product-card button[data-v-bf75757c]:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container[data-v-bf75757c]{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title[data-v-bf75757c]{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state[data-v-bf75757c]{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item[data-v-bf75757c]{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name[data-v-bf75757c]{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity[data-v-bf75757c]{color:#6b7280}.cart-view .cart-item .item-price[data-v-bf75757c]{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary[data-v-bf75757c]{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row[data-v-bf75757c]{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total[data-v-bf75757c]{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn[data-v-bf75757c]{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn[data-v-bf75757c]:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card[data-v-bf75757c]{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2[data-v-bf75757c]{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p[data-v-bf75757c]{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title[data-v-bf75757c]{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item[data-v-bf75757c]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details[data-v-bf75757c]{font-weight:500}.my-mall-view .order-item .order-delivery-time[data-v-bf75757c]{font-size:.8rem;color:#6b7280}.top-status[data-v-bf75757c]{grid-column:1/-1;background:linear-gradient(to bottom,#ffffff,#f9f9f9);border-bottom:1px solid #eae6dd;display:flex;align-items:center;justify-content:space-around;padding:0 15px;box-shadow:0 2px 5px rgba(58,63,75,.08);position:relative;z-index:10}.world-info-container[data-v-bf75757c]{display:flex;flex-direction:column;gap:4px;align-items:center}.info-panel[data-v-bf75757c]{display:flex;gap:15px;background:rgba(65,105,225,.1);padding:5px 15px;border-radius:8px;border:1px solid rgba(65,105,225,.2)}.info-item[data-v-bf75757c]{display:flex;align-items:baseline;gap:5px}.info-item.clickable[data-v-bf75757c]{cursor:pointer;transition:all .3s ease;border-radius:5px;padding:3px 6px}.info-item.clickable[data-v-bf75757c]:hover{background-color:rgba(65,105,225,.15)}.info-item.clickable:hover .info-value[data-v-bf75757c]{color:#4169e1}.info-label[data-v-bf75757c]{font-size:12px;color:#6c757d}.info-value[data-v-bf75757c]{font-size:13px;color:#3a3f4b;font-weight:500}.status-item[data-v-bf75757c]{display:flex;flex-direction:column;align-items:center;gap:4px}.status-label[data-v-bf75757c]{font-size:12px;color:#6c757d}.status-value[data-v-bf75757c]{font-size:14px;color:#3a3f4b;font-weight:500}.guixu-charge[data-v-bf75757c]{width:120px;height:6px;background-color:#e9ecef;border-radius:3px;overflow:hidden;margin-top:5px}.guixu-fill[data-v-bf75757c]{height:100%;background:#4a89dc;width:75%;border-radius:3px;transition:width .5s ease-in-out}
.message-view[data-v-578c2f82]{height:100%;overflow-y:auto}.chat-item[data-v-578c2f82]{display:flex;align-items:center;padding:10px 15px;border-bottom:1px solid #e5e7eb;cursor:pointer;transition:background-color .2s ease}.chat-item[data-v-578c2f82]:hover{background-color:#f9fafb}.avatar[data-v-578c2f82]{width:48px;height:48px;border-radius:50%;margin-right:12px;overflow:hidden;flex-shrink:0}.chat-info[data-v-578c2f82]{flex-grow:1;overflow:hidden}.group-avatar[data-v-578c2f82]{background-color:#f97316}.group-tag[data-v-578c2f82]{font-size:10px;padding:2px 4px;border-radius:4px;background-color:#e5e7eb;color:#4b5563;margin-left:5px}.chat-name[data-v-578c2f82]{font-weight:500;color:#1f2937}.last-message[data-v-578c2f82]{font-size:14px;color:#6b7280;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chat-meta[data-v-578c2f82]{text-align:right;font-size:12px;color:#9ca3af}.unread-badge[data-v-578c2f82]{background-color:#ef4444;color:#fff;border-radius:50%;padding:2px 6px;font-size:10px;margin-top:4px;display:inline-block}
.contacts-view[data-v-7396e567]{display:flex;flex-direction:column;height:100%;background-color:#f9fafb}.contact-search-bar[data-v-7396e567]{padding:8px 15px;display:flex;gap:10px;border-bottom:1px solid #e5e7eb;background-color:#fff}.contact-search-bar input[data-v-7396e567]{flex-grow:1;border:none;background-color:#f9fafb;border-radius:18px;padding:8px 15px;font-size:15px}.contact-search-bar input[data-v-7396e567]:focus{outline:none}.contact-search-bar .add-friend-btn[data-v-7396e567]{flex-shrink:0;width:36px;height:36px;border-radius:50%;border:none;background-color:#f9fafb;color:#6c757d;font-size:24px;cursor:pointer}.contact-function-list[data-v-7396e567]{background-color:#fff;margin-bottom:8px}.contact-function-list .function-item[data-v-7396e567]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;font-size:16px;border-bottom:1px solid #e5e7eb;cursor:pointer}.contact-function-list .function-item[data-v-7396e567]:hover{background-color:#f9fafb}.contact-function-list .function-item .count[data-v-7396e567]{color:#6c757d;font-size:14px}#contact-groups-container[data-v-7396e567]{flex-grow:1;overflow-y:auto;background-color:#fff}.contact-group[data-v-7396e567]{margin:0;padding:0;border-bottom:1px solid #e5e7eb}.contact-group summary[data-v-7396e567]{padding:10px 15px;font-weight:500;color:#6c757d;background-color:#f9fafb;cursor:pointer;display:flex;justify-content:space-between}.contact-item[data-v-7396e567]{display:flex;align-items:center;padding:10px 15px;cursor:pointer;transition:background-color .2s ease;background-color:#fff;gap:12px}.contact-item[data-v-7396e567]:hover{background-color:rgb(242.88,244.9,246.92)}.contact-item .avatar[data-v-7396e567]{width:40px;height:40px;border-radius:50%;margin-right:12px;overflow:hidden;display:flex;justify-content:center;align-items:center;font-size:18px;font-weight:bold;color:#fff;flex-shrink:0}.contact-item .contact-details[data-v-7396e567]{flex-grow:1;overflow:hidden}.contact-item .contact-name[data-v-7396e567]{font-weight:500;font-size:16px;color:#374151}.contact-item .contact-signature[data-v-7396e567]{font-size:13px;color:#6c757d;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px}
.moments-view[data-v-329cf6a5]{height:100%;overflow-y:auto;padding:15px;background-color:#f3f4f6}.moment-card[data-v-329cf6a5]{background:#fff;border-radius:8px;padding:15px;margin-bottom:15px;box-shadow:0 1px 3px rgba(0,0,0,.1)}.moment-header[data-v-329cf6a5]{display:flex;align-items:center;margin-bottom:12px}.avatar[data-v-329cf6a5]{width:40px;height:40px;border-radius:50%;background-color:#f97316;color:#fff;display:flex;justify-content:center;align-items:center;font-size:18px;font-weight:bold;margin-right:12px}.author-name[data-v-329cf6a5]{font-weight:500}.timestamp[data-v-329cf6a5]{font-size:12px;color:#9ca3af}.moment-content[data-v-329cf6a5]{margin-bottom:12px}.moment-actions[data-v-329cf6a5]{display:flex;gap:10px;border-top:1px solid #e5e7eb;padding-top:10px}.moment-actions button[data-v-329cf6a5]{background:none;border:none;color:#6b7280;cursor:pointer;font-size:14px;display:flex;align-items:center;gap:5px;transition:color .2s ease}.moment-actions button[data-v-329cf6a5]:hover{color:#3b82f6}.comment-input-area[data-v-329cf6a5]{margin-top:10px;display:flex;gap:10px}.comment-input-area input[data-v-329cf6a5]{flex-grow:1;border:1px solid #e5e7eb;border-radius:6px;padding:8px 12px;font-size:14px}.comment-input-area button[data-v-329cf6a5]{background-color:#3b82f6;color:#fff;border:none;border-radius:6px;padding:8px 15px;cursor:pointer}
.chat-view[data-v-8d9c9384]{display:flex;flex-direction:column;height:100%;position:relative;background-color:#f3f4f6}.chat-header[data-v-8d9c9384]{display:flex;align-items:center;padding:10px 15px;background-color:#fff;border-bottom:1px solid #e5e7eb;flex-shrink:0}.chat-header .back-btn[data-v-8d9c9384]{background:none;border:none;font-size:24px;cursor:pointer;margin-right:10px;color:#6c757d}.chat-header .chat-title[data-v-8d9c9384]{font-weight:600;font-size:16px}.message-list[data-v-8d9c9384]{flex-grow:1;padding:15px;overflow-y:auto;display:flex;flex-direction:column}.chat-bubble-wrapper[data-v-8d9c9384]{display:flex;gap:10px;max-width:85%;align-items:flex-start;margin-bottom:10px}.chat-bubble-wrapper .chat-avatar[data-v-8d9c9384]{width:40px;height:40px;flex-shrink:0;border-radius:50%;overflow:hidden}.chat-bubble-wrapper .chat-bubble-content[data-v-8d9c9384]{display:flex;flex-direction:column;align-items:flex-start}.chat-bubble-wrapper .chat-sender-name[data-v-8d9c9384]{font-size:13px;color:#6c757d;margin-bottom:4px}.chat-bubble-wrapper .message-line[data-v-8d9c9384]{display:flex;align-items:flex-end;gap:8px}.chat-bubble-wrapper .chat-bubble[data-v-8d9c9384]{background-color:#fff;border-radius:12px;padding:10px 14px;line-height:1.6;font-size:15px;color:#374151;word-break:break-word}.chat-bubble-wrapper .chat-timestamp[data-v-8d9c9384]{font-size:12px;color:#6c757d;flex-shrink:0}.chat-bubble-wrapper.user[data-v-8d9c9384]{align-self:flex-end;flex-direction:row-reverse}.chat-bubble-wrapper.user .chat-bubble-content[data-v-8d9c9384]{align-items:flex-end}.chat-bubble-wrapper.user .message-line[data-v-8d9c9384]{flex-direction:row-reverse}.chat-bubble-wrapper.user .chat-bubble[data-v-8d9c9384]{background-color:#4a89dc;color:#fff}.chat-bubble-wrapper.system[data-v-8d9c9384]{justify-content:center;align-self:center;max-width:100%}.chat-bubble-wrapper.system .chat-bubble[data-v-8d9c9384]{background-color:#e5e7eb;color:#6c757d;font-size:13px;border-radius:12px;padding:6px 12px;text-align:center;max-width:-moz-fit-content;max-width:fit-content}.chat-input-area[data-v-8d9c9384]{display:flex;align-items:flex-end;gap:8px;padding:8px;background-color:#fff;border-top:1px solid #e5e7eb;flex-shrink:0}.chat-input-area .chat-prefix-select[data-v-8d9c9384]{flex-shrink:0;padding:6px 8px;font-size:14px;border:1px solid #e5e7eb;border-radius:6px;margin-bottom:5px;height:36px}.chat-input-area textarea[data-v-8d9c9384]{flex-grow:1;border:1px solid #e5e7eb;border-radius:18px;padding:8px 14px;font-size:15px;line-height:1.4;resize:none;overflow-y:auto;max-height:100px;min-height:22px}.chat-input-area .interaction-btn[data-v-8d9c9384]{flex-shrink:0;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:0;margin-bottom:2px;background-color:#3b82f6;color:#fff;border:none;cursor:pointer}.chat-input-area .interaction-btn[data-v-8d9c9384]:hover{background-color:#2563eb}
.new-friends-view[data-v-62dcff5d]{display:flex;flex-direction:column;height:100%;background-color:#f0f2f5}.header[data-v-62dcff5d]{display:flex;align-items:center;background-color:#3b82f6;color:#fff;padding:10px 15px;flex-shrink:0}.header .back-btn[data-v-62dcff5d]{background:none;border:none;color:#fff;font-size:24px;margin-right:15px;cursor:pointer}.header h1[data-v-62dcff5d]{font-size:18px;margin:0}.friend-request-list[data-v-62dcff5d]{flex-grow:1;overflow-y:auto}.request-item[data-v-62dcff5d]{display:flex;align-items:center;padding:12px 15px;background:#fff;border-bottom:1px solid #e5e7eb}.avatar[data-v-62dcff5d]{width:48px;height:48px;border-radius:50%;overflow:hidden;margin-right:12px;flex-shrink:0}.request-info[data-v-62dcff5d]{flex-grow:1}.request-info .name[data-v-62dcff5d]{font-weight:500}.request-info .message[data-v-62dcff5d]{font-size:14px;color:#6b7280}.actions[data-v-62dcff5d]{display:flex;gap:10px}.actions button[data-v-62dcff5d]{border:none;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:14px}.actions .accept-btn[data-v-62dcff5d]{background-color:#10b981;color:#fff}.actions .reject-btn[data-v-62dcff5d]{background-color:#e5e7eb;color:#4b5563}.no-requests[data-v-62dcff5d]{text-align:center;color:#9ca3af;padding:40px}
.group-list-view[data-v-456cb086]{display:flex;flex-direction:column;height:100%;background-color:#f0f2f5}.header[data-v-456cb086]{display:flex;align-items:center;background-color:#3b82f6;color:#fff;padding:10px 15px;flex-shrink:0}.header .back-btn[data-v-456cb086]{background:none;border:none;color:#fff;font-size:24px;margin-right:15px;cursor:pointer}.header h1[data-v-456cb086]{font-size:18px;margin:0}.group-list[data-v-456cb086]{flex-grow:1;overflow-y:auto}.group-item[data-v-456cb086]{display:flex;align-items:center;padding:12px 15px;background:#fff;border-bottom:1px solid #e5e7eb;cursor:pointer}.group-item[data-v-456cb086]:hover{background-color:#f9fafb}.avatar[data-v-456cb086]{width:48px;height:48px;border-radius:8px;background-color:#f97316;color:#fff;display:flex;justify-content:center;align-items:center;font-size:20px;font-weight:bold;margin-right:12px}.group-name[data-v-456cb086]{font-weight:500}.no-groups[data-v-456cb086]{text-align:center;color:#9ca3af;padding:40px}
.contact-detail-view[data-v-03746552]{display:flex;flex-direction:column;height:100%;background-color:#f9fafb}.header[data-v-03746552]{display:flex;align-items:center;background-color:#3b82f6;color:#fff;padding:10px 15px;flex-shrink:0}.header .back-btn[data-v-03746552]{background:none;border:none;color:#fff;font-size:24px;margin-right:15px;cursor:pointer}.header h1[data-v-03746552]{font-size:18px;margin:0}.contact-content[data-v-03746552]{flex-grow:1;padding:20px}.profile-header[data-v-03746552]{display:flex;align-items:center;gap:20px;padding-bottom:20px;border-bottom:1px solid #e5e7eb}.avatar[data-v-03746552]{width:72px;height:72px;border-radius:50%;overflow:hidden}.name-section .name[data-v-03746552]{font-size:22px;font-weight:600;margin:0 0 5px 0}.name-section .signature[data-v-03746552]{font-size:14px;color:#6b7280;margin:0}.info-list[data-v-03746552]{margin-top:20px;background:#fff;border-radius:8px;padding:0 15px;border:1px solid #e5e7eb}.info-item[data-v-03746552]{display:flex;justify-content:space-between;padding:15px 0;font-size:16px}.info-item[data-v-03746552]:not(:last-child){border-bottom:1px solid #f3f4f6}.info-item .label[data-v-03746552]{color:#6b7280}.info-item .value[data-v-03746552]{color:#1f2937}.actions[data-v-03746552]{margin-top:30px}.actions .chat-btn[data-v-03746552]{width:100%;padding:12px;font-size:16px;font-weight:500;border-radius:8px;border:none;background-color:#3b82f6;color:#fff;cursor:pointer;transition:background-color .2s}.actions .chat-btn[data-v-03746552]:hover{background-color:#2563eb}.loading[data-v-03746552]{text-align:center;padding:40px;color:#6b7280}
.tianhuachat-app[data-v-74dca3e8]{display:flex;flex-direction:column;height:100%;background-color:#f0f2f5;color:#333}.main-view[data-v-74dca3e8]{display:flex;flex-direction:column;height:100%}.app-header[data-v-74dca3e8]{background-color:#3b82f6;color:#fff;padding:15px;text-align:center;flex-shrink:0;font-size:16px}.app-content[data-v-74dca3e8]{flex-grow:1;overflow-y:auto;position:relative}.app-nav[data-v-74dca3e8]{display:flex;border-top:1px solid #e5e7eb;flex-shrink:0}.app-nav button[data-v-74dca3e8]{flex-grow:1;padding:12px 0;background:#fff;border:none;cursor:pointer;color:#6b7280;transition:all .2s ease}.app-nav button.active[data-v-74dca3e8]{color:#3b82f6;font-weight:600;background-color:#f9fafb}.app-nav button[data-v-74dca3e8]:hover:not(.active){background-color:#f9fafb}
.debug-info[data-v-2a5a5544]{background:#fffbe6;border:1px solid #fde68a;padding:10px;margin-bottom:15px;border-radius:8px;font-size:12px;color:#92400e}.debug-info p[data-v-2a5a5544]{margin:4px 0}.debug-info code[data-v-2a5a5544]{background:#fef3c7;padding:2px 4px;border-radius:4px}.schedule-view[data-v-2a5a5544]{overflow-x:auto}.timeline-grid[data-v-2a5a5544]{display:flex;min-width:800px}.time-axis[data-v-2a5a5544]{flex-shrink:0;padding-top:40px}.time-axis .time-slot[data-v-2a5a5544]{height:60px;display:flex;align-items:center;justify-content:center;font-size:12px;color:#6b7280}.schedule-lanes[data-v-2a5a5544]{display:grid;grid-template-columns:repeat(7,1fr);flex-grow:1}.day-lane[data-v-2a5a5544]{border-left:1px solid #e5e7eb;position:relative}.day-lane.today[data-v-2a5a5544]{background-color:rgba(13,110,253,.05)}.day-header[data-v-2a5a5544]{text-align:center;padding:10px 0;font-weight:500;position:sticky;top:0;background:#f8f9fa;z-index:10}.courses-container[data-v-2a5a5544]{position:relative;height:540px}.event-notice[data-v-2a5a5544]{padding:40px 20px;text-align:center;background-color:#fffbe6;border:1px solid #fde68a;border-radius:12px;color:#92400e}.event-notice h3[data-v-2a5a5544]{margin:0 0 10px 0;font-size:18px}.event-notice p[data-v-2a5a5544]{margin:0;font-size:14px}.course-item[data-v-2a5a5544]{position:absolute;left:4px;right:4px;border-radius:8px;padding:8px;color:#fff;overflow:hidden;transition:all .2s ease;box-shadow:0 2px 4px rgba(0,0,0,.1);border:1px solid rgba(0,0,0,.05)}.course-item[data-v-2a5a5544]:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.15)}.course-item .course-name[data-v-2a5a5544]{font-weight:600;font-size:14px;margin:0 0 4px 0}.course-item .course-details[data-v-2a5a5544]{font-size:12px;opacity:.9;margin:0}
.grades-view[data-v-3a096e44]{padding:5px}.summary-card[data-v-3a096e44]{background-color:#fff;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 4px 12px rgba(0,0,0,.05);text-align:center}.summary-card .summary-item .label[data-v-3a096e44]{font-size:16px;color:#6b7280;margin-bottom:8px;display:block}.summary-card .summary-item .value.rank[data-v-3a096e44]{font-size:36px;font-weight:700;color:#0d6efd}.subjects-grid[data-v-3a096e44]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px}.subject-card[data-v-3a096e44]{background-color:#fff;border-radius:12px;padding:15px;box-shadow:0 2px 8px rgba(0,0,0,.05);transition:all .2s ease}.subject-card[data-v-3a096e44]:hover{transform:translateY(-3px);box-shadow:0 4px 12px rgba(0,0,0,.08)}.subject-card .subject-name[data-v-3a096e44]{font-size:16px;font-weight:600;margin:0 0 15px 0;text-align:center;color:#374151}.subject-card .details .detail-item[data-v-3a096e44]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f3f4f6}.subject-card .details .detail-item[data-v-3a096e44]:last-child{border-bottom:none}.subject-card .details .detail-item .label[data-v-3a096e44]{font-size:13px;color:#6b7280}.subject-card .details .detail-item .value[data-v-3a096e44]{font-size:14px;font-weight:500;color:#1f2937}.subject-card .details .detail-item .value.score[data-v-3a096e44]{font-weight:600;color:#0d6efd}
.notifications-view[data-v-420ddbcc]{padding:5px}.notifications-list[data-v-420ddbcc]{display:flex;flex-direction:column;gap:15px}.notification-card[data-v-420ddbcc]{background-color:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,.05);border-left:5px solid #0d6efd}.card-header[data-v-420ddbcc]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.card-header .title[data-v-420ddbcc]{font-size:17px;font-weight:600;color:#1f2937;margin:0}.card-header .time[data-v-420ddbcc]{font-size:12px;color:#9ca3af;flex-shrink:0;margin-left:15px}.content[data-v-420ddbcc]{font-size:14px;color:#4b5563;line-height:1.6;margin:0 0 15px 0}.publisher[data-v-420ddbcc]{font-size:12px;color:#9ca3af;text-align:right;margin:0;font-style:italic}.no-notifications[data-v-420ddbcc]{text-align:center;color:#9ca3af;padding:40px 20px;background-color:#fff;border-radius:8px;font-size:14px}
.campus-pass-app[data-v-20695e41]{display:flex;flex-direction:column;height:100%}.app-header[data-v-20695e41]{text-align:center;padding:15px;background-color:#0d6efd;color:#fff;flex-shrink:0}.app-tabs[data-v-20695e41]{display:flex;background-color:#fff;border-bottom:1px solid #e5e7eb;flex-shrink:0}.app-tabs button[data-v-20695e41]{flex-grow:1;padding:12px 0;background:none;border:none;cursor:pointer;font-size:15px;color:#6b7280;border-bottom:2px solid rgba(0,0,0,0);transition:all .2s ease}.app-tabs button.active[data-v-20695e41]{color:#0d6efd;font-weight:600;border-bottom-color:#0d6efd}.app-content[data-v-20695e41]{flex-grow:1;overflow-y:auto;padding:15px;background-color:#f8f9fa}
.modal-backdrop[data-v-0729bba8]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[data-v-0729bba8]{background:#fff;padding:20px;border-radius:8px;width:90%;max-width:400px;box-shadow:0 4px 6px rgba(0,0,0,.1)}h3[data-v-0729bba8]{margin-top:0}.form-group[data-v-0729bba8]{margin-bottom:15px}label[data-v-0729bba8]{display:block;margin-bottom:5px;font-weight:600}input[data-v-0729bba8],select[data-v-0729bba8]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}.modal-actions[data-v-0729bba8]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}button[data-v-0729bba8]{padding:8px 16px;border:none;border-radius:4px;cursor:pointer}button[type=submit][data-v-0729bba8]{background-color:#0d6efd;color:#fff}button[type=button][data-v-0729bba8]{background-color:#6c757d;color:#fff}
.calendar-app[data-v-74f1f188]{padding:10px;background:#fff;height:100%;display:flex;flex-direction:column}.app-header[data-v-74f1f188]{display:flex;justify-content:space-between;align-items:center;padding:10px}.app-header h2[data-v-74f1f188]{margin:0;font-size:18px}.calendar-grid[data-v-74f1f188]{display:grid;grid-template-columns:repeat(7,1fr);gap:2px;flex-grow:1}.day-header[data-v-74f1f188]{text-align:center;font-weight:600;font-size:12px;padding:5px 0;color:#6b7280}.day-cell[data-v-74f1f188]{border:1px solid #f3f4f6;border-radius:4px;padding:4px;min-height:60px;transition:background-color .2s;cursor:pointer}.day-cell.is-other-month[data-v-74f1f188]{color:#d1d5db;background-color:#f9fafb}.day-cell.is-today .day-number[data-v-74f1f188]{background-color:#0d6efd;color:#fff;border-radius:50%}.day-cell[data-v-74f1f188]:hover{background-color:#eff6ff}.day-number[data-v-74f1f188]{font-size:12px;width:20px;height:20px;display:flex;align-items:center;justify-content:center}.events-container[data-v-74f1f188]{display:flex;flex-wrap:wrap;gap:2px;margin-top:4px}.event-dot[data-v-74f1f188]{width:6px;height:6px;border-radius:50%}.event-dot.event-type-world[data-v-74f1f188]{background-color:#ef4444}.event-dot.event-type-personal[data-v-74f1f188]{background-color:#3b82f6}.event-dot.event-type-upcoming[data-v-74f1f188]{background-color:#f59e0b}.selected-day-details[data-v-74f1f188]{padding:10px;border-top:1px solid #e5e7eb;margin-top:10px}.selected-day-details h4[data-v-74f1f188]{margin:0 0 8px 0}.selected-day-details ul[data-v-74f1f188]{margin:0;padding-left:0;font-size:14px;list-style-type:none}.selected-day-details ul li[data-v-74f1f188]{display:flex;align-items:center;margin-bottom:4px}.selected-day-details ul li .list-dot[data-v-74f1f188]{width:8px;height:8px;border-radius:50%;margin-right:8px;flex-shrink:0}.selected-day-details ul li.event-type-world .list-dot[data-v-74f1f188]{background-color:#ef4444}.selected-day-details ul li.event-type-personal .list-dot[data-v-74f1f188]{background-color:#3b82f6}.selected-day-details ul li.event-type-upcoming .list-dot[data-v-74f1f188]{background-color:#f59e0b}.loading-pane[data-v-74f1f188]{display:flex;justify-content:center;align-items:center;height:100%;font-size:16px;color:#6b7280}
.modal-backdrop[data-v-55bd1704]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[data-v-55bd1704]{background-color:#fff;padding:20px;border-radius:8px;min-width:250px;max-width:90%;box-shadow:0 4px 15px rgba(0,0,0,.2)}.modal-content h4[data-v-55bd1704]{margin-top:0;text-align:center}.character-list[data-v-55bd1704]{list-style:none;padding:0;margin:0;max-height:60vh;overflow-y:auto}.character-list li[data-v-55bd1704]{display:flex;align-items:center;padding:8px 12px;border-bottom:1px solid #eee;cursor:pointer;transition:background-color .2s}.character-list li[data-v-55bd1704]:hover{background-color:#f5f5f5}.avatar[data-v-55bd1704]{width:32px;height:32px;border-radius:50%;background-color:#e0e0e0;color:#333;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:bold;margin-right:12px}.avatar.is-user[data-v-55bd1704]{background-color:#007bff;color:#fff}.name[data-v-55bd1704]{font-size:1rem}.close-btn[data-v-55bd1704]{display:block;width:100%;margin-top:15px;padding:10px;background-color:#6c757d;color:#fff;border:none;border-radius:4px;cursor:pointer}.close-btn[data-v-55bd1704]:hover{background-color:#5a6268}
.map-app[data-v-2ce9d506]{display:grid;grid-template-areas:"header header" "map map" "info info";grid-template-columns:1fr;grid-template-rows:auto 1fr auto;height:100%;gap:10px;padding:10px;background-color:#f0f2f5;position:relative;overflow:hidden}.map-app .app-header[data-v-2ce9d506]{grid-area:header;background:rgba(0,0,0,0);padding:0;border-radius:0;box-shadow:none;display:flex;justify-content:flex-start;align-items:center}.map-app .map-sidebar[data-v-2ce9d506]{position:absolute;top:0;left:0;bottom:0;width:220px;background:#fff;border-right:1px solid #e5e7eb;box-shadow:2px 0 5px rgba(0,0,0,.1);transform:translateX(-100%);transition:transform .3s ease-in-out;z-index:20;display:flex;flex-direction:column}.map-app.filter-sidebar-open .map-sidebar[data-v-2ce9d506]{transform:translateX(0)}.map-app .filter-sidebar-handle[data-v-2ce9d506]{position:absolute;top:50%;left:0;transform:translateY(-50%);background-color:#3b82f6;color:#fff;padding:10px 5px;writing-mode:vertical-rl;text-orientation:mixed;border-radius:0 8px 8px 0;cursor:pointer;z-index:21;transition:left .3s ease-in-out}.map-app.filter-sidebar-open .filter-sidebar-handle[data-v-2ce9d506]{left:220px}.map-app .sidebar-tabs[data-v-2ce9d506]{display:flex;border-bottom:1px solid #e5e7eb}.map-app .sidebar-tabs button[data-v-2ce9d506]{flex:1;padding:10px;border:none;background:rgba(0,0,0,0);cursor:pointer;font-size:14px;font-weight:500;color:#6b7280;transition:all .2s}.map-app .sidebar-tabs button.active[data-v-2ce9d506]{color:#3b82f6;box-shadow:inset 0 -2px 0 #3b82f6}.map-app .sidebar-tabs button[data-v-2ce9d506]:hover:not(.active){background-color:#f9fafb}.map-app .sidebar-content[data-v-2ce9d506]{padding:12px;overflow-y:auto;flex-grow:1}.map-app .search-input[data-v-2ce9d506]{width:100%;padding:8px;border:1px solid #d1d5db;border-radius:6px;box-sizing:border-box;margin-bottom:10px}.map-app .location-list[data-v-2ce9d506]{list-style:none;padding:0;margin:0}.map-app .location-list li[data-v-2ce9d506]{padding:8px 10px;border-radius:6px;cursor:pointer;transition:background-color .2s;font-size:14px}.map-app .location-list li[data-v-2ce9d506]:hover{background-color:#f3f4f6}.map-app .search-results li[data-v-2ce9d506]{display:flex;flex-direction:column;gap:2px}.map-app .search-results .search-result-name[data-v-2ce9d506]{font-weight:500;color:#1f2937}.map-app .search-results .search-result-path[data-v-2ce9d506]{font-size:12px;color:#6b7280}.map-app .map-container[data-v-2ce9d506]{grid-area:map;position:relative;background:#eef2f9;border-radius:8px;overflow:hidden;border:2px dashed red}.map-app .info-panel[data-v-2ce9d506]{grid-area:info;background:hsla(0,0%,100%,.9);backdrop-filter:blur(5px);padding:15px;border-top:1px solid #e5e7eb;max-height:250px;overflow-y:auto;border-radius:0 0 8px 8px}.tabs[data-v-2ce9d506]{display:flex;gap:5px}.tabs button[data-v-2ce9d506]{padding:8px 16px;border:1px solid #d1d5db;background-color:#fff;border-radius:6px;cursor:pointer;transition:all .2s}.tabs button[data-v-2ce9d506]:hover{background-color:#f9fafb;border-color:#9ca3af}.tabs button.active[data-v-2ce9d506]{background-color:#3b82f6;color:#fff;border-color:#3b82f6}.breadcrumbs[data-v-2ce9d506]{background:hsla(0,0%,100%,.8);backdrop-filter:blur(5px);padding:8px 12px;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,.1);font-size:14px;color:#4b5563}.breadcrumbs .crumb[data-v-2ce9d506]{cursor:pointer;padding:4px 6px;border-radius:4px;transition:background-color .2s}.breadcrumbs .crumb[data-v-2ce9d506]:hover{background-color:#e5e7eb}.breadcrumbs .crumb[data-v-2ce9d506]:not(:last-child)::after{content:">";margin:0 8px;color:#9ca3af;cursor:default}.filter-group[data-v-2ce9d506]{display:flex;flex-direction:column;gap:8px;margin-top:10px}.filter-group label[data-v-2ce9d506]{display:flex;align-items:center;gap:8px;cursor:pointer}.filter-group label .color-indicator[data-v-2ce9d506]{display:inline-block;width:12px;height:12px;border-radius:3px;border:1px solid rgba(0,0,0,.2);vertical-align:middle;margin-right:4px}.map-grid[data-v-2ce9d506]{display:grid;gap:5px;padding:20px;position:relative;transform-origin:0 0}.location-node[data-v-2ce9d506]{border-radius:5px;display:flex;align-items:center;justify-content:center;text-align:center;padding:5px;box-sizing:border-box;transition:all .2s;cursor:pointer;font-weight:500;overflow:hidden;position:relative}.location-node[data-v-2ce9d506]:hover{transform:scale(1.02);box-shadow:0 0 10px rgba(0,0,0,.1);z-index:5}.location-node .location-text[data-v-2ce9d506]{position:relative;z-index:2;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.7)}.location-node.type-国家[data-v-2ce9d506]{background-color:#dc2626;border:1px solid rgb(178.25,28.75,28.75)}.location-node.type-城市[data-v-2ce9d506]{background-color:#2563eb;border:1px solid rgb(18.5714285714,76.1428571429,202.4285714286)}.location-node.type-区域[data-v-2ce9d506]{background-color:#65a30d;border:1px solid hsl(84.8,85.2272727273%,24.5098039216%)}.location-node.type-学校[data-v-2ce9d506]{background-color:#16a34a;border:1px solid rgb(15.9351351351,118.0648648649,53.6)}.location-node.type-商业区[data-v-2ce9d506]{background-color:#f59e0b;border:1px solid rgb(196.9291338583,126.7125984252,8.0708661417)}.location-node.type-户外区域[data-v-2ce9d506]{background-color:#0d9488;border:1px solid rgb(8.8819875776,101.1180124224,92.9192546584)}.location-node.type-交通枢纽[data-v-2ce9d506]{background-color:#64748b;border:1px solid rgb(78.6610878661,91.2468619247,109.3389121339)}.location-node.type-公共设施[data-v-2ce9d506]{background-color:#7c3aed;border:1px solid rgb(95.3302325581,20.4279069767,223.5720930233)}.location-node.type-名胜古迹[data-v-2ce9d506]{background-color:#c026d3;border:1px solid rgb(152.6746987952,30.2168674699,167.7831325301)}.location-node.type-生活区域[data-v-2ce9d506]{background-color:#0891b2;border:1px solid rgb(5.8064516129,105.2419354839,129.1935483871)}.location-node.type-特殊地点[data-v-2ce9d506]{background-color:#475569;border:1px solid rgb(50.4261363636,60.3693181818,74.5738636364)}.location-node.type-建筑[data-v-2ce9d506]{background-color:#9333ea;border:1px solid rgb(121.68,21.84,212.16)}.location-node.type-教室[data-v-2ce9d506]{background-color:#f97316;border:1px solid rgb(214.4769874477,91.129707113,5.5230125523)}.location-node.type-功能室[data-v-2ce9d506]{background-color:#ea580c;border:1px solid rgb(185.487804878,69.756097561,9.512195122)}.location-node.type-社团活动室[data-v-2ce9d506]{background-color:#db2777;border:1px solid rgb(177.4285714286,29.5714285714,95.2857142857)}.location-node.type-运动设施[data-v-2ce9d506]{background-color:#0ea5e9;border:1px solid rgb(11.1093117409,130.9311740891,184.8906882591)}.location-node.type-店铺[data-v-2ce9d506]{background-color:#f59e0b;border:1px solid rgb(196.9291338583,126.7125984252,8.0708661417)}.location-node.type-娱乐场所[data-v-2ce9d506]{background-color:#d946ef;border:1px solid hsl(292.1893491124,84.07960199%,50.5882352941%)}.location-node.type-教育机构[data-v-2ce9d506]{background-color:#059669;border:1px solid rgb(3.3548387097,100.6451612903,70.4516129032)}.location-node.has-event[data-v-2ce9d506]{animation:pulse-2ce9d506 2s infinite}.location-node .character-cluster-icon[data-v-2ce9d506]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.6);color:#fff;border-radius:50%;width:32px;height:32px;cursor:pointer;transition:background-color .2s;border:2px solid #fff;z-index:3}.location-node .character-cluster-icon[data-v-2ce9d506]:hover{background-color:rgba(0,0,0,.8)}.location-node .character-cluster-icon svg[data-v-2ce9d506]{width:16px;height:16px}.location-node .character-cluster-icon .cluster-count[data-v-2ce9d506]{position:absolute;top:-5px;right:-5px;background-color:#ff4d4f;color:#fff;border-radius:50%;padding:0 5px;font-size:10px;line-height:1.5;min-width:16px;text-align:center;border:1px solid #fff}@keyframes pulse-2ce9d506{0%{box-shadow:0 0 0 0 rgba(245,158,11,.7)}70%{box-shadow:0 0 0 10px rgba(245,158,11,0)}100%{box-shadow:0 0 0 0 rgba(245,158,11,0)}}
.tab-bar[data-v-74ae756e]{display:flex;justify-content:space-around;align-items:center;height:50px;background-color:#f8f8f8;border-top:1px solid #e7e7e7;position:absolute;bottom:0;left:0;right:0}.tab-item[data-v-74ae756e]{cursor:pointer;padding:0 20px;color:#333}.tab-item.active[data-v-74ae756e]{color:#0d6efd}
.category-nav-container[data-v-f0389972]{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.category-nav-container[data-v-f0389972]::-webkit-scrollbar{height:6px}.category-nav-container[data-v-f0389972]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.category-nav-container[data-v-f0389972]::-webkit-scrollbar-thumb{background:#888;border-radius:3px}.category-nav-container[data-v-f0389972]::-webkit-scrollbar-thumb:hover{background:#555}.category-nav[data-v-f0389972]{display:flex;flex-wrap:nowrap;gap:.75rem;padding:.5rem 0}.category-nav button[data-v-f0389972]{white-space:nowrap;padding:.5rem 1rem;border-radius:9999px;border:1px solid #e5e7eb;background-color:#f9fafb;color:#374151;font-size:.875rem;cursor:pointer;transition:all .2s ease-in-out}.category-nav button[data-v-f0389972]:hover{background-color:#f3f4f6}.category-nav button.active[data-v-f0389972]{background-color:#4f46e5;color:#fff;border-color:#4f46e5;font-weight:600}


.mall-home-view[data-v-e056aa4c]{padding:1rem;overflow-y:auto;display:flex;flex-direction:column;height:100%}.top-section[data-v-e056aa4c]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1rem}.product-grid[data-v-e056aa4c]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem;flex-grow:1;overflow-y:auto;grid-auto-rows:max-content}.no-results[data-v-e056aa4c]{flex-grow:1;display:flex;justify-content:center;align-items:center;text-align:center;color:#6c757d;margin-top:2rem}
.empty-state p[data-v-5bb81000]:first-child{font-size:2.5rem;margin-bottom:.5rem}
.empty-state p[data-v-0f99efb0]:first-child{font-size:2.5rem;margin-bottom:.5rem}
.mall-app{background-color:#f8f9fa}.mall-home-view .search-bar{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid{padding-bottom:4rem}.product-card{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container{flex-shrink:0;width:90px;height:90px}.product-card .product-image{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock{font-size:.75rem;color:#6b7280}.product-card button{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button:hover{background-color:#4338ca}.product-card button:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity{color:#6b7280}.cart-view .cart-item .item-price{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details{font-weight:500}.my-mall-view .order-item .order-delivery-time{font-size:.8rem;color:#6b7280}.mall-app{display:flex;flex-direction:column;height:100%;width:100%;position:relative}
.diary-timeline .timeline-entry[data-v-19ce03a0]{margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px dashed #ccc}.diary-timeline .timeline-date[data-v-19ce03a0]{font-weight:bold;color:#0d6efd;margin-bottom:.5rem}.diary-timeline .timeline-content[data-v-19ce03a0]{line-height:1.6;color:#555}.diary-timeline .timeline-empty[data-v-19ce03a0]{text-align:center;color:#999;padding:2rem}
.modal-overlay[data-v-49c98eea]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[data-v-49c98eea]{background:#fff;padding:1.5rem;border-radius:8px;width:90%;max-width:600px;box-shadow:0 5px 15px rgba(0,0,0,.3)}.modal-header[data-v-49c98eea]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #dee2e6;padding-bottom:1rem;margin-bottom:1rem}.modal-title[data-v-49c98eea]{font-size:1.25rem;margin:0}.modal-close[data-v-49c98eea]{border:none;background:none;font-size:1.5rem;cursor:pointer}.summary-editor[data-v-49c98eea]{width:100%;min-height:200px;padding:.5rem;border-radius:4px;border:1px solid #ced4da;font-family:inherit;font-size:.9rem;line-height:1.6}.modal-footer[data-v-49c98eea]{text-align:right;margin-top:1.5rem;display:flex;justify-content:flex-end;gap:.5rem}.btn[data-v-49c98eea]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;transition:background-color .2s}.btn-primary[data-v-49c98eea]{background-color:#0d6efd;color:#fff}.btn-primary[data-v-49c98eea]:hover{background-color:#0b5ed7}.btn-secondary[data-v-49c98eea]{background-color:#6c757d;color:#fff}.btn-secondary[data-v-49c98eea]:hover{background-color:#5a6268}
.summary-panel[data-v-574a653d]{padding:1rem;background-color:#f8f9fa;border-left:1px solid #dee2e6;display:flex;flex-direction:column;gap:1.5rem}.summary-section .summary-title[data-v-574a653d]{font-size:1.1rem;font-weight:600;margin-bottom:.75rem;color:#495057}.summary-section .summary-content[data-v-574a653d]{background-color:#fff;padding:.75rem;border-radius:4px;min-height:100px;font-size:.9rem;line-height:1.6;color:#333;border:1px solid #e9ecef}.summary-section .btn-edit[data-v-574a653d]{margin-top:.5rem;padding:.25rem .75rem;font-size:.8rem;border:1px solid #0d6efd;background-color:rgba(0,0,0,0);color:#0d6efd;border-radius:4px;cursor:pointer;transition:all .2s}.summary-section .btn-edit[data-v-574a653d]:hover{background-color:#e7f0fe}
.diary-app-container{display:flex;flex-direction:column;height:100%;width:100%;background-color:#f0f2f5}.diary-app-container .diary-tabs{display:flex;border-bottom:1px solid #dee2e6;background-color:#fff}.diary-app-container .diary-tabs button{padding:.75rem 1.5rem;border:none;background:none;cursor:pointer;font-size:1rem;color:#6c757d;border-bottom:2px solid rgba(0,0,0,0);transition:all .2s ease-in-out}.diary-app-container .diary-tabs button.active{color:#0d6efd;border-bottom-color:#0d6efd}.diary-app-container .diary-content{flex-grow:1;overflow-y:auto;padding:1rem}.diary-app-container .summary-wrapper .summary-controls{display:flex;gap:1.5rem;align-items:center;padding:.5rem 1rem;background-color:#fff;border-radius:8px;margin-bottom:1rem;border:1px solid #dee2e6}.diary-app-container .summary-wrapper .summary-controls .setting-item{display:flex;align-items:center;gap:.5rem}.diary-app-container .summary-wrapper .summary-controls .setting-item label{font-size:.85rem;color:#495057}.diary-app-container .summary-wrapper .summary-controls .setting-item input[type=number]{width:50px;padding:.25rem .5rem;border:1px solid #ced4da;border-radius:4px}.diary-app-container .summary-wrapper .summary-controls .setting-item input[type=checkbox]{width:16px;height:16px}
.attribute-item[data-v-29a51f0e]{display:flex;justify-content:space-between;font-size:13px}.attribute-name[data-v-29a51f0e]{color:#6c757d}.attribute-value[data-v-29a51f0e]{color:#3a3f4b;font-weight:500}
.character-panel[data-v-248ead5c]{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03);border-right:1px solid #eae6dd}.panel-section[data-v-248ead5c]{margin-bottom:20px;padding:15px;background:#fff;border-radius:8px;border:1px solid #eae6dd;box-shadow:0 2px 8px rgba(58,63,75,.05);transition:box-shadow .3s ease}.panel-section[data-v-248ead5c]:hover{box-shadow:0 4px 12px rgba(58,63,75,.08)}.section-title[data-v-248ead5c]{font-size:14px;font-weight:600;color:#3a3f4b;margin-bottom:12px;text-align:left;border-bottom:2px solid #4169e1;padding-bottom:8px;display:inline-block}.attributes-list[data-v-248ead5c]{display:flex;flex-direction:column;gap:8px}.attribute-item[data-v-248ead5c]{display:flex;justify-content:space-between;font-size:13px}.attribute-name[data-v-248ead5c]{color:#6c757d}.attribute-value[data-v-248ead5c]{color:#3a3f4b;font-weight:500}
.guixu-root-container[data-v-76de7015]{display:grid;grid-template-rows:auto 1fr auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;background-color:#fdfbf6;color:#3a3f4b;border:1px solid #eae6dd;border-radius:12px;overflow:hidden;max-width:100%;margin:auto;box-shadow:0 8px 35px rgba(58,63,75,.12);position:relative;width:100%;height:720px}.guixu-root-container[data-v-76de7015] *{margin:0;padding:0;box-sizing:border-box}.game-container[data-v-76de7015]{display:grid;grid-template-columns:220px 1fr 160px;width:100%;height:100%;overflow:hidden;gap:1px}.character-panel[data-v-76de7015],.interaction-panel[data-v-76de7015]{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.character-panel[data-v-76de7015]{border-right:1px solid #eae6dd}.interaction-panel[data-v-76de7015]{border-left:1px solid #eae6dd}.main-content[data-v-76de7015]{padding:25px;overflow-y:auto;background:#fdfbf6;position:relative}#tablet-trigger[data-v-76de7015]{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-trigger[data-v-76de7015]:hover{background-color:#f5f1e9;color:#4169e1}#tablet-container[data-v-76de7015]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(58,63,75,.4);backdrop-filter:blur(5px);opacity:0;visibility:hidden;transform:scale(1.1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease;z-index:200}#tablet-container.is-visible[data-v-76de7015]{opacity:1;visibility:visible;transform:scale(1)}#tablet-container .tablet-case[data-v-76de7015]{width:90%;max-width:380px;height:90vh;max-height:800px;background-color:#1a1a1a;border-radius:40px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.3),inset 0 0 15px hsla(0,0%,100%,.1);display:flex;flex-direction:column}#tablet-container .phone-screen[data-v-76de7015]{width:100%;height:100%;background:linear-gradient(160deg,#f87171 0%,#a855f7 100%);border-radius:28px;overflow:hidden;position:relative;display:flex;flex-direction:column;color:#fff}#tablet-container .phone-content-area[data-v-76de7015]{flex-grow:1;position:relative;display:flex;flex-direction:column}#tablet-container .phone-desktop[data-v-76de7015]{display:flex;flex-direction:column;height:100%;padding:20px;box-sizing:border-box}#tablet-container .desktop-header[data-v-76de7015]{flex-shrink:0;padding:40px 0;text-align:center}#tablet-container .desktop-header .time-display #desktop-time[data-v-76de7015]{font-size:72px;font-weight:300;letter-spacing:1px;display:block;line-height:1}#tablet-container .desktop-header .time-display #desktop-date[data-v-76de7015]{font-size:16px;font-weight:400;opacity:.9}#tablet-container .app-grid[data-v-76de7015]{flex-grow:1;display:grid;grid-template-columns:repeat(4,1fr);gap:20px;align-content:flex-start}#tablet-container .desktop-dock-indicator[data-v-76de7015]{flex-shrink:0;display:flex;justify-content:center;padding:15px 0}#tablet-container .desktop-dock-indicator span[data-v-76de7015]{width:8px;height:8px;background-color:hsla(0,0%,100%,.5);border-radius:50%}#tablet-container .app-view-container[data-v-76de7015]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fdfbf6;z-index:10;flex-direction:column;color:#3a3f4b}#tablet-container .app-view-container.active[data-v-76de7015]{display:flex}#tablet-container .phone-nav-bar[data-v-76de7015]{height:50px;flex-shrink:0;display:flex;justify-content:space-around;align-items:center;padding:0 20px;background:rgba(0,0,0,.1)}#tablet-container .phone-nav-bar .nav-btn[data-v-76de7015]{background:none;border:none;color:#fff;opacity:.8;cursor:pointer;padding:5px}#tablet-container .phone-nav-bar .nav-btn svg[data-v-76de7015]{width:20px;height:20px}#tablet-container .guixu-root-container:not(.mobile-view) .main-content[data-v-76de7015]{grid-column:1/-1}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-76de7015],#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-76de7015]{position:absolute;top:0;height:100%;z-index:1000;transition:transform .35s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 25px rgba(0,0,0,.15);background:#f5f1e9;border:none}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel[data-v-76de7015]{width:240px;left:0;transform:translateX(-100%);border-right:1px solid #eae6dd}#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel[data-v-76de7015]{width:180px;right:0;transform:translateX(100%);border-left:1px solid #eae6dd}#tablet-container .guixu-root-container.left-sidebar-open .character-panel[data-v-76de7015]{transform:translateX(0)}#tablet-container .guixu-root-container.right-sidebar-open .interaction-panel[data-v-76de7015]{transform:translateX(0)}#tablet-container .sidebar-handle[data-v-76de7015]{position:fixed;z-index:1001;width:32px;height:80px;background:#fff;color:#6c757d;writing-mode:vertical-rl;text-orientation:mixed;display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #eae6dd;font-size:14px;font-weight:500;transition:background-color .2s;box-shadow:2px 0 8px rgba(58,63,75,.08)}#tablet-container .sidebar-handle[data-v-76de7015]:hover{background:#f5f1e9;color:#4169e1}#tablet-container #left-sidebar-handle[data-v-76de7015]{top:40%;left:0;border-left:none;border-top-right-radius:8px;border-bottom-right-radius:8px}#tablet-container #right-sidebar-handle[data-v-76de7015]{top:55%;right:0;border-right:none;border-left:1px solid #eae6dd;border-radius:8px 0 0 8px;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-container .app-icon[data-v-76de7015]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;text-decoration:none}#tablet-container .app-icon .app-icon-visual[data-v-76de7015]{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:transform .2s ease}#tablet-container .app-icon .app-icon-visual svg[data-v-76de7015]{width:28px;height:28px}#tablet-container .app-icon .app-icon-name[data-v-76de7015]{font-size:12px;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.3)}#tablet-container .app-icon:hover .app-icon-visual[data-v-76de7015]{transform:scale(1.1)}#tablet-container .app-icon[data-app-id=tianhuachat] .app-icon-visual[data-v-76de7015]{background-color:#3b82f6}#tablet-container .app-icon[data-app-id=campus-pass] .app-icon-visual[data-v-76de7015]{background-color:#14b8a6}#tablet-container .app-icon[data-app-id=schedule] .app-icon-visual[data-v-76de7015]{background-color:#8b5cf6}#tablet-container .app-icon[data-app-id=health] .app-icon-visual[data-v-76de7015]{background-color:#ef4444}#tablet-container .app-icon[data-app-id=forum] .app-icon-visual[data-v-76de7015]{background-color:#0ea5e9}#tablet-container .app-icon[data-app-id=shopping] .app-icon-visual[data-v-76de7015]{background-color:#f97316}#tablet-container .app-icon[data-app-id=inventory] .app-icon-visual[data-v-76de7015]{background-color:#ec4899}#tablet-container .app-icon[data-app-id=map] .app-icon-visual[data-v-76de7015]{background-color:#22c55e}#tablet-container .app-icon[data-app-id=settings] .app-icon-visual[data-v-76de7015]{background-color:#6b7280}.phone-status-bar[data-v-76de7015]{display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background-color:rgba(0,0,0,.1);color:#fff;font-size:12px;position:absolute;top:0;left:0;right:0;z-index:100}.phone-status-bar .status-left[data-v-76de7015],.phone-status-bar .status-right[data-v-76de7015]{display:flex;align-items:center;gap:6px}.phone-status-bar .status-center[data-v-76de7015]{font-weight:500}.phone-status-bar .battery-icon[data-v-76de7015]{width:22px;height:11px;border:1px solid #fff;border-radius:3px;position:relative;padding:1px}.phone-status-bar .battery-icon[data-v-76de7015]::after{content:"";position:absolute;right:-3px;top:2px;width:2px;height:5px;background-color:#fff;border-top-right-radius:1px;border-bottom-right-radius:1px}.phone-status-bar .battery-icon .battery-fill[data-v-76de7015]{height:100%;background-color:#fff;border-radius:1px;transition:width .3s ease}.phone-content-area[data-v-76de7015]{padding-top:24px}.mall-app[data-v-76de7015]{background-color:#f8f9fa}.mall-home-view .search-bar[data-v-76de7015]{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar[data-v-76de7015]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid[data-v-76de7015]{padding-bottom:4rem}.product-card[data-v-76de7015]{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container[data-v-76de7015]{flex-shrink:0;width:90px;height:90px}.product-card .product-image[data-v-76de7015]{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details[data-v-76de7015]{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name[data-v-76de7015]{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description[data-v-76de7015]{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer[data-v-76de7015]{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price[data-v-76de7015]{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock[data-v-76de7015]{font-size:.75rem;color:#6b7280}.product-card button[data-v-76de7015]{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button[data-v-76de7015]:hover{background-color:#4338ca}.product-card button[data-v-76de7015]:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container[data-v-76de7015]{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title[data-v-76de7015]{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state[data-v-76de7015]{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item[data-v-76de7015]{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name[data-v-76de7015]{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity[data-v-76de7015]{color:#6b7280}.cart-view .cart-item .item-price[data-v-76de7015]{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary[data-v-76de7015]{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row[data-v-76de7015]{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total[data-v-76de7015]{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn[data-v-76de7015]{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn[data-v-76de7015]:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card[data-v-76de7015]{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2[data-v-76de7015]{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p[data-v-76de7015]{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title[data-v-76de7015]{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item[data-v-76de7015]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details[data-v-76de7015]{font-weight:500}.my-mall-view .order-item .order-delivery-time[data-v-76de7015]{font-size:.8rem;color:#6b7280}.main-content-wrapper[data-v-76de7015]{position:relative;height:100%;overflow-y:auto;padding:25px;background:#fdfbf6}.game-text-container[data-v-76de7015]{font-size:15px;line-height:1.8;color:#3a3f4b;white-space:pre-wrap}.tablet-trigger-btn[data-v-76de7015]{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}.tablet-trigger-btn[data-v-76de7015]:hover{background-color:#f5f1e9;color:#4169e1}
.inventory-panel[data-v-74e5075d]{padding:15px}.panel-section[data-v-74e5075d]{margin-bottom:20px;padding:15px;background:#fff;border-radius:8px;border:1px solid #eae6dd}.section-title[data-v-74e5075d]{font-size:14px;font-weight:600;color:#3a3f4b;margin-bottom:12px}.inventory-grid[data-v-74e5075d]{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px}.inventory-item[data-v-74e5075d]{padding:10px;background-color:#f8f9fa;border-radius:6px;text-align:center}.item-name[data-v-74e5075d]{font-weight:500}.item-quantity[data-v-74e5075d]{color:#6c757d;font-size:12px}
.npc-list-panel[data-v-6e94cfcc]{padding:15px}.panel-section[data-v-6e94cfcc]{margin-bottom:20px;padding:15px;background:#fff;border-radius:8px;border:1px solid #eae6dd}.section-title[data-v-6e94cfcc]{font-size:14px;font-weight:600;color:#3a3f4b;margin-bottom:12px}.npc-list[data-v-6e94cfcc]{display:flex;flex-direction:column;gap:10px}.npc-item[data-v-6e94cfcc]{display:flex;justify-content:space-between;padding:10px;background-color:#f8f9fa;border-radius:6px}.npc-name[data-v-6e94cfcc]{font-weight:500}.npc-relationship[data-v-6e94cfcc]{color:#6c757d}
.world-state-panel[data-v-6b569493]{padding:15px}.panel-section[data-v-6b569493]{margin-bottom:20px;padding:15px;background:#fff;border-radius:8px;border:1px solid #eae6dd}.section-title[data-v-6b569493]{font-size:14px;font-weight:600;color:#3a3f4b;margin-bottom:12px}.state-list[data-v-6b569493]{display:flex;flex-direction:column;gap:8px}
.guixu-root-container{display:grid;grid-template-rows:auto 1fr auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;background-color:#fdfbf6;color:#3a3f4b;border:1px solid #eae6dd;border-radius:12px;overflow:hidden;max-width:100%;margin:auto;box-shadow:0 8px 35px rgba(58,63,75,.12);position:relative;width:100%;height:720px}.guixu-root-container *{margin:0;padding:0;box-sizing:border-box}.game-container{display:grid;grid-template-columns:220px 1fr 160px;width:100%;height:100%;overflow:hidden;gap:1px}.character-panel,.interaction-panel{background:#f5f1e9;padding:15px;overflow-y:auto;box-shadow:inset 0 0 10px rgba(58,63,75,.03)}.character-panel{border-right:1px solid #eae6dd}.interaction-panel{border-left:1px solid #eae6dd}.main-content{padding:25px;overflow-y:auto;background:#fdfbf6;position:relative}#tablet-trigger{position:fixed;right:0;top:45%;transform:translateY(-50%);width:32px;height:80px;background-color:#fff;border:1px solid #eae6dd;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;transition:all .3s ease;font-size:24px;display:flex;align-items:center;justify-content:center;color:#6c757d;z-index:1001;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-trigger:hover{background-color:#f5f1e9;color:#4169e1}#tablet-container{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(58,63,75,.4);backdrop-filter:blur(5px);opacity:0;visibility:hidden;transform:scale(1.1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease;z-index:200}#tablet-container.is-visible{opacity:1;visibility:visible;transform:scale(1)}#tablet-container .tablet-case{width:90%;max-width:380px;height:90vh;max-height:800px;background-color:#1a1a1a;border-radius:40px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.3),inset 0 0 15px hsla(0,0%,100%,.1);display:flex;flex-direction:column}#tablet-container .phone-screen{width:100%;height:100%;background:linear-gradient(160deg,#f87171 0%,#a855f7 100%);border-radius:28px;overflow:hidden;position:relative;display:flex;flex-direction:column;color:#fff}#tablet-container .phone-content-area{flex-grow:1;position:relative;display:flex;flex-direction:column}#tablet-container .phone-desktop{display:flex;flex-direction:column;height:100%;padding:20px;box-sizing:border-box}#tablet-container .desktop-header{flex-shrink:0;padding:40px 0;text-align:center}#tablet-container .desktop-header .time-display #desktop-time{font-size:72px;font-weight:300;letter-spacing:1px;display:block;line-height:1}#tablet-container .desktop-header .time-display #desktop-date{font-size:16px;font-weight:400;opacity:.9}#tablet-container .app-grid{flex-grow:1;display:grid;grid-template-columns:repeat(4,1fr);gap:20px;align-content:flex-start}#tablet-container .desktop-dock-indicator{flex-shrink:0;display:flex;justify-content:center;padding:15px 0}#tablet-container .desktop-dock-indicator span{width:8px;height:8px;background-color:hsla(0,0%,100%,.5);border-radius:50%}#tablet-container .app-view-container{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fdfbf6;z-index:10;flex-direction:column;color:#3a3f4b}#tablet-container .app-view-container.active{display:flex}#tablet-container .phone-nav-bar{height:50px;flex-shrink:0;display:flex;justify-content:space-around;align-items:center;padding:0 20px;background:rgba(0,0,0,.1)}#tablet-container .phone-nav-bar .nav-btn{background:none;border:none;color:#fff;opacity:.8;cursor:pointer;padding:5px}#tablet-container .phone-nav-bar .nav-btn svg{width:20px;height:20px}#tablet-container .guixu-root-container:not(.mobile-view) .main-content{grid-column:1/-1}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel,#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel{position:absolute;top:0;height:100%;z-index:1000;transition:transform .35s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 25px rgba(0,0,0,.15);background:#f5f1e9;border:none}#tablet-container .guixu-root-container:not(.mobile-view) .character-panel{width:240px;left:0;transform:translateX(-100%);border-right:1px solid #eae6dd}#tablet-container .guixu-root-container:not(.mobile-view) .interaction-panel{width:180px;right:0;transform:translateX(100%);border-left:1px solid #eae6dd}#tablet-container .guixu-root-container.left-sidebar-open .character-panel{transform:translateX(0)}#tablet-container .guixu-root-container.right-sidebar-open .interaction-panel{transform:translateX(0)}#tablet-container .sidebar-handle{position:fixed;z-index:1001;width:32px;height:80px;background:#fff;color:#6c757d;writing-mode:vertical-rl;text-orientation:mixed;display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #eae6dd;font-size:14px;font-weight:500;transition:background-color .2s;box-shadow:2px 0 8px rgba(58,63,75,.08)}#tablet-container .sidebar-handle:hover{background:#f5f1e9;color:#4169e1}#tablet-container #left-sidebar-handle{top:40%;left:0;border-left:none;border-top-right-radius:8px;border-bottom-right-radius:8px}#tablet-container #right-sidebar-handle{top:55%;right:0;border-right:none;border-left:1px solid #eae6dd;border-radius:8px 0 0 8px;box-shadow:-2px 0 8px rgba(58,63,75,.08)}#tablet-container .app-icon{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;text-decoration:none}#tablet-container .app-icon .app-icon-visual{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:transform .2s ease}#tablet-container .app-icon .app-icon-visual svg{width:28px;height:28px}#tablet-container .app-icon .app-icon-name{font-size:12px;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.3)}#tablet-container .app-icon:hover .app-icon-visual{transform:scale(1.1)}#tablet-container .app-icon[data-app-id=tianhuachat] .app-icon-visual{background-color:#3b82f6}#tablet-container .app-icon[data-app-id=campus-pass] .app-icon-visual{background-color:#14b8a6}#tablet-container .app-icon[data-app-id=schedule] .app-icon-visual{background-color:#8b5cf6}#tablet-container .app-icon[data-app-id=health] .app-icon-visual{background-color:#ef4444}#tablet-container .app-icon[data-app-id=forum] .app-icon-visual{background-color:#0ea5e9}#tablet-container .app-icon[data-app-id=shopping] .app-icon-visual{background-color:#f97316}#tablet-container .app-icon[data-app-id=inventory] .app-icon-visual{background-color:#ec4899}#tablet-container .app-icon[data-app-id=map] .app-icon-visual{background-color:#22c55e}#tablet-container .app-icon[data-app-id=settings] .app-icon-visual{background-color:#6b7280}.phone-status-bar{display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background-color:rgba(0,0,0,.1);color:#fff;font-size:12px;position:absolute;top:0;left:0;right:0;z-index:100}.phone-status-bar .status-left,.phone-status-bar .status-right{display:flex;align-items:center;gap:6px}.phone-status-bar .status-center{font-weight:500}.phone-status-bar .battery-icon{width:22px;height:11px;border:1px solid #fff;border-radius:3px;position:relative;padding:1px}.phone-status-bar .battery-icon::after{content:"";position:absolute;right:-3px;top:2px;width:2px;height:5px;background-color:#fff;border-top-right-radius:1px;border-bottom-right-radius:1px}.phone-status-bar .battery-icon .battery-fill{height:100%;background-color:#fff;border-radius:1px;transition:width .3s ease}.phone-content-area{padding-top:24px}.mall-app{background-color:#f8f9fa}.mall-home-view .search-bar{border-radius:9999px;border:1px solid #e5e7eb;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}.mall-home-view .search-bar:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 2px rgba(79,70,229,.2)}.mall-home-view .product-grid{padding-bottom:4rem}.product-card{border:none;border-radius:12px;background-color:#fff;overflow:hidden;display:flex;flex-direction:row;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out;padding:.75rem;gap:.75rem;align-items:flex-start;box-shadow:0 2px 4px rgba(0,0,0,.05)}.product-card .product-image-container{flex-shrink:0;width:90px;height:90px}.product-card .product-image{width:100%;height:100%;border-radius:8px;background-color:#f0f2f5}.product-card .product-details{display:flex;flex-direction:column;flex-grow:1;min-width:0}.product-card .product-name{font-size:1rem;font-weight:600;color:#1f2937}.product-card .product-description{font-size:.8rem;color:#6b7280;margin:.25rem 0;flex-grow:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.4}.product-card .product-footer{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card .product-price{font-size:1.1rem;font-weight:bold;color:#ef4444;margin:0}.product-card .product-stock{font-size:.75rem;color:#6b7280}.product-card button{margin:0;background-color:#4f46e5;color:#fff;border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-weight:bold;font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.product-card button:hover{background-color:#4338ca}.product-card button:disabled{background-color:#9ca3af;cursor:not-allowed}.mall-page-container{padding:1rem;height:100%;overflow-y:auto}.mall-page-container .page-title{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem}.mall-page-container .empty-state{text-align:center;color:#6b7280;margin-top:4rem;font-size:1rem}.cart-view .cart-item{display:flex;align-items:center;gap:1rem;padding:1rem 0;border-bottom:1px solid #e5e7eb}.cart-view .cart-item .item-name{flex-grow:1;font-weight:500}.cart-view .cart-item .item-quantity{color:#6b7280}.cart-view .cart-item .item-price{font-weight:600;min-width:60px;text-align:right}.cart-view .cart-summary{margin-top:1.5rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.05)}.cart-view .cart-summary .summary-row{display:flex;justify-content:space-between;margin-bottom:.5rem}.cart-view .cart-summary .summary-row.total{font-weight:bold;font-size:1.1rem;margin-top:1rem}.cart-view .checkout-btn{width:100%;padding:.875rem;border-radius:8px;border:none;background-color:#10b981;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;margin-top:1.5rem}.cart-view .checkout-btn:disabled{background-color:#9ca3af;cursor:not-allowed}.my-mall-view .user-info-card{background:linear-gradient(to right,#6366f1,#8b5cf6);color:#fff;padding:1.5rem;border-radius:12px;margin-bottom:1.5rem}.my-mall-view .user-info-card h2{margin:0;font-size:1.5rem}.my-mall-view .user-info-card p{margin:.25rem 0 0;font-size:1rem;opacity:.9}.my-mall-view .section-title{font-size:1.2rem;font-weight:600;margin-bottom:1rem}.my-mall-view .order-item{display:flex;justify-content:space-between;align-items:center;padding:1rem;background-color:#fff;border-radius:8px;margin-bottom:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}.my-mall-view .order-item .order-details{font-weight:500}.my-mall-view .order-item .order-delivery-time{font-size:.8rem;color:#6b7280}
</style></head><body><div id="app"></div><script type="module" src="45b388e040d7846ce56e.ts"></script></body></html>


